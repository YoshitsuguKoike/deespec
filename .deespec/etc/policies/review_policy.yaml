# .deespec/etc/policies/review_policy.yaml
version: 1

reviewer:
  name: "default-reviewer"     # 任意の論理名
  max_feedback: 3              # FBがこの回数を超えたら打ち切り
  priority_boost_on_feedback: 1  # 差し込みFB-SBIのpriorityブースト量（parent.priority - 1）

feedback:
  create_task_on_ng: true
  title_prefix: "[FB]"
  spec_template: ".deespec/templates/spec_feedback.yaml"  # なければ内部テンプレを使用
  link_parent: true
  make_doing: true            # 登録後に即Pick（--pick相当）

cutoff:
  enable: true
  condition: "feedback_count > max_feedback"
  reviewer_takeover: true
  takeover_spec_template: ".deespec/templates/spec_takeover.yaml"
  require_author_re_evaluation: true
  reflection_file: ".deespec/sessions/session_{date}.md"

knowledge:
  enable: true
  knowledge_log: ".deespec/knowledge/lessons.md"
  append_format: "- {date}: {sbi_id} {summary}"

session:              # 先行で記録だけ（SBI-SES系で活用）
  lease_sec: 600
  adopt_orphan: true
  adopt_min_age_sec: 900
  pick_strategy: "affinity_first"

constraints:
  max_prompt_kb: 64
  allowed_placeholders: ["{turn}", "{task_id}", "{project_name}", "{language}"]