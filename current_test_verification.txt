?   	github.com/YoshitsuguKoike/deespec/cmd/deespec	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/adapter/controller/cli	[no test files]
=== RUN   TestGeminiMockGateway
--- PASS: TestGeminiMockGateway (0.10s)
=== RUN   TestCodexMockGateway
--- PASS: TestCodexMockGateway (0.15s)
=== RUN   TestClaudeCodeGateway
    agent_gateway_test.go:96: Skipping Claude Code test: ANTHROPIC_API_KEY not set
--- SKIP: TestClaudeCodeGateway (0.00s)
=== RUN   TestNewAgentGateway
=== RUN   TestNewAgentGateway/gemini-cli
=== RUN   TestNewAgentGateway/codex
=== RUN   TestNewAgentGateway/unknown_agent
=== RUN   TestNewAgentGateway/claude-code_without_API_key
=== RUN   TestNewAgentGateway/claude-code_with_API_key
--- PASS: TestNewAgentGateway (0.00s)
    --- PASS: TestNewAgentGateway/gemini-cli (0.00s)
    --- PASS: TestNewAgentGateway/codex (0.00s)
    --- PASS: TestNewAgentGateway/unknown_agent (0.00s)
    --- PASS: TestNewAgentGateway/claude-code_without_API_key (0.00s)
    --- PASS: TestNewAgentGateway/claude-code_with_API_key (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/adapter/gateway/agent	(cached)
=== RUN   TestLocalStorageGateway_SaveAndLoadArtifact
--- PASS: TestLocalStorageGateway_SaveAndLoadArtifact (0.00s)
=== RUN   TestLocalStorageGateway_ListArtifacts
--- PASS: TestLocalStorageGateway_ListArtifacts (0.01s)
=== RUN   TestLocalStorageGateway_ListArtifacts_EmptyTask
--- PASS: TestLocalStorageGateway_ListArtifacts_EmptyTask (0.00s)
=== RUN   TestLocalStorageGateway_LoadInstruction_AbsolutePath
--- PASS: TestLocalStorageGateway_LoadInstruction_AbsolutePath (0.00s)
=== RUN   TestLocalStorageGateway_LoadInstruction_RelativePath
--- PASS: TestLocalStorageGateway_LoadInstruction_RelativePath (0.00s)
=== RUN   TestLocalStorageGateway_DeleteArtifact
--- PASS: TestLocalStorageGateway_DeleteArtifact (0.00s)
=== RUN   TestLocalStorageGateway_EnsureInstructionFile
--- PASS: TestLocalStorageGateway_EnsureInstructionFile (0.00s)
=== RUN   TestLocalStorageGateway_CopyFile
--- PASS: TestLocalStorageGateway_CopyFile (0.00s)
=== RUN   TestLocalStorageGateway_GetStoragePath
--- PASS: TestLocalStorageGateway_GetStoragePath (0.00s)
=== RUN   TestS3StorageGateway_SaveAndLoadArtifact
--- PASS: TestS3StorageGateway_SaveAndLoadArtifact (0.00s)
=== RUN   TestS3StorageGateway_LoadArtifact_NotFound
--- PASS: TestS3StorageGateway_LoadArtifact_NotFound (0.00s)
=== RUN   TestS3StorageGateway_ListArtifacts
--- PASS: TestS3StorageGateway_ListArtifacts (0.00s)
=== RUN   TestS3StorageGateway_ListArtifacts_EmptyTask
--- PASS: TestS3StorageGateway_ListArtifacts_EmptyTask (0.00s)
=== RUN   TestS3StorageGateway_LoadInstruction
--- PASS: TestS3StorageGateway_LoadInstruction (0.00s)
=== RUN   TestS3StorageGateway_DeleteArtifact
--- PASS: TestS3StorageGateway_DeleteArtifact (0.00s)
=== RUN   TestS3StorageGateway_MultipleTasks
--- PASS: TestS3StorageGateway_MultipleTasks (0.00s)
=== RUN   TestS3StorageGateway_ArtifactMetadata
--- PASS: TestS3StorageGateway_ArtifactMetadata (0.00s)
=== RUN   TestS3StorageGateway_BuildKey
--- PASS: TestS3StorageGateway_BuildKey (0.00s)
=== RUN   TestMockStorageGateway_SaveAndLoad
--- PASS: TestMockStorageGateway_SaveAndLoad (0.00s)
=== RUN   TestMockStorageGateway_LoadInstruction
--- PASS: TestMockStorageGateway_LoadInstruction (0.00s)
=== RUN   TestMockStorageGateway_ListArtifacts
--- PASS: TestMockStorageGateway_ListArtifacts (0.00s)
=== RUN   TestMockStorageGateway_LoadArtifact_NotFound
--- PASS: TestMockStorageGateway_LoadArtifact_NotFound (0.00s)
=== RUN   TestMockStorageGateway_Clear
--- PASS: TestMockStorageGateway_Clear (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/adapter/gateway/storage	(cached)
=== RUN   TestCLITaskPresenter_PresentSuccess
=== RUN   TestCLITaskPresenter_PresentSuccess/present_SBI
=== RUN   TestCLITaskPresenter_PresentSuccess/present_task_list
--- PASS: TestCLITaskPresenter_PresentSuccess (0.00s)
    --- PASS: TestCLITaskPresenter_PresentSuccess/present_SBI (0.00s)
    --- PASS: TestCLITaskPresenter_PresentSuccess/present_task_list (0.00s)
=== RUN   TestCLITaskPresenter_PresentError
--- PASS: TestCLITaskPresenter_PresentError (0.00s)
=== RUN   TestCLITaskPresenter_PresentProgress
--- PASS: TestCLITaskPresenter_PresentProgress (0.00s)
=== RUN   TestJSONPresenter_PresentSuccess
--- PASS: TestJSONPresenter_PresentSuccess (0.00s)
=== RUN   TestJSONPresenter_PresentError
--- PASS: TestJSONPresenter_PresentError (0.00s)
=== RUN   TestJSONPresenter_PresentProgress
--- PASS: TestJSONPresenter_PresentProgress (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/adapter/presenter	(cached)
=== RUN   TestNormalizeJournalEntry_FillsDefaults
--- PASS: TestNormalizeJournalEntry_FillsDefaults (0.00s)
=== RUN   TestNormalizeJournalEntry_PreservesExistingValues
--- PASS: TestNormalizeJournalEntry_PreservesExistingValues (0.00s)
=== RUN   TestNormalizeJournalEntryMap_FillsMissingKeys
--- PASS: TestNormalizeJournalEntryMap_FillsMissingKeys (0.00s)
=== RUN   TestNormalizeJournalEntryMap_PreservesExistingValues
--- PASS: TestNormalizeJournalEntryMap_PreservesExistingValues (0.00s)
=== RUN   TestNormalizeJournalEntryMap_HandlesStringArtifacts
--- PASS: TestNormalizeJournalEntryMap_HandlesStringArtifacts (0.00s)
=== RUN   TestJournalWriter_Append
--- PASS: TestJournalWriter_Append (0.01s)
=== RUN   TestJournalWriter_QuickAppend
--- PASS: TestJournalWriter_QuickAppend (0.01s)
=== RUN   TestJournalWriter_ValidationWarning
--- PASS: TestJournalWriter_ValidationWarning (0.01s)
=== RUN   TestJournalWriterAppend
--- PASS: TestJournalWriterAppend (0.01s)
=== RUN   TestJournalWriterMultipleAppends
--- PASS: TestJournalWriterMultipleAppends (0.04s)
=== RUN   TestJournalWriterConcurrentAppends
--- PASS: TestJournalWriterConcurrentAppends (0.02s)
=== RUN   TestJournalWriterNormalization
--- PASS: TestJournalWriterNormalization (0.01s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/app	(cached)
?   	github.com/YoshitsuguKoike/deespec/internal/app/config	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/app/health	[no test files]
=== RUN   TestLoadState
=== RUN   TestLoadState/minimal_valid_state
=== RUN   TestLoadState/state_with_defaults
=== RUN   TestLoadState/legacy_current_field
2025/10/11 00:02:15 INFO: Migrating 'current' field to 'step' in state.json
=== RUN   TestLoadState/invalid_step_value
2025/10/11 00:02:15 WARN: Invalid step value 'foo' in state.json (expected: plan, implement, test, review, or done)
=== RUN   TestLoadState/both_step_and_current_(step_wins)
--- PASS: TestLoadState (0.01s)
    --- PASS: TestLoadState/minimal_valid_state (0.00s)
    --- PASS: TestLoadState/state_with_defaults (0.00s)
    --- PASS: TestLoadState/legacy_current_field (0.00s)
    --- PASS: TestLoadState/invalid_step_value (0.00s)
    --- PASS: TestLoadState/both_step_and_current_(step_wins) (0.00s)
=== RUN   TestSaveStateAtomic
--- PASS: TestSaveStateAtomic (0.00s)
=== RUN   TestSaveStateAtomicOverwrite
--- PASS: TestSaveStateAtomicOverwrite (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/app/state	(cached)
?   	github.com/YoshitsuguKoike/deespec/internal/application/dto	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/application/port/input	[no test files]
testing: warning: no tests to run
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/application/port/output	(cached) [no tests to run]
=== RUN   TestNewAgentPool
--- PASS: TestNewAgentPool (0.00s)
=== RUN   TestNewAgentPoolWithConfig
--- PASS: TestNewAgentPoolWithConfig (0.00s)
=== RUN   TestAgentPool_TryAcquire_Success
--- PASS: TestAgentPool_TryAcquire_Success (0.00s)
=== RUN   TestAgentPool_TryAcquire_Failure
--- PASS: TestAgentPool_TryAcquire_Failure (0.00s)
=== RUN   TestAgentPool_Release
--- PASS: TestAgentPool_Release (0.00s)
=== RUN   TestAgentPool_Release_WhenZero
--- PASS: TestAgentPool_Release_WhenZero (0.00s)
=== RUN   TestAgentPool_UnknownAgent_DefaultLimit
--- PASS: TestAgentPool_UnknownAgent_DefaultLimit (0.00s)
=== RUN   TestAgentPool_SetLimit
--- PASS: TestAgentPool_SetLimit (0.00s)
=== RUN   TestAgentPool_SetLimit_InvalidValue
--- PASS: TestAgentPool_SetLimit_InvalidValue (0.00s)
=== RUN   TestAgentPool_GetStats
--- PASS: TestAgentPool_GetStats (0.00s)
=== RUN   TestAgentPool_Reset
--- PASS: TestAgentPool_Reset (0.00s)
=== RUN   TestAgentPool_ConcurrentAccess
    agent_pool_test.go:241: Max concurrent: 2 out of 20 goroutines
--- PASS: TestAgentPool_ConcurrentAccess (0.00s)
=== RUN   TestAgentPool_MultipleAgents
--- PASS: TestAgentPool_MultipleAgents (0.00s)
=== RUN   TestAgentStats_IsAvailable
=== RUN   TestAgentStats_IsAvailable/Empty
=== RUN   TestAgentStats_IsAvailable/Partial
=== RUN   TestAgentStats_IsAvailable/Full
=== RUN   TestAgentStats_IsAvailable/Single_slot_available
=== RUN   TestAgentStats_IsAvailable/Single_slot_full
--- PASS: TestAgentStats_IsAvailable (0.00s)
    --- PASS: TestAgentStats_IsAvailable/Empty (0.00s)
    --- PASS: TestAgentStats_IsAvailable/Partial (0.00s)
    --- PASS: TestAgentStats_IsAvailable/Full (0.00s)
    --- PASS: TestAgentStats_IsAvailable/Single_slot_available (0.00s)
    --- PASS: TestAgentStats_IsAvailable/Single_slot_full (0.00s)
=== RUN   TestAgentStats_UtilizationPercent
=== RUN   TestAgentStats_UtilizationPercent/Empty
=== RUN   TestAgentStats_UtilizationPercent/Half
=== RUN   TestAgentStats_UtilizationPercent/Full
=== RUN   TestAgentStats_UtilizationPercent/Three_quarters
=== RUN   TestAgentStats_UtilizationPercent/Zero_max
--- PASS: TestAgentStats_UtilizationPercent (0.00s)
    --- PASS: TestAgentStats_UtilizationPercent/Empty (0.00s)
    --- PASS: TestAgentStats_UtilizationPercent/Half (0.00s)
    --- PASS: TestAgentStats_UtilizationPercent/Full (0.00s)
    --- PASS: TestAgentStats_UtilizationPercent/Three_quarters (0.00s)
    --- PASS: TestAgentStats_UtilizationPercent/Zero_max (0.00s)
=== RUN   TestAgentPool_ConcurrentAcquireRelease
--- PASS: TestAgentPool_ConcurrentAcquireRelease (0.00s)
=== RUN   TestAgentPool_StressTest
    agent_pool_test.go:410: Stress test: 1000 goroutines, max concurrent: 10
--- PASS: TestAgentPool_StressTest (0.01s)
=== RUN   TestConflictDetector_NewConflictDetector
--- PASS: TestConflictDetector_NewConflictDetector (0.00s)
=== RUN   TestConflictDetector_RegisterAndUnregister
--- PASS: TestConflictDetector_RegisterAndUnregister (0.00s)
=== RUN   TestConflictDetector_HasConflict_NoConflict
--- PASS: TestConflictDetector_HasConflict_NoConflict (0.00s)
=== RUN   TestConflictDetector_HasConflict_WithConflict
--- PASS: TestConflictDetector_HasConflict_WithConflict (0.00s)
=== RUN   TestConflictDetector_HasConflict_SameSBI
--- PASS: TestConflictDetector_HasConflict_SameSBI (0.00s)
=== RUN   TestConflictDetector_GetConflictingSBIID
--- PASS: TestConflictDetector_GetConflictingSBIID (0.00s)
=== RUN   TestConflictDetector_Clear
--- PASS: TestConflictDetector_Clear (0.00s)
=== RUN   TestConflictDetector_ConcurrentAccess
--- PASS: TestConflictDetector_ConcurrentAccess (0.00s)
=== RUN   TestConflictDetector_MultipleFilesConflict
--- PASS: TestConflictDetector_MultipleFilesConflict (0.00s)
=== RUN   TestConflictDetector_UnregisterPartial
--- PASS: TestConflictDetector_UnregisterPartial (0.00s)
=== RUN   TestConflictDetector_EmptyFilePaths
--- PASS: TestConflictDetector_EmptyFilePaths (0.00s)
=== RUN   TestLockService_AcquireAndReleaseRunLock
--- PASS: TestLockService_AcquireAndReleaseRunLock (0.00s)
=== RUN   TestLockService_AcquireAndReleaseStateLock
--- PASS: TestLockService_AcquireAndReleaseStateLock (0.00s)
=== RUN   TestLockService_RunLockHeartbeat
--- PASS: TestLockService_RunLockHeartbeat (0.55s)
=== RUN   TestLockService_StateLockHeartbeat
--- PASS: TestLockService_StateLockHeartbeat (0.55s)
=== RUN   TestLockService_CleanupScheduler
--- PASS: TestLockService_CleanupScheduler (0.50s)
=== RUN   TestLockService_Stop
--- PASS: TestLockService_Stop (0.50s)
=== RUN   TestLockService_ExtendRunLock
--- PASS: TestLockService_ExtendRunLock (0.00s)
=== RUN   TestLockService_ExtendStateLock
--- PASS: TestLockService_ExtendStateLock (0.00s)
=== RUN   TestLockService_ListLocks
--- PASS: TestLockService_ListLocks (0.00s)
=== RUN   TestSBIExecutionService_PickNextSBI_InProgress
--- PASS: TestSBIExecutionService_PickNextSBI_InProgress (0.00s)
=== RUN   TestSBIExecutionService_PickNextSBI_Pending
--- PASS: TestSBIExecutionService_PickNextSBI_Pending (0.00s)
=== RUN   TestSBIExecutionService_PickNextSBI_NoTasks
--- PASS: TestSBIExecutionService_PickNextSBI_NoTasks (0.00s)
=== RUN   TestSBIExecutionService_GetSBIByID
--- PASS: TestSBIExecutionService_GetSBIByID (0.00s)
=== RUN   TestSBIExecutionService_UpdateSBI
--- PASS: TestSBIExecutionService_UpdateSBI (0.00s)
=== RUN   TestSBIExecutionService_AcquireSBILock
--- PASS: TestSBIExecutionService_AcquireSBILock (0.00s)
=== RUN   TestSBIExecutionService_AcquireSBILock_AlreadyLocked
--- PASS: TestSBIExecutionService_AcquireSBILock_AlreadyLocked (0.00s)
=== RUN   TestSBIExecutionService_ReleaseSBILock
--- PASS: TestSBIExecutionService_ReleaseSBILock (0.00s)
=== RUN   TestSBIExecutionService_PickAndLockNextSBI
--- PASS: TestSBIExecutionService_PickAndLockNextSBI (0.00s)
=== RUN   TestSBIExecutionService_PickAndLockNextSBI_NoTasks
--- PASS: TestSBIExecutionService_PickAndLockNextSBI_NoTasks (0.00s)
=== RUN   TestSBIExecutionService_PickAndLockNextSBI_LockAlreadyHeld
--- PASS: TestSBIExecutionService_PickAndLockNextSBI_LockAlreadyHeld (0.00s)
=== RUN   ExampleAgentPool
--- PASS: ExampleAgentPool (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/application/service	(cached)
?   	github.com/YoshitsuguKoike/deespec/internal/application/usecase	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/application/usecase/execution	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/application/usecase/task	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/application/usecase/workflow	[no test files]
=== RUN   TestWorkflowManager_NewWorkflowManager
--- PASS: TestWorkflowManager_NewWorkflowManager (0.00s)
=== RUN   TestWorkflowManager_RegisterWorkflow
--- PASS: TestWorkflowManager_RegisterWorkflow (0.00s)
=== RUN   TestWorkflowManager_GetEnabledWorkflows
--- PASS: TestWorkflowManager_GetEnabledWorkflows (0.00s)
=== RUN   TestWorkflowManager_RunWorkflow
--- PASS: TestWorkflowManager_RunWorkflow (0.20s)
=== RUN   TestWorkflowManager_RunAll
--- PASS: TestWorkflowManager_RunAll (0.20s)
=== RUN   TestWorkflowManager_ErrorHandling
--- PASS: TestWorkflowManager_ErrorHandling (0.20s)
=== RUN   TestWorkflowManager_Stats
--- PASS: TestWorkflowManager_Stats (0.20s)
=== RUN   TestWorkflowManager_ConcurrentAccess
--- PASS: TestWorkflowManager_ConcurrentAccess (0.11s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/application/workflow	(cached)
?   	github.com/YoshitsuguKoike/deespec/internal/buildinfo	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/domain	[no test files]
=== RUN   TestNewSBIExecution
--- PASS: TestNewSBIExecution (0.00s)
=== RUN   TestExecutionTransitions
=== RUN   TestExecutionTransitions/Ready_to_Implement
=== RUN   TestExecutionTransitions/Implement_to_Review
=== RUN   TestExecutionTransitions/Review_to_Implement_(retry)
=== RUN   TestExecutionTransitions/Review_to_Done_(success)
=== RUN   TestExecutionTransitions/Invalid:_Ready_to_Done
=== RUN   TestExecutionTransitions/Invalid:_Implement_to_Implement
--- PASS: TestExecutionTransitions (0.00s)
    --- PASS: TestExecutionTransitions/Ready_to_Implement (0.00s)
    --- PASS: TestExecutionTransitions/Implement_to_Review (0.00s)
    --- PASS: TestExecutionTransitions/Review_to_Implement_(retry) (0.00s)
    --- PASS: TestExecutionTransitions/Review_to_Done_(success) (0.00s)
    --- PASS: TestExecutionTransitions/Invalid:_Ready_to_Done (0.00s)
    --- PASS: TestExecutionTransitions/Invalid:_Implement_to_Implement (0.00s)
=== RUN   TestApplyDecision
=== RUN   TestApplyDecision/Apply_Succeeded_in_Review
=== RUN   TestApplyDecision/Apply_NeedsChanges_in_Review
=== RUN   TestApplyDecision/Cannot_apply_in_WIP
=== RUN   TestApplyDecision/Cannot_apply_in_Ready
=== RUN   TestApplyDecision/Invalid_decision
--- PASS: TestApplyDecision (0.00s)
    --- PASS: TestApplyDecision/Apply_Succeeded_in_Review (0.00s)
    --- PASS: TestApplyDecision/Apply_NeedsChanges_in_Review (0.00s)
    --- PASS: TestApplyDecision/Cannot_apply_in_WIP (0.00s)
    --- PASS: TestApplyDecision/Cannot_apply_in_Ready (0.00s)
    --- PASS: TestApplyDecision/Invalid_decision (0.00s)
=== RUN   TestNextStepLogic
=== RUN   TestNextStepLogic/Ready_->_Implement
=== RUN   TestNextStepLogic/First_Review_Success_->_Done
=== RUN   TestNextStepLogic/First_Review_Fail_->_Second_Try
=== RUN   TestNextStepLogic/Second_Review_Success_->_Done
=== RUN   TestNextStepLogic/Second_Review_Fail_->_Third_Try
=== RUN   TestNextStepLogic/Third_Review_Success_->_Done
=== RUN   TestNextStepLogic/Third_Review_Fail_->_Force
=== RUN   TestNextStepLogic/Force_->_Implementer_Review
=== RUN   TestNextStepLogic/Implementer_Review_->_Done
--- PASS: TestNextStepLogic (0.00s)
    --- PASS: TestNextStepLogic/Ready_->_Implement (0.00s)
    --- PASS: TestNextStepLogic/First_Review_Success_->_Done (0.00s)
    --- PASS: TestNextStepLogic/First_Review_Fail_->_Second_Try (0.00s)
    --- PASS: TestNextStepLogic/Second_Review_Success_->_Done (0.00s)
    --- PASS: TestNextStepLogic/Second_Review_Fail_->_Third_Try (0.00s)
    --- PASS: TestNextStepLogic/Third_Review_Success_->_Done (0.00s)
    --- PASS: TestNextStepLogic/Third_Review_Fail_->_Force (0.00s)
    --- PASS: TestNextStepLogic/Force_->_Implementer_Review (0.00s)
    --- PASS: TestNextStepLogic/Implementer_Review_->_Done (0.00s)
=== RUN   TestShouldForceTerminate
=== RUN   TestShouldForceTerminate/Not_enough_attempts
=== RUN   TestShouldForceTerminate/Three_attempts_with_failure
=== RUN   TestShouldForceTerminate/Three_attempts_but_success
=== RUN   TestShouldForceTerminate/Four_attempts
--- PASS: TestShouldForceTerminate (0.00s)
    --- PASS: TestShouldForceTerminate/Not_enough_attempts (0.00s)
    --- PASS: TestShouldForceTerminate/Three_attempts_with_failure (0.00s)
    --- PASS: TestShouldForceTerminate/Three_attempts_but_success (0.00s)
    --- PASS: TestShouldForceTerminate/Four_attempts (0.00s)
=== RUN   TestGetFinalDecision
=== RUN   TestGetFinalDecision/Not_completed
=== RUN   TestGetFinalDecision/Completed_with_Success
=== RUN   TestGetFinalDecision/Completed_with_Failure
=== RUN   TestGetFinalDecision/Completed_after_force_termination
--- PASS: TestGetFinalDecision (0.00s)
    --- PASS: TestGetFinalDecision/Not_completed (0.00s)
    --- PASS: TestGetFinalDecision/Completed_with_Success (0.00s)
    --- PASS: TestGetFinalDecision/Completed_with_Failure (0.00s)
    --- PASS: TestGetFinalDecision/Completed_after_force_termination (0.00s)
=== RUN   TestIsCompleted
=== RUN   TestIsCompleted/Not_completed_-_Ready
=== RUN   TestIsCompleted/Not_completed_-_Implementation
=== RUN   TestIsCompleted/Not_completed_-_Review
=== RUN   TestIsCompleted/Completed_-_Done
--- PASS: TestIsCompleted (0.00s)
    --- PASS: TestIsCompleted/Not_completed_-_Ready (0.00s)
    --- PASS: TestIsCompleted/Not_completed_-_Implementation (0.00s)
    --- PASS: TestIsCompleted/Not_completed_-_Review (0.00s)
    --- PASS: TestIsCompleted/Completed_-_Done (0.00s)
=== RUN   TestAttemptIncrement
--- PASS: TestAttemptIncrement (0.00s)
=== RUN   TestTimingFields
--- PASS: TestTimingFields (0.05s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/domain/execution	(cached)
?   	github.com/YoshitsuguKoike/deespec/internal/domain/factory	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/domain/model	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/domain/model/epic	[no test files]
=== RUN   TestNewLabel
--- PASS: TestNewLabel (0.00s)
=== RUN   TestReconstructLabel
--- PASS: TestReconstructLabel (0.00s)
=== RUN   TestSetContentHash
--- PASS: TestSetContentHash (0.00s)
=== RUN   TestSetLineCount
--- PASS: TestSetLineCount (0.00s)
=== RUN   TestUpdateSyncTime
--- PASS: TestUpdateSyncTime (0.01s)
=== RUN   TestActivateDeactivate
--- PASS: TestActivateDeactivate (0.00s)
=== RUN   TestAddRemoveTemplatePath
--- PASS: TestAddRemoveTemplatePath (0.00s)
=== RUN   TestClearContentHashes
--- PASS: TestClearContentHashes (0.00s)
=== RUN   TestSetParentLabelID
--- PASS: TestSetParentLabelID (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/domain/model/label	(cached)
?   	github.com/YoshitsuguKoike/deespec/internal/domain/model/lock	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/domain/model/pbi	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/domain/model/sbi	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/domain/model/task	[no test files]
testing: warning: no tests to run
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/domain/repository	(cached) [no tests to run]
?   	github.com/YoshitsuguKoike/deespec/internal/domain/service/strategy	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/embed	[no test files]
=== RUN   TestHelloWorld
--- PASS: TestHelloWorld (0.00s)
=== RUN   TestHelloWithName
=== RUN   TestHelloWithName/with_valid_name
=== RUN   TestHelloWithName/with_another_name
=== RUN   TestHelloWithName/with_empty_string
--- PASS: TestHelloWithName (0.00s)
    --- PASS: TestHelloWithName/with_valid_name (0.00s)
    --- PASS: TestHelloWithName/with_another_name (0.00s)
    --- PASS: TestHelloWithName/with_empty_string (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/hello	(cached)
=== RUN   TestLoadSettings
=== RUN   TestLoadSettings/Default_values_only
=== RUN   TestLoadSettings/JSON_file_only
--- PASS: TestLoadSettings (0.01s)
    --- PASS: TestLoadSettings/Default_values_only (0.00s)
    --- PASS: TestLoadSettings/JSON_file_only (0.01s)
=== RUN   TestToBool
=== RUN   TestToBool/1
=== RUN   TestToBool/true
=== RUN   TestToBool/TRUE
=== RUN   TestToBool/True
=== RUN   TestToBool/yes
=== RUN   TestToBool/YES
=== RUN   TestToBool/on
=== RUN   TestToBool/ON
=== RUN   TestToBool/0
=== RUN   TestToBool/false
=== RUN   TestToBool/FALSE
=== RUN   TestToBool/no
=== RUN   TestToBool/off
=== RUN   TestToBool/#00
=== RUN   TestToBool/invalid
--- PASS: TestToBool (0.00s)
    --- PASS: TestToBool/1 (0.00s)
    --- PASS: TestToBool/true (0.00s)
    --- PASS: TestToBool/TRUE (0.00s)
    --- PASS: TestToBool/True (0.00s)
    --- PASS: TestToBool/yes (0.00s)
    --- PASS: TestToBool/YES (0.00s)
    --- PASS: TestToBool/on (0.00s)
    --- PASS: TestToBool/ON (0.00s)
    --- PASS: TestToBool/0 (0.00s)
    --- PASS: TestToBool/false (0.00s)
    --- PASS: TestToBool/FALSE (0.00s)
    --- PASS: TestToBool/no (0.00s)
    --- PASS: TestToBool/off (0.00s)
    --- PASS: TestToBool/#00 (0.00s)
    --- PASS: TestToBool/invalid (0.00s)
=== RUN   TestCreateDefaultSettings
--- PASS: TestCreateDefaultSettings (0.00s)
=== RUN   TestLoadSettings_LabelConfig
=== RUN   TestLoadSettings_LabelConfig/Default_label_config
=== RUN   TestLoadSettings_LabelConfig/Custom_label_config_from_JSON
--- PASS: TestLoadSettings_LabelConfig (0.00s)
    --- PASS: TestLoadSettings_LabelConfig/Default_label_config (0.00s)
    --- PASS: TestLoadSettings_LabelConfig/Custom_label_config_from_JSON (0.00s)
=== RUN   TestLoadSettings_AgentPoolConfig
=== RUN   TestLoadSettings_AgentPoolConfig/Default_agent_pool_config
=== RUN   TestLoadSettings_AgentPoolConfig/Custom_agent_pool_config_from_JSON
=== RUN   TestLoadSettings_AgentPoolConfig/Partial_agent_pool_config
--- PASS: TestLoadSettings_AgentPoolConfig (0.00s)
    --- PASS: TestLoadSettings_AgentPoolConfig/Default_agent_pool_config (0.00s)
    --- PASS: TestLoadSettings_AgentPoolConfig/Custom_agent_pool_config_from_JSON (0.00s)
    --- PASS: TestLoadSettings_AgentPoolConfig/Partial_agent_pool_config (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/infra/config	(cached)
=== RUN   TestFsyncFile
--- PASS: TestFsyncFile (0.01s)
=== RUN   TestFsyncDir
--- PASS: TestFsyncDir (0.01s)
=== RUN   TestAtomicRename
--- PASS: TestAtomicRename (0.01s)
=== RUN   TestWriteFileSync
--- PASS: TestWriteFileSync (0.02s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/infra/fs	(cached)
=== RUN   TestChecksumMismatchRecoveryIntegration
=== RUN   TestChecksumMismatchRecoveryIntegration/ChecksumMismatchFailsGracefully
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/var/txn/txn_1760108556_345286000/stage/test_file.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

ERROR: Checksum validation failed txn.checksum.validation.failed=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/var/txn/txn_1760108556_345286000/stage/test_file.txt txn.checksum.calculation.duration_ms=0ms error=size_mismatch expected_size=34 actual_size=30

=== RUN   TestChecksumMismatchRecoveryIntegration/RecoveryDetectsCorruptedTransaction
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/var/txn/txn_1760108556_387790000/stage/recovery_test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

[TXN-SCAN] 2025/10/11 00:02:36 WARN: Found transaction with intent but no commit txn.id=txn_1760108556_345286000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/11 00:02:36 WARN: Found transaction with intent but no commit txn.id=txn_1760108556_387790000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/11 00:02:36 SUMMARY: Transaction scan complete txn.scan.total=2 txn.scan.timestamp=2025-10-10T15:02:36Z
[TXN-SCAN] 2025/10/11 00:02:36   - Forward recovery needed txn.scan.intent_only_count=2 txn.scan.intent_only_ids=[txn_1760108556_345286000,txn_1760108556_387790000]
[TXN-SCAN] 2025/10/11 00:02:36 NOTE: Recovery disabled txn.scan.recovery_action=none txn.cleanup_policy=pending_step8
ERROR: Checksum validation failed txn.checksum.validation.failed=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/var/txn/txn_1760108556_345286000/stage/test_file.txt txn.checksum.calculation.duration_ms=0ms error=size_mismatch expected_size=34 actual_size=30

WARN: Transaction recovery timeout/cancelled txn.id=txn_1760108556_345286000 txn.retry.attempt=0

ERROR: Failed to recover transaction txn.recover.forward.failed=txn_1760108556_345286000 error=transaction recovery failed after 4 attempts: failed to complete commit during recovery: staged file checksum validation failed for test_file.txt: file size mismatch: expected 34 bytes, got 30 bytes

ERROR: Checksum validation failed txn.checksum.validation.failed=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/var/txn/txn_1760108556_387790000/stage/recovery_test.txt txn.checksum.calculation.duration_ms=0ms error=size_mismatch expected_size=21 actual_size=26

WARN: Transaction recovery timeout/cancelled txn.id=txn_1760108556_387790000 txn.retry.attempt=0

ERROR: Failed to recover transaction txn.recover.forward.failed=txn_1760108556_387790000 error=transaction recovery failed after 4 attempts: failed to complete commit during recovery: staged file checksum validation failed for recovery_test.txt: file size mismatch: expected 21 bytes, got 26 bytes

INFO: Recovery complete txn.recover.forward.count=2 txn.recover.forward.success=0 txn.cleanup.success=0 txn.recover.duration_ms=2

=== RUN   TestChecksumMismatchRecoveryIntegration/ParallelChecksumValidationDuringRecovery
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/TestChecksumMismatchRecoveryIntegrationParallelChecksumValidationDuringRecovery4168651955/001/.deespec/var/txn/txn_1760108556_427595000/stage/parallel_test_A.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/TestChecksumMismatchRecoveryIntegrationParallelChecksumValidationDuringRecovery4168651955/001/.deespec/var/txn/txn_1760108556_465898000/stage/parallel_test_B.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/TestChecksumMismatchRecoveryIntegrationParallelChecksumValidationDuringRecovery4168651955/001/.deespec/var/txn/txn_1760108556_505853000/stage/parallel_test_C.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

[TXN-SCAN] 2025/10/11 00:02:36 WARN: Found transaction with intent but no commit txn.id=txn_1760108556_427595000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/11 00:02:36 WARN: Found transaction with intent but no commit txn.id=txn_1760108556_465898000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/11 00:02:36 WARN: Found transaction with intent but no commit txn.id=txn_1760108556_505853000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/11 00:02:36 SUMMARY: Transaction scan complete txn.scan.total=3 txn.scan.timestamp=2025-10-10T15:02:36Z
[TXN-SCAN] 2025/10/11 00:02:36   - Forward recovery needed txn.scan.intent_only_count=3 txn.scan.intent_only_ids=[txn_1760108556_427595000,txn_1760108556_465898000,txn_1760108556_505853000]
[TXN-SCAN] 2025/10/11 00:02:36 NOTE: Recovery disabled txn.scan.recovery_action=none txn.cleanup_policy=pending_step8
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/TestChecksumMismatchRecoveryIntegrationParallelChecksumValidationDuringRecovery4168651955/001/.deespec/var/txn/txn_1760108556_427595000/stage/parallel_test_A.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/TestChecksumMismatchRecoveryIntegrationParallelChecksumValidationDuringRecovery4168651955/001/.deespec/parallel_test_A.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1760108556_427595000

INFO: Recovered transaction txn.recover.forward.success=txn_1760108556_427595000

ERROR: Checksum validation failed txn.checksum.validation.failed=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/TestChecksumMismatchRecoveryIntegrationParallelChecksumValidationDuringRecovery4168651955/001/.deespec/var/txn/txn_1760108556_465898000/stage/parallel_test_B.txt txn.checksum.calculation.duration_ms=0ms error=size_mismatch expected_size=23 actual_size=26

WARN: Transaction recovery timeout/cancelled txn.id=txn_1760108556_465898000 txn.retry.attempt=0

ERROR: Failed to recover transaction txn.recover.forward.failed=txn_1760108556_465898000 error=transaction recovery failed after 4 attempts: failed to complete commit during recovery: staged file checksum validation failed for parallel_test_B.txt: file size mismatch: expected 23 bytes, got 26 bytes

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/TestChecksumMismatchRecoveryIntegrationParallelChecksumValidationDuringRecovery4168651955/001/.deespec/var/txn/txn_1760108556_505853000/stage/parallel_test_C.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/TestChecksumMismatchRecoveryIntegrationParallelChecksumValidationDuringRecovery4168651955/001/.deespec/parallel_test_C.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1760108556_505853000

INFO: Recovered transaction txn.recover.forward.success=txn_1760108556_505853000

INFO: Recovery complete txn.recover.forward.count=3 txn.recover.forward.success=2 txn.cleanup.success=0 txn.recover.duration_ms=41

=== RUN   TestChecksumMismatchRecoveryIntegration/LargeTransactionWorkerPoolValidation
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/var/txn/txn_1760108556_591635000/stage/worker_test_0.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/var/txn/txn_1760108556_591635000/stage/worker_test_1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/var/txn/txn_1760108556_591635000/stage/worker_test_2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/var/txn/txn_1760108556_591635000/stage/worker_test_3.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/var/txn/txn_1760108556_591635000/stage/worker_test_4.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/var/txn/txn_1760108556_591635000/stage/worker_test_5.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/var/txn/txn_1760108556_591635000/stage/worker_test_6.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/var/txn/txn_1760108556_591635000/stage/worker_test_7.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/var/txn/txn_1760108556_591635000/stage/worker_test_1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/var/txn/txn_1760108556_591635000/stage/worker_test_0.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/var/txn/txn_1760108556_591635000/stage/worker_test_2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/var/txn/txn_1760108556_591635000/stage/worker_test_4.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/var/txn/txn_1760108556_591635000/stage/worker_test_5.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/var/txn/txn_1760108556_591635000/stage/worker_test_6.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/var/txn/txn_1760108556_591635000/stage/worker_test_3.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/var/txn/txn_1760108556_591635000/stage/worker_test_7.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Using parallel checksum validation txn.checksum.parallel=true txn.files=8 txn.workers=4

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/var/txn/txn_1760108556_591635000/stage/worker_test_1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/var/txn/txn_1760108556_591635000/stage/worker_test_3.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/var/txn/txn_1760108556_591635000/stage/worker_test_0.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/var/txn/txn_1760108556_591635000/stage/worker_test_4.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/var/txn/txn_1760108556_591635000/stage/worker_test_5.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/var/txn/txn_1760108556_591635000/stage/worker_test_6.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/var/txn/txn_1760108556_591635000/stage/worker_test_7.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/var/txn/txn_1760108556_591635000/stage/worker_test_2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/worker_test_0.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/worker_test_1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/worker_test_2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/worker_test_3.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/worker_test_4.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/worker_test_5.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/worker_test_6.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_2763671360/.deespec/worker_test_7.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1760108556_591635000

--- PASS: TestChecksumMismatchRecoveryIntegration (0.48s)
    --- PASS: TestChecksumMismatchRecoveryIntegration/ChecksumMismatchFailsGracefully (0.04s)
    --- PASS: TestChecksumMismatchRecoveryIntegration/RecoveryDetectsCorruptedTransaction (0.04s)
    --- PASS: TestChecksumMismatchRecoveryIntegration/ParallelChecksumValidationDuringRecovery (0.16s)
    --- PASS: TestChecksumMismatchRecoveryIntegration/LargeTransactionWorkerPoolValidation (0.23s)
=== RUN   TestChecksumCalculation
--- PASS: TestChecksumCalculation (0.00s)
=== RUN   TestChecksumValidation
--- PASS: TestChecksumValidation (0.00s)
=== RUN   TestFileChecksumValidation
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_test_4283688950/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

ERROR: Checksum validation failed txn.checksum.validation.failed=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_test_4283688950/test.txt txn.checksum.calculation.duration_ms=0ms error=size_mismatch expected_size=26 actual_size=21

--- PASS: TestFileChecksumValidation (0.00s)
=== RUN   TestTransactionChecksumIntegration
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_checksum_test_2791208661/.deespec/var/txn/txn_1760108556_824415000/stage/checksum_test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_checksum_test_2791208661/.deespec/var/txn/txn_1760108556_824415000/stage/checksum_test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_checksum_test_2791208661/.deespec/checksum_test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1760108556_824415000

--- PASS: TestTransactionChecksumIntegration (0.06s)
=== RUN   TestChecksumCorruptionDetection
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/corruption_test_3539963098/.deespec/var/txn/txn_1760108556_882175000/stage/corrupt_test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

ERROR: Checksum validation failed txn.checksum.validation.failed=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/corruption_test_3539963098/.deespec/var/txn/txn_1760108556_882175000/stage/corrupt_test.txt txn.checksum.calculation.duration_ms=0ms error=size_mismatch expected_size=25 actual_size=17

--- PASS: TestChecksumCorruptionDetection (0.04s)
=== RUN   TestUnsupportedChecksumAlgorithm
--- PASS: TestUnsupportedChecksumAlgorithm (0.00s)
=== RUN   TestCompareFileChecksums
--- PASS: TestCompareFileChecksums (0.00s)
=== RUN   TestMetricsRaceConditions
=== RUN   TestMetricsRaceConditions/ConcurrentIncrements
=== RUN   TestMetricsRaceConditions/ConcurrentReadWrite
=== RUN   TestMetricsRaceConditions/ConcurrentFileAccess
=== RUN   TestMetricsRaceConditions/ConcurrentSnapshotOperations
INFO: Metrics snapshot created path=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/metrics_race_test_280720151/snapshots/metrics_20251010_150237_863483000.json

INFO: Metrics snapshot created path=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/metrics_race_test_280720151/snapshots/metrics_20251010_150237_863762000.json

INFO: Metrics snapshot created path=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/metrics_race_test_280720151/snapshots/metrics_20251010_150237_863472000.json

INFO: Metrics snapshot created path=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/metrics_race_test_280720151/snapshots/metrics_20251010_150237_863731000.json

INFO: Metrics snapshot created path=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/metrics_race_test_280720151/snapshots/metrics_20251010_150237_864068000.json

INFO: Metrics rotated and reset counters=false
INFO: Metrics snapshot created path=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/metrics_race_test_280720151/snapshots/metrics_20251010_150237_864152000.json

INFO: Metrics rotated and reset counters=false
INFO: Metrics snapshot created path=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/metrics_race_test_280720151/snapshots/metrics_20251010_150237_864228000.json

INFO: Metrics rotated and reset counters=false
INFO: Metrics snapshot created path=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/metrics_race_test_280720151/snapshots/metrics_20251010_150237_864312000.json

INFO: Metrics rotated and reset counters=false
--- PASS: TestMetricsRaceConditions (0.94s)
    --- PASS: TestMetricsRaceConditions/ConcurrentIncrements (0.00s)
    --- PASS: TestMetricsRaceConditions/ConcurrentReadWrite (0.00s)
    --- PASS: TestMetricsRaceConditions/ConcurrentFileAccess (0.93s)
    --- PASS: TestMetricsRaceConditions/ConcurrentSnapshotOperations (0.00s)
=== RUN   TestMetricsDeadlockDetection
    metrics_race_test.go:282: Deadlock test completed successfully
--- PASS: TestMetricsDeadlockDetection (0.23s)
=== RUN   TestMultiProcessConcurrentMetrics
    multiprocess_e2e_test.go:108: Final metrics after 3 processes × 20 operations:
    multiprocess_e2e_test.go:109:   CommitSuccess: 15
    multiprocess_e2e_test.go:110:   CommitFailed: 15
    multiprocess_e2e_test.go:111:   CASConflicts: 15
    multiprocess_e2e_test.go:112:   RecoveryCount: 15
    multiprocess_e2e_test.go:113:   SchemaVersion: 1
--- PASS: TestMultiProcessConcurrentMetrics (0.27s)
=== RUN   TestMultiProcessRegisterAndStateTransactions
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_361708000/stage/specs/process-0-txn-0/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_361727000/stage/specs/process-1-txn-0/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_361727000/stage/specs/process-1-txn-0/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_361708000/stage/specs/process-0-txn-0/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_361708000/stage/specs/process-0-txn-0/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_361708000/stage/specs/process-0-txn-0/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_361727000/stage/specs/process-1-txn-0/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_361727000/stage/specs/process-1-txn-0/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/specs/process-0-txn-0/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=1ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/specs/process-1-txn-0/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=1ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/specs/process-0-txn-0/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/specs/process-1-txn-0/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_513916000/stage/specs/process-0-txn-1/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_517087000/stage/specs/process-1-txn-1/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=1ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_513916000/stage/specs/process-0-txn-1/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_517087000/stage/specs/process-1-txn-1/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_513916000/stage/specs/process-0-txn-1/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_513916000/stage/specs/process-0-txn-1/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_517087000/stage/specs/process-1-txn-1/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_517087000/stage/specs/process-1-txn-1/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/specs/process-0-txn-1/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/specs/process-1-txn-1/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/specs/process-0-txn-1/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/specs/process-1-txn-1/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=1ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_679108000/stage/specs/process-0-txn-2/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_683261000/stage/specs/process-1-txn-2/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_679108000/stage/specs/process-0-txn-2/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_683261000/stage/specs/process-1-txn-2/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_679108000/stage/specs/process-0-txn-2/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_679108000/stage/specs/process-0-txn-2/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_683261000/stage/specs/process-1-txn-2/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_683261000/stage/specs/process-1-txn-2/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/specs/process-0-txn-2/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/specs/process-1-txn-2/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/specs/process-0-txn-2/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/specs/process-1-txn-2/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_835821000/stage/specs/process-0-txn-3/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_839154000/stage/specs/process-1-txn-3/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_835821000/stage/specs/process-0-txn-3/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_839154000/stage/specs/process-1-txn-3/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_835821000/stage/specs/process-0-txn-3/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_835821000/stage/specs/process-0-txn-3/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_839154000/stage/specs/process-1-txn-3/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_839154000/stage/specs/process-1-txn-3/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/specs/process-0-txn-3/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/specs/process-1-txn-3/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/specs/process-0-txn-3/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/specs/process-1-txn-3/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_995767000/stage/specs/process-0-txn-4/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_999175000/stage/specs/process-1-txn-4/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_995767000/stage/specs/process-0-txn-4/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_999175000/stage/specs/process-1-txn-4/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_995767000/stage/specs/process-0-txn-4/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_995767000/stage/specs/process-0-txn-4/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_999175000/stage/specs/process-1-txn-4/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/var/txn/txn_1760108558_999175000/stage/specs/process-1-txn-4/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/specs/process-0-txn-4/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/specs/process-1-txn-4/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/specs/process-1-txn-4/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1354485471/.deespec/specs/process-0-txn-4/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

    multiprocess_e2e_test.go:248: Multi-process register/state-tx test completed:
    multiprocess_e2e_test.go:249:   Expected successes: 10
    multiprocess_e2e_test.go:250:   Actual successes: 55
    multiprocess_e2e_test.go:251:   Actual failures: 0
    multiprocess_e2e_test.go:274: Multi-process E2E test completed successfully
    multiprocess_e2e_test.go:275: File locking and metrics synchronization verified
--- PASS: TestMultiProcessRegisterAndStateTransactions (0.81s)
=== RUN   TestMultiProcessMetricsConsistency
    multiprocess_e2e_test.go:367: High-concurrency test results:
    multiprocess_e2e_test.go:368:   Processes: 5
    multiprocess_e2e_test.go:369:   Operations per process: 100
    multiprocess_e2e_test.go:370:   Minimum expected: 500
    multiprocess_e2e_test.go:371:   Actual final count: 500
    multiprocess_e2e_test.go:377: Multi-process consistency test passed - file locking prevented data corruption
--- PASS: TestMultiProcessMetricsConsistency (2.18s)
=== RUN   TestForwardRecovery
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_test_2493331485/.deespec/var/txn/txn_1760108561_353045000/stage/test1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_test_2493331485/.deespec/var/txn/txn_1760108561_353045000/stage/test2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

[TXN-SCAN] 2025/10/11 00:02:41 WARN: Found transaction with intent but no commit txn.id=txn_1760108561_353045000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/11 00:02:41 SUMMARY: Transaction scan complete txn.scan.total=1 txn.scan.timestamp=2025-10-10T15:02:41Z
[TXN-SCAN] 2025/10/11 00:02:41   - Forward recovery needed txn.scan.intent_only_count=1 txn.scan.intent_only_ids=[txn_1760108561_353045000]
[TXN-SCAN] 2025/10/11 00:02:41 NOTE: Recovery disabled txn.scan.recovery_action=none txn.cleanup_policy=pending_step8
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_test_2493331485/.deespec/var/txn/txn_1760108561_353045000/stage/test1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_test_2493331485/.deespec/var/txn/txn_1760108561_353045000/stage/test2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_test_2493331485/.deespec/test1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_test_2493331485/.deespec/test2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1760108561_353045000

INFO: Recovered transaction txn.recover.forward.success=txn_1760108561_353045000

INFO: Recovery complete txn.recover.forward.count=1 txn.recover.forward.success=1 txn.cleanup.success=0 txn.recover.duration_ms=27

--- PASS: TestForwardRecovery (0.08s)
=== RUN   TestIdempotentCommit
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/idempotent_test_1649327040/.deespec/var/txn/txn_1760108561_435901000/stage/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/idempotent_test_1649327040/.deespec/var/txn/txn_1760108561_435901000/stage/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/idempotent_test_1649327040/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1760108561_435901000

INFO: Transaction already committed (no-op) txn.commit.idempotent=true txn.id=txn_1760108561_435901000

--- PASS: TestIdempotentCommit (0.06s)
=== RUN   TestCleanupAfterCommit
[TXN-SCAN] 2025/10/11 00:02:41 INFO: Found completed transaction txn.id=txn_test_cleanup txn.state=committed txn.action=cleanup_ready
[TXN-SCAN] 2025/10/11 00:02:41 SUMMARY: Transaction scan complete txn.scan.total=1 txn.scan.timestamp=2025-10-10T15:02:41Z
[TXN-SCAN] 2025/10/11 00:02:41   - Ready for cleanup txn.scan.committed_count=1 txn.scan.committed_ids=[txn_test_cleanup]
[TXN-SCAN] 2025/10/11 00:02:41 NOTE: Recovery disabled txn.scan.recovery_action=none txn.cleanup_policy=pending_step8
INFO: Cleaned up transaction txn.cleanup.success=txn_test_cleanup

INFO: Recovery complete txn.recover.forward.count=0 txn.recover.forward.success=0 txn.cleanup.success=1 txn.recover.duration_ms=1

--- PASS: TestCleanupAfterCommit (0.00s)
=== RUN   TestEarlyEXDEVDetection
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/exdev_test_3367178625/.deespec/var/txn/txn_1760108561_500470000/stage/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

    recovery_test.go:214: Same filesystem - no EXDEV error (expected)
--- PASS: TestEarlyEXDEVDetection (0.03s)
=== RUN   TestE2ECrashRecoveryWithRetry
=== RUN   TestE2ECrashRecoveryWithRetry/MultipleTransactionCrashRecovery
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_838489306/.deespec/var/txn/txn_1760108561_533383000/stage/artifacts/fileA.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_838489306/.deespec/var/txn/txn_1760108561_573834000/stage/artifacts/fileB.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_838489306/.deespec/var/txn/txn_1760108561_612788000/stage/artifacts/fileC.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

[TXN-SCAN] 2025/10/11 00:02:41 WARN: Found transaction with intent but no commit txn.id=txn_1760108561_533383000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/11 00:02:41 WARN: Found transaction with intent but no commit txn.id=txn_1760108561_573834000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/11 00:02:41 WARN: Found transaction with intent but no commit txn.id=txn_1760108561_612788000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/11 00:02:41 SUMMARY: Transaction scan complete txn.scan.total=3 txn.scan.timestamp=2025-10-10T15:02:41Z
[TXN-SCAN] 2025/10/11 00:02:41   - Forward recovery needed txn.scan.intent_only_count=3 txn.scan.intent_only_ids=[txn_1760108561_533383000,txn_1760108561_573834000,txn_1760108561_612788000]
[TXN-SCAN] 2025/10/11 00:02:41 NOTE: Recovery disabled txn.scan.recovery_action=none txn.cleanup_policy=pending_step8
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_838489306/.deespec/var/txn/txn_1760108561_533383000/stage/artifacts/fileA.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_838489306/.deespec/artifacts/fileA.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1760108561_533383000

INFO: Recovered transaction txn.recover.forward.success=txn_1760108561_533383000

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_838489306/.deespec/var/txn/txn_1760108561_573834000/stage/artifacts/fileB.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_838489306/.deespec/artifacts/fileB.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1760108561_573834000

INFO: Recovered transaction txn.recover.forward.success=txn_1760108561_573834000

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_838489306/.deespec/var/txn/txn_1760108561_612788000/stage/artifacts/fileC.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_838489306/.deespec/artifacts/fileC.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1760108561_612788000

INFO: Recovered transaction txn.recover.forward.success=txn_1760108561_612788000

INFO: Recovery complete txn.recover.forward.count=3 txn.recover.forward.success=3 txn.cleanup.success=0 txn.recover.duration_ms=61

=== RUN   TestE2ECrashRecoveryWithRetry/RecoveryWithTimeout
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_838489306/.deespec/var/txn/txn_1760108561_710629000/stage/timeout_test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

[TXN-SCAN] 2025/10/11 00:02:41 INFO: Found completed transaction txn.id=txn_1760108561_533383000 txn.state=committed txn.action=cleanup_ready
[TXN-SCAN] 2025/10/11 00:02:41 INFO: Found completed transaction txn.id=txn_1760108561_573834000 txn.state=committed txn.action=cleanup_ready
[TXN-SCAN] 2025/10/11 00:02:41 INFO: Found completed transaction txn.id=txn_1760108561_612788000 txn.state=committed txn.action=cleanup_ready
[TXN-SCAN] 2025/10/11 00:02:41 WARN: Found transaction with intent but no commit txn.id=txn_1760108561_710629000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/11 00:02:41 SUMMARY: Transaction scan complete txn.scan.total=4 txn.scan.timestamp=2025-10-10T15:02:41Z
[TXN-SCAN] 2025/10/11 00:02:41   - Forward recovery needed txn.scan.intent_only_count=1 txn.scan.intent_only_ids=[txn_1760108561_710629000]
[TXN-SCAN] 2025/10/11 00:02:41   - Ready for cleanup txn.scan.committed_count=3 txn.scan.committed_ids=[txn_1760108561_533383000,txn_1760108561_573834000,txn_1760108561_612788000]
[TXN-SCAN] 2025/10/11 00:02:41 NOTE: Recovery disabled txn.scan.recovery_action=none txn.cleanup_policy=pending_step8
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_838489306/.deespec/var/txn/txn_1760108561_710629000/stage/timeout_test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_838489306/.deespec/timeout_test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1760108561_710629000

INFO: Recovered transaction txn.recover.forward.success=txn_1760108561_710629000

INFO: Cleaned up transaction txn.cleanup.success=txn_1760108561_533383000

INFO: Cleaned up transaction txn.cleanup.success=txn_1760108561_573834000

INFO: Cleaned up transaction txn.cleanup.success=txn_1760108561_612788000

INFO: Recovery complete txn.recover.forward.count=1 txn.recover.forward.success=1 txn.cleanup.success=3 txn.recover.duration_ms=24

    recovery_test.go:352: Recovery succeeded despite short timeout
=== RUN   TestE2ECrashRecoveryWithRetry/RecoveryWithCorruptedTransaction
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_838489306/.deespec/var/txn/txn_1760108561_772702000/stage/corrupted_test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

[TXN-SCAN] 2025/10/11 00:02:41 INFO: Found completed transaction txn.id=txn_1760108561_710629000 txn.state=committed txn.action=cleanup_ready
[TXN-SCAN] 2025/10/11 00:02:41 WARN: Found transaction with intent but no commit txn.id=txn_1760108561_772702000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/11 00:02:41 SUMMARY: Transaction scan complete txn.scan.total=2 txn.scan.timestamp=2025-10-10T15:02:41Z
[TXN-SCAN] 2025/10/11 00:02:41   - Forward recovery needed txn.scan.intent_only_count=1 txn.scan.intent_only_ids=[txn_1760108561_772702000]
[TXN-SCAN] 2025/10/11 00:02:41   - Ready for cleanup txn.scan.committed_count=1 txn.scan.committed_ids=[txn_1760108561_710629000]
[TXN-SCAN] 2025/10/11 00:02:41 NOTE: Recovery disabled txn.scan.recovery_action=none txn.cleanup_policy=pending_step8
WARN: Transaction recovery timeout/cancelled txn.id=txn_1760108561_772702000 txn.retry.attempt=0

ERROR: Failed to recover transaction txn.recover.forward.failed=txn_1760108561_772702000 error=transaction recovery failed after 4 attempts: failed to parse manifest: invalid character 'c' looking for beginning of value

INFO: Cleaned up transaction txn.cleanup.success=txn_1760108561_710629000

INFO: Recovery complete txn.recover.forward.count=1 txn.recover.forward.success=0 txn.cleanup.success=1 txn.recover.duration_ms=1

--- PASS: TestE2ECrashRecoveryWithRetry (0.28s)
    --- PASS: TestE2ECrashRecoveryWithRetry/MultipleTransactionCrashRecovery (0.18s)
    --- PASS: TestE2ECrashRecoveryWithRetry/RecoveryWithTimeout (0.06s)
    --- PASS: TestE2ECrashRecoveryWithRetry/RecoveryWithCorruptedTransaction (0.04s)
=== RUN   TestRecoveryMetrics
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_metrics_test_979687030/.deespec/var/txn/txn_1760108561_814607000/stage/metrics_test1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_metrics_test_979687030/.deespec/var/txn/txn_1760108561_850859000/stage/metrics_test2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_metrics_test_979687030/.deespec/var/txn/txn_1760108561_850859000/stage/metrics_test2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_metrics_test_979687030/.deespec/metrics_test2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1760108561_850859000

[TXN-SCAN] 2025/10/11 00:02:41 WARN: Found transaction with intent but no commit txn.id=txn_1760108561_814607000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/11 00:02:41 INFO: Found completed transaction txn.id=txn_1760108561_850859000 txn.state=committed txn.action=cleanup_ready
[TXN-SCAN] 2025/10/11 00:02:41 SUMMARY: Transaction scan complete txn.scan.total=2 txn.scan.timestamp=2025-10-10T15:02:41Z
[TXN-SCAN] 2025/10/11 00:02:41   - Forward recovery needed txn.scan.intent_only_count=1 txn.scan.intent_only_ids=[txn_1760108561_814607000]
[TXN-SCAN] 2025/10/11 00:02:41   - Ready for cleanup txn.scan.committed_count=1 txn.scan.committed_ids=[txn_1760108561_850859000]
[TXN-SCAN] 2025/10/11 00:02:41 NOTE: Recovery disabled txn.scan.recovery_action=none txn.cleanup_policy=pending_step8
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_metrics_test_979687030/.deespec/var/txn/txn_1760108561_814607000/stage/metrics_test1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_metrics_test_979687030/.deespec/metrics_test1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1760108561_814607000

INFO: Recovered transaction txn.recover.forward.success=txn_1760108561_814607000

INFO: Cleaned up transaction txn.cleanup.success=txn_1760108561_850859000

INFO: Recovery complete txn.recover.forward.count=1 txn.recover.forward.success=1 txn.cleanup.success=1 txn.recover.duration_ms=22

--- PASS: TestRecoveryMetrics (0.12s)
=== RUN   TestRollbackBasic
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/rollback_test_4254172581/.deespec/var/txn/txn_1760108561_930747000/stage/test_file.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Rolling back transaction txn.register.rollback.count=txn_1760108561_930747000 reason=test rollback

INFO: Transaction rollback completed txn.rollback.success=txn_1760108561_930747000 undo_performed=false duration_ms=6ms

--- PASS: TestRollbackBasic (0.05s)
=== RUN   TestRollbackWithUndo
INFO: Rolling back transaction txn.register.rollback.count=txn_1760108561_977067000 reason=test undo rollback

INFO: Transaction rollback completed txn.rollback.success=txn_1760108561_977067000 undo_performed=true duration_ms=9ms

--- PASS: TestRollbackWithUndo (0.03s)
=== RUN   TestRollbackCommittedTransaction
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/rollback_committed_test_190955653/.deespec/var/txn/txn_1760108562_3574000/stage/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/rollback_committed_test_190955653/.deespec/var/txn/txn_1760108562_3574000/stage/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/rollback_committed_test_190955653/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1760108562_3574000

INFO: Rolling back transaction txn.register.rollback.count=txn_1760108562_3574000 reason=should fail

ERROR: Cannot rollback committed transaction txn.rollback.failed=txn_1760108562_3574000

--- PASS: TestRollbackCommittedTransaction (0.06s)
=== RUN   TestRollbackMetrics
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/rollback_metrics_test_146974795/.deespec/var/txn/txn_1760108562_63492000/stage/metrics_test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Rolling back transaction txn.register.rollback.count=txn_1760108562_63492000 reason=metrics test

INFO: Transaction rollback completed txn.rollback.success=txn_1760108562_63492000 undo_performed=false duration_ms=5ms

--- PASS: TestRollbackMetrics (0.04s)
=== RUN   TestNewScanner
--- PASS: TestNewScanner (0.00s)
=== RUN   TestScanNoDirectory
[TXN-SCAN] 2025/10/11 00:02:42 INFO: No transaction directory found txn.base_dir=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/TestScanNoDirectory2930368983/001/non-existent txn.state=clean txn.count=0
--- PASS: TestScanNoDirectory (0.00s)
=== RUN   TestScanWithTransactions
[TXN-SCAN] 2025/10/11 00:02:42 WARN: Found abandoned transaction txn.id=txn_abandoned txn.state=abandoned txn.markers=none
[TXN-SCAN] 2025/10/11 00:02:42 INFO: Found completed transaction txn.id=txn_committed txn.state=committed txn.action=cleanup_ready
[TXN-SCAN] 2025/10/11 00:02:42 WARN: Found incomplete transaction txn.id=txn_incomplete txn.state=incomplete txn.staging=partial
[TXN-SCAN] 2025/10/11 00:02:42 WARN: Found transaction with intent but no commit txn.id=txn_intent_only txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/11 00:02:42 SUMMARY: Transaction scan complete txn.scan.total=4 txn.scan.timestamp=2025-10-10T15:02:42Z
[TXN-SCAN] 2025/10/11 00:02:42   - Forward recovery needed txn.scan.intent_only_count=1 txn.scan.intent_only_ids=[txn_intent_only]
[TXN-SCAN] 2025/10/11 00:02:42   - Incomplete transactions txn.scan.incomplete_count=1 txn.scan.incomplete_ids=[txn_incomplete]
[TXN-SCAN] 2025/10/11 00:02:42   - Abandoned transactions txn.scan.abandoned_count=1 txn.scan.abandoned_ids=[txn_abandoned]
[TXN-SCAN] 2025/10/11 00:02:42   - Ready for cleanup txn.scan.committed_count=1 txn.scan.committed_ids=[txn_committed]
[TXN-SCAN] 2025/10/11 00:02:42 NOTE: Recovery disabled txn.scan.recovery_action=none txn.cleanup_policy=pending_step8
--- PASS: TestScanWithTransactions (0.01s)
=== RUN   TestCheckTransactionState
=== RUN   TestCheckTransactionState/committed
=== RUN   TestCheckTransactionState/intent_only
=== RUN   TestCheckTransactionState/incomplete_with_manifest
=== RUN   TestCheckTransactionState/incomplete_with_stage
=== RUN   TestCheckTransactionState/abandoned
--- PASS: TestCheckTransactionState (0.01s)
    --- PASS: TestCheckTransactionState/committed (0.00s)
    --- PASS: TestCheckTransactionState/intent_only (0.00s)
    --- PASS: TestCheckTransactionState/incomplete_with_manifest (0.00s)
    --- PASS: TestCheckTransactionState/incomplete_with_stage (0.00s)
    --- PASS: TestCheckTransactionState/abandoned (0.00s)
=== RUN   TestFormatTxnIDs
=== RUN   TestFormatTxnIDs/empty
=== RUN   TestFormatTxnIDs/single
=== RUN   TestFormatTxnIDs/three
=== RUN   TestFormatTxnIDs/many
--- PASS: TestFormatTxnIDs (0.00s)
    --- PASS: TestFormatTxnIDs/empty (0.00s)
    --- PASS: TestFormatTxnIDs/single (0.00s)
    --- PASS: TestFormatTxnIDs/three (0.00s)
    --- PASS: TestFormatTxnIDs/many (0.00s)
=== RUN   TestScanWithErrors
[TXN-SCAN] 2025/10/11 00:02:42 WARN: Found abandoned transaction txn.id=good_txn txn.state=abandoned txn.markers=none
[TXN-SCAN] 2025/10/11 00:02:42 SUMMARY: Transaction scan complete txn.scan.total=1 txn.scan.timestamp=2025-10-10T15:02:42Z
[TXN-SCAN] 2025/10/11 00:02:42   - Abandoned transactions txn.scan.abandoned_count=1 txn.scan.abandoned_ids=[good_txn]
[TXN-SCAN] 2025/10/11 00:02:42 NOTE: Recovery disabled txn.scan.recovery_action=none txn.cleanup_policy=pending_step8
--- PASS: TestScanWithErrors (0.00s)
=== RUN   TestTransactionLifecycle
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_test_2268915288/.deespec/var/txn/txn_1760108562_117988000/stage/test/file.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_test_2268915288/.deespec/var/txn/txn_1760108562_117988000/stage/test/file.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_test_2268915288/test/file.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

--- PASS: TestTransactionLifecycle (0.06s)
=== RUN   TestTransactionStateValidation
=== RUN   TestTransactionStateValidation/Cannot_commit_without_intent
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_validation_1373932025/.deespec/var/txn/txn_1760108562_183005000/stage/dummy.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

=== RUN   TestTransactionStateValidation/Cannot_stage_after_intent
=== RUN   TestTransactionStateValidation/Cannot_mark_intent_twice
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_validation_1373932025/.deespec/var/txn/txn_1760108562_183005000/stage/dummy.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_validation_1373932025/dummy.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1760108562_183005000

=== RUN   TestTransactionStateValidation/Idempotent_commit
INFO: Transaction already committed (no-op) txn.commit.idempotent=true txn.id=txn_1760108562_183005000

=== RUN   TestTransactionStateValidation/Cannot_cleanup_uncommitted_transaction
--- PASS: TestTransactionStateValidation (0.08s)
    --- PASS: TestTransactionStateValidation/Cannot_commit_without_intent (0.00s)
    --- PASS: TestTransactionStateValidation/Cannot_stage_after_intent (0.00s)
    --- PASS: TestTransactionStateValidation/Cannot_mark_intent_twice (0.00s)
    --- PASS: TestTransactionStateValidation/Idempotent_commit (0.00s)
    --- PASS: TestTransactionStateValidation/Cannot_cleanup_uncommitted_transaction (0.01s)
=== RUN   TestMultipleFileStaging
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_multi_2209731191/.deespec/var/txn/txn_1760108562_261678000/stage/dir1/file1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_multi_2209731191/.deespec/var/txn/txn_1760108562_261678000/stage/dir1/file2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_multi_2209731191/.deespec/var/txn/txn_1760108562_261678000/stage/dir2/file3.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_multi_2209731191/.deespec/var/txn/txn_1760108562_261678000/stage/dir1/file1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_multi_2209731191/.deespec/var/txn/txn_1760108562_261678000/stage/dir1/file2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_multi_2209731191/.deespec/var/txn/txn_1760108562_261678000/stage/dir2/file3.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_multi_2209731191/dir1/file1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_multi_2209731191/dir1/file2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_multi_2209731191/dir2/file3.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1760108562_261678000

--- PASS: TestMultipleFileStaging (0.11s)
=== RUN   TestManifestValidation
--- PASS: TestManifestValidation (0.02s)
=== RUN   TestIntentMarkerFormat
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_format_3743644126/.deespec/var/txn/txn_1760108562_386820000/stage/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

--- PASS: TestIntentMarkerFormat (0.04s)
=== RUN   TestCommitMarkerFormat
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_commit_1991190816/.deespec/var/txn/txn_1760108562_424615000/stage/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_commit_1991190816/.deespec/var/txn/txn_1760108562_424615000/stage/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_commit_1991190816/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1760108562_424615000

--- PASS: TestCommitMarkerFormat (0.06s)
=== RUN   TestTxnStatus
--- PASS: TestTxnStatus (0.00s)
=== RUN   TestStatusIsValid
=== RUN   TestStatusIsValid/Valid_PENDING
=== RUN   TestStatusIsValid/Valid_INTENT
=== RUN   TestStatusIsValid/Valid_COMMIT
=== RUN   TestStatusIsValid/Valid_ABORTED
=== RUN   TestStatusIsValid/Valid_FAILED
=== RUN   TestStatusIsValid/Invalid_empty
=== RUN   TestStatusIsValid/Invalid_unknown
=== RUN   TestStatusIsValid/Invalid_lowercase
--- PASS: TestStatusIsValid (0.00s)
    --- PASS: TestStatusIsValid/Valid_PENDING (0.00s)
    --- PASS: TestStatusIsValid/Valid_INTENT (0.00s)
    --- PASS: TestStatusIsValid/Valid_COMMIT (0.00s)
    --- PASS: TestStatusIsValid/Valid_ABORTED (0.00s)
    --- PASS: TestStatusIsValid/Valid_FAILED (0.00s)
    --- PASS: TestStatusIsValid/Invalid_empty (0.00s)
    --- PASS: TestStatusIsValid/Invalid_unknown (0.00s)
    --- PASS: TestStatusIsValid/Invalid_lowercase (0.00s)
=== RUN   TestStatusUnmarshalJSON
=== RUN   TestStatusUnmarshalJSON/Valid_PENDING
=== RUN   TestStatusUnmarshalJSON/Valid_INTENT
=== RUN   TestStatusUnmarshalJSON/Valid_COMMIT
=== RUN   TestStatusUnmarshalJSON/Valid_ABORTED
=== RUN   TestStatusUnmarshalJSON/Valid_FAILED
=== RUN   TestStatusUnmarshalJSON/Invalid_unknown
=== RUN   TestStatusUnmarshalJSON/Invalid_lowercase
=== RUN   TestStatusUnmarshalJSON/Invalid_format
=== RUN   TestStatusUnmarshalJSON/Invalid_empty
--- PASS: TestStatusUnmarshalJSON (0.00s)
    --- PASS: TestStatusUnmarshalJSON/Valid_PENDING (0.00s)
    --- PASS: TestStatusUnmarshalJSON/Valid_INTENT (0.00s)
    --- PASS: TestStatusUnmarshalJSON/Valid_COMMIT (0.00s)
    --- PASS: TestStatusUnmarshalJSON/Valid_ABORTED (0.00s)
    --- PASS: TestStatusUnmarshalJSON/Valid_FAILED (0.00s)
    --- PASS: TestStatusUnmarshalJSON/Invalid_unknown (0.00s)
    --- PASS: TestStatusUnmarshalJSON/Invalid_lowercase (0.00s)
    --- PASS: TestStatusUnmarshalJSON/Invalid_format (0.00s)
    --- PASS: TestStatusUnmarshalJSON/Invalid_empty (0.00s)
=== RUN   TestFileOperation
--- PASS: TestFileOperation (0.00s)
=== RUN   TestFileOperationValidate
=== RUN   TestFileOperationValidate/Valid_create_operation
=== RUN   TestFileOperationValidate/Valid_rename_operation
=== RUN   TestFileOperationValidate/Missing_type
=== RUN   TestFileOperationValidate/Invalid_type
=== RUN   TestFileOperationValidate/Missing_destination
=== RUN   TestFileOperationValidate/Rename_missing_source
--- PASS: TestFileOperationValidate (0.00s)
    --- PASS: TestFileOperationValidate/Valid_create_operation (0.00s)
    --- PASS: TestFileOperationValidate/Valid_rename_operation (0.00s)
    --- PASS: TestFileOperationValidate/Missing_type (0.00s)
    --- PASS: TestFileOperationValidate/Invalid_type (0.00s)
    --- PASS: TestFileOperationValidate/Missing_destination (0.00s)
    --- PASS: TestFileOperationValidate/Rename_missing_source (0.00s)
=== RUN   TestManifest
--- PASS: TestManifest (0.00s)
=== RUN   TestManifestValidate
=== RUN   TestManifestValidate/Valid_manifest
=== RUN   TestManifestValidate/Missing_ID
=== RUN   TestManifestValidate/No_file_operations
=== RUN   TestManifestValidate/Invalid_file_operation
=== RUN   TestManifestValidate/Zero_timestamp
--- PASS: TestManifestValidate (0.00s)
    --- PASS: TestManifestValidate/Valid_manifest (0.00s)
    --- PASS: TestManifestValidate/Missing_ID (0.00s)
    --- PASS: TestManifestValidate/No_file_operations (0.00s)
    --- PASS: TestManifestValidate/Invalid_file_operation (0.00s)
    --- PASS: TestManifestValidate/Zero_timestamp (0.00s)
=== RUN   TestIntent
--- PASS: TestIntent (0.00s)
=== RUN   TestCommit
--- PASS: TestCommit (0.00s)
=== RUN   TestTransaction
--- PASS: TestTransaction (0.00s)
=== RUN   TestRecoveryInfo
--- PASS: TestRecoveryInfo (0.00s)
=== RUN   TestTxnError
--- PASS: TestTxnError (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/infra/fs/txn	(cached)
=== RUN   TestWriteFileAtomic
=== RUN   TestWriteFileAtomic/Write_new_file_successfully
=== RUN   TestWriteFileAtomic/Overwrite_existing_file
=== RUN   TestWriteFileAtomic/Write_to_deeply_nested_directory
=== RUN   TestWriteFileAtomic/Write_empty_file
--- PASS: TestWriteFileAtomic (0.00s)
    --- PASS: TestWriteFileAtomic/Write_new_file_successfully (0.00s)
    --- PASS: TestWriteFileAtomic/Overwrite_existing_file (0.00s)
    --- PASS: TestWriteFileAtomic/Write_to_deeply_nested_directory (0.00s)
    --- PASS: TestWriteFileAtomic/Write_empty_file (0.00s)
=== RUN   TestWriteFileAtomic_RenameFailure
--- PASS: TestWriteFileAtomic_RenameFailure (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/infra/persistence/file	(cached)
# github.com/YoshitsuguKoike/deespec/internal/infrastructure/di.test
ld: warning: '/private/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/go-link-1264079114/000023.o' has malformed LC_DYSYMTAB, expected 98 undefined symbols to start at index 1626, found 95 undefined symbols starting at index 1626
=== RUN   TestContainer_LockServiceIntegration
--- PASS: TestContainer_LockServiceIntegration (0.26s)
=== RUN   TestContainer_LockServiceCleanup
--- PASS: TestContainer_LockServiceCleanup (1.51s)
=== RUN   TestContainer_DefaultConfiguration
--- PASS: TestContainer_DefaultConfiguration (0.01s)
=== RUN   TestContainer_CloseStopsLockService
--- PASS: TestContainer_CloseStopsLockService (0.01s)
=== RUN   TestContainer_MultipleLocksSimultaneously
--- PASS: TestContainer_MultipleLocksSimultaneously (0.01s)
=== RUN   TestContainer_LockConflict
--- PASS: TestContainer_LockConflict (0.00s)
=== RUN   TestContainer_WALModeEnabled
--- PASS: TestContainer_WALModeEnabled (0.00s)
=== RUN   TestContainer_ConcurrentAccess
--- PASS: TestContainer_ConcurrentAccess (0.01s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/infrastructure/di	(cached)
# github.com/YoshitsuguKoike/deespec/internal/infrastructure/persistence/sqlite.test
ld: warning: '/private/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/go-link-718616009/000023.o' has malformed LC_DYSYMTAB, expected 98 undefined symbols to start at index 1626, found 95 undefined symbols starting at index 1626
=== RUN   TestMigration_NewDatabase
--- PASS: TestMigration_NewDatabase (0.01s)
=== RUN   TestMigration_ExistingDatabase
    migration_test.go:224: Backfilled data: sequence=1, registered_at=2025-10-10T15:58:06Z
--- PASS: TestMigration_ExistingDatabase (0.00s)
=== RUN   TestRunLockRepository_AcquireAndRelease
--- PASS: TestRunLockRepository_AcquireAndRelease (0.00s)
=== RUN   TestRunLockRepository_Find
--- PASS: TestRunLockRepository_Find (0.00s)
=== RUN   TestRunLockRepository_Find_NotFound
--- PASS: TestRunLockRepository_Find_NotFound (0.00s)
=== RUN   TestRunLockRepository_UpdateHeartbeat
--- PASS: TestRunLockRepository_UpdateHeartbeat (1.01s)
=== RUN   TestRunLockRepository_Extend
--- PASS: TestRunLockRepository_Extend (0.00s)
=== RUN   TestRunLockRepository_CleanupExpired
--- PASS: TestRunLockRepository_CleanupExpired (2.01s)
=== RUN   TestRunLockRepository_List
--- PASS: TestRunLockRepository_List (0.00s)
=== RUN   TestRunLockRepository_AcquireExpiredLock
--- PASS: TestRunLockRepository_AcquireExpiredLock (2.00s)
=== RUN   TestStateLockRepository_AcquireAndRelease
--- PASS: TestStateLockRepository_AcquireAndRelease (0.00s)
=== RUN   TestStateLockRepository_Find
--- PASS: TestStateLockRepository_Find (0.00s)
=== RUN   TestStateLockRepository_Find_NotFound
--- PASS: TestStateLockRepository_Find_NotFound (0.00s)
=== RUN   TestStateLockRepository_UpdateHeartbeat
--- PASS: TestStateLockRepository_UpdateHeartbeat (1.01s)
=== RUN   TestStateLockRepository_Extend
--- PASS: TestStateLockRepository_Extend (0.01s)
=== RUN   TestStateLockRepository_CleanupExpired
--- PASS: TestStateLockRepository_CleanupExpired (2.01s)
=== RUN   TestStateLockRepository_List
--- PASS: TestStateLockRepository_List (0.00s)
=== RUN   TestStateLockRepository_AcquireExpiredLock
--- PASS: TestStateLockRepository_AcquireExpiredLock (2.01s)
=== RUN   TestStateLockRepository_ReadWriteLockTypes
--- PASS: TestStateLockRepository_ReadWriteLockTypes (0.01s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/infrastructure/persistence/sqlite	(cached)
?   	github.com/YoshitsuguKoike/deespec/internal/infrastructure/repository	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/infrastructure/repository/mock	[no test files]
=== RUN   TestExecuteRegisterTransaction
INFO: Checksum validation successful txn.checksum.validation.success=.deespec/var/txn/txn_1760108583_128959000/stage/specs/test-001_test_specification/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=.deespec/var/txn/txn_1760108583_128959000/stage/specs/test-001_test_specification/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=.deespec/var/txn/txn_1760108583_128959000/stage/specs/test-001_test_specification/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=.deespec/var/txn/txn_1760108583_128959000/stage/specs/test-001_test_specification/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=.deespec/specs/test-001_test_specification/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=.deespec/specs/test-001_test_specification/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

--- PASS: TestExecuteRegisterTransaction (0.11s)
=== RUN   TestExecuteRegisterTransactionFailure
--- PASS: TestExecuteRegisterTransactionFailure (0.00s)
=== RUN   TestExecuteRegisterTransactionEmptySpecPath
--- PASS: TestExecuteRegisterTransactionEmptySpecPath (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/infrastructure/transaction	(cached)
# github.com/YoshitsuguKoike/deespec/internal/interface/cli.test
ld: warning: '/private/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/go-link-2375114537/000023.o' has malformed LC_DYSYMTAB, expected 98 undefined symbols to start at index 1626, found 95 undefined symbols starting at index 1626
=== RUN   TestPackageLeaks
--- PASS: TestPackageLeaks (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/interface/cli	1.327s
=== RUN   TestLoadExternalPrompt_Success
=== RUN   TestLoadExternalPrompt_Success/WIP_status_loads_WIP.md
=== RUN   TestLoadExternalPrompt_Success/READY_status_loads_WIP.md
=== RUN   TestLoadExternalPrompt_Success/REVIEW_status_loads_REVIEW.md
=== RUN   TestLoadExternalPrompt_Success/REVIEW&WIP_status_loads_REVIEW_AND_WIP.md
--- PASS: TestLoadExternalPrompt_Success (0.00s)
    --- PASS: TestLoadExternalPrompt_Success/WIP_status_loads_WIP.md (0.00s)
    --- PASS: TestLoadExternalPrompt_Success/READY_status_loads_WIP.md (0.00s)
    --- PASS: TestLoadExternalPrompt_Success/REVIEW_status_loads_REVIEW.md (0.00s)
    --- PASS: TestLoadExternalPrompt_Success/REVIEW&WIP_status_loads_REVIEW_AND_WIP.md (0.00s)
=== RUN   TestLoadExternalPrompt_FileNotFound
=== RUN   TestLoadExternalPrompt_FileNotFound/Missing_file_for_WIP
=== RUN   TestLoadExternalPrompt_FileNotFound/Missing_file_for_REVIEW
=== RUN   TestLoadExternalPrompt_FileNotFound/Missing_file_for_REVIEW&WIP
--- PASS: TestLoadExternalPrompt_FileNotFound (0.00s)
    --- PASS: TestLoadExternalPrompt_FileNotFound/Missing_file_for_WIP (0.00s)
    --- PASS: TestLoadExternalPrompt_FileNotFound/Missing_file_for_REVIEW (0.00s)
    --- PASS: TestLoadExternalPrompt_FileNotFound/Missing_file_for_REVIEW&WIP (0.00s)
=== RUN   TestLoadExternalPrompt_InvalidStatus
--- PASS: TestLoadExternalPrompt_InvalidStatus (0.00s)
=== RUN   TestLoadExternalPrompt_FileDeleted
--- PASS: TestLoadExternalPrompt_FileDeleted (0.00s)
=== RUN   TestPlaceholderReplacement
--- PASS: TestPlaceholderReplacement (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/interface/cli/claude_prompt	(cached)
# github.com/YoshitsuguKoike/deespec/internal/interface/cli/clear.test
ld: warning: '/private/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/go-link-1464490983/000023.o' has malformed LC_DYSYMTAB, expected 98 undefined symbols to start at index 1626, found 95 undefined symbols starting at index 1626
=== RUN   TestClear
=== RUN   TestClear/successful_clear_without_WIP
[00:58:21.646] WARN: LoadState is deprecated - DB-based state management should be used instead
[00:58:21.647] INFO: Creating archive at: .deespec/archives/2025-10-11T00-58-21_01K77DGEYFEAHE30WCZ7XB71SC
[00:58:21.647] INFO: Archived journal.ndjson
[00:58:21.648] INFO: Moved 1 items from specs to archive
[00:58:21.648] WARN: SaveStateCAS is deprecated - DB-based state management should be used instead
[00:58:21.648] INFO: Reset state files
[00:58:21.648] INFO: Clear completed successfully. Archive created at: .deespec/archives/2025-10-11T00-58-21_01K77DGEYFEAHE30WCZ7XB71SC
[00:58:21.649] WARN: LoadState is deprecated - DB-based state management should be used instead
--- PASS: TestClear (0.01s)
    --- PASS: TestClear/successful_clear_without_WIP (0.00s)
=== RUN   TestClear_WithWIP
=== RUN   TestClear_WithWIP/WIP_without_lease_should_succeed
[00:58:21.652] WARN: LoadState is deprecated - DB-based state management should be used instead
[00:58:21.652] WARN: Clearing with WIP but no lease (WIP: TASK-001 may be stale)
[00:58:21.652] INFO: Creating archive at: .deespec/archives/2025-10-11T00-58-21_01K77DGEYM7CRKXT2NHVK5NJ5E
[00:58:21.652] INFO: No journal.ndjson to archive
[00:58:21.652] INFO: No specs directory to archive
[00:58:21.652] WARN: SaveStateCAS is deprecated - DB-based state management should be used instead
[00:58:21.653] INFO: Reset state files
[00:58:21.653] INFO: Clear completed successfully. Archive created at: .deespec/archives/2025-10-11T00-58-21_01K77DGEYM7CRKXT2NHVK5NJ5E
=== RUN   TestClear_WithWIP/WIP_with_active_lease_should_fail
[00:58:21.653] WARN: LoadState is deprecated - DB-based state management should be used instead
[00:58:21.654] WARN: LeaseExpired is deprecated - use lock service instead
--- PASS: TestClear_WithWIP (0.00s)
    --- PASS: TestClear_WithWIP/WIP_without_lease_should_succeed (0.00s)
    --- PASS: TestClear_WithWIP/WIP_with_active_lease_should_fail (0.00s)
=== RUN   TestClear_WithActiveLease
[00:58:21.656] WARN: LoadState is deprecated - DB-based state management should be used instead
[00:58:21.656] WARN: LeaseExpired is deprecated - use lock service instead
--- PASS: TestClear_WithActiveLease (0.00s)
=== RUN   TestClear_NoState
[00:58:21.658] WARN: LoadState is deprecated - DB-based state management should be used instead
[00:58:21.659] INFO: Creating archive at: .deespec/archives/2025-10-11T00-58-21_01K77DGEYTYN76T3YRVNY1WA0F
[00:58:21.660] INFO: No journal.ndjson to archive
[00:58:21.660] INFO: No specs directory to archive
[00:58:21.660] WARN: SaveStateCAS is deprecated - DB-based state management should be used instead
[00:58:21.661] INFO: Reset state files
[00:58:21.661] INFO: Clear completed successfully. Archive created at: .deespec/archives/2025-10-11T00-58-21_01K77DGEYTYN76T3YRVNY1WA0F
--- PASS: TestClear_NoState (0.01s)
=== RUN   TestArchiveJournal
[00:58:21.663] INFO: Archived journal.ndjson
--- PASS: TestArchiveJournal (0.00s)
=== RUN   TestArchiveJournal_NoFile
[00:58:21.666] INFO: No journal.ndjson to archive
--- PASS: TestArchiveJournal_NoFile (0.00s)
=== RUN   TestArchiveSpecs
[00:58:21.667] INFO: Moved 1 items from specs to archive
--- PASS: TestArchiveSpecs (0.00s)
=== RUN   TestArchiveSpecs_NoSpecs
[00:58:21.668] INFO: No specs directory to archive
--- PASS: TestArchiveSpecs_NoSpecs (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/interface/cli/clear	(cached)
# github.com/YoshitsuguKoike/deespec/internal/interface/cli/common.test
ld: warning: '/private/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/go-link-354806152/000023.o' has malformed LC_DYSYMTAB, expected 98 undefined symbols to start at index 1626, found 95 undefined symbols starting at index 1626
=== RUN   TestStateHelpers
--- PASS: TestStateHelpers (0.00s)
=== RUN   TestStateIO
[00:58:23.519] WARN: LoadState is deprecated - DB-based state management should be used instead
--- PASS: TestStateIO (0.00s)
=== RUN   TestLoggerFunctions
[00:58:23.519] INFO: Test info message arg
[00:58:23.519] WARN: Test warning message 42
[00:58:23.519] ERROR: Test error message
[00:58:23.519] DEBUG: Debug level message
[00:58:23.519] WARN: Warn level message
[00:58:23.519] ERROR: Error level message
--- PASS: TestLoggerFunctions (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/interface/cli/common	(cached)
# github.com/YoshitsuguKoike/deespec/internal/interface/cli/doctor.test
ld: warning: '/private/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/go-link-894454662/000023.o' has malformed LC_DYSYMTAB, expected 98 undefined symbols to start at index 1626, found 95 undefined symbols starting at index 1626
=== RUN   TestDoctorPromptValidation
=== RUN   TestDoctorPromptValidation/all_prompts_exist_and_readable
=== RUN   TestDoctorPromptValidation/prompt_file_missing
=== RUN   TestDoctorPromptValidation/prompt_path_is_directory
--- PASS: TestDoctorPromptValidation (0.01s)
    --- PASS: TestDoctorPromptValidation/all_prompts_exist_and_readable (0.00s)
    --- PASS: TestDoctorPromptValidation/prompt_file_missing (0.00s)
    --- PASS: TestDoctorPromptValidation/prompt_path_is_directory (0.00s)
=== RUN   TestDoctorPromptSizeAndEncoding
=== RUN   TestDoctorPromptSizeAndEncoding/prompt_within_size_limit
=== RUN   TestDoctorPromptSizeAndEncoding/prompt_exceeds_size_limit
=== RUN   TestDoctorPromptSizeAndEncoding/UTF-8_BOM_warning
=== RUN   TestDoctorPromptSizeAndEncoding/CRLF_warning
=== RUN   TestDoctorPromptSizeAndEncoding/invalid_UTF-8
--- PASS: TestDoctorPromptSizeAndEncoding (0.01s)
    --- PASS: TestDoctorPromptSizeAndEncoding/prompt_within_size_limit (0.00s)
    --- PASS: TestDoctorPromptSizeAndEncoding/prompt_exceeds_size_limit (0.00s)
    --- PASS: TestDoctorPromptSizeAndEncoding/UTF-8_BOM_warning (0.00s)
    --- PASS: TestDoctorPromptSizeAndEncoding/CRLF_warning (0.00s)
    --- PASS: TestDoctorPromptSizeAndEncoding/invalid_UTF-8 (0.00s)
=== RUN   TestDoctorPlaceholderValidation
=== RUN   TestDoctorPlaceholderValidation/valid_placeholders_only
=== RUN   TestDoctorPlaceholderValidation/empty_placeholder
=== RUN   TestDoctorPlaceholderValidation/unknown_placeholder
=== RUN   TestDoctorPlaceholderValidation/placeholder_in_fenced_code_block_(ignored)
=== RUN   TestDoctorPlaceholderValidation/placeholder_in_inline_code_(ignored)
=== RUN   TestDoctorPlaceholderValidation/escaped_placeholder_(ignored)
=== RUN   TestDoctorPlaceholderValidation/mustache_template_(warning)
=== RUN   TestDoctorPlaceholderValidation/invalid_identifier
=== RUN   TestDoctorPlaceholderValidation/whitespace_placeholder
--- PASS: TestDoctorPlaceholderValidation (0.00s)
    --- PASS: TestDoctorPlaceholderValidation/valid_placeholders_only (0.00s)
    --- PASS: TestDoctorPlaceholderValidation/empty_placeholder (0.00s)
    --- PASS: TestDoctorPlaceholderValidation/unknown_placeholder (0.00s)
    --- PASS: TestDoctorPlaceholderValidation/placeholder_in_fenced_code_block_(ignored) (0.00s)
    --- PASS: TestDoctorPlaceholderValidation/placeholder_in_inline_code_(ignored) (0.00s)
    --- PASS: TestDoctorPlaceholderValidation/escaped_placeholder_(ignored) (0.00s)
    --- PASS: TestDoctorPlaceholderValidation/mustache_template_(warning) (0.00s)
    --- PASS: TestDoctorPlaceholderValidation/invalid_identifier (0.00s)
    --- PASS: TestDoctorPlaceholderValidation/whitespace_placeholder (0.00s)
=== RUN   TestDoctorRemoveCodeBlocks
=== RUN   TestDoctorRemoveCodeBlocks/remove_fenced_code_block
=== RUN   TestDoctorRemoveCodeBlocks/remove_inline_code
=== RUN   TestDoctorRemoveCodeBlocks/remove_escaped_braces
=== RUN   TestDoctorRemoveCodeBlocks/mixed_content
--- PASS: TestDoctorRemoveCodeBlocks (0.00s)
    --- PASS: TestDoctorRemoveCodeBlocks/remove_fenced_code_block (0.00s)
    --- PASS: TestDoctorRemoveCodeBlocks/remove_inline_code (0.00s)
    --- PASS: TestDoctorRemoveCodeBlocks/remove_escaped_braces (0.00s)
    --- PASS: TestDoctorRemoveCodeBlocks/mixed_content (0.00s)
=== RUN   TestDoctorPromptValidationIntegration
    doctor_test.go:576: Integration test skipped - os.Exit() behavior is difficult to test in unit tests
--- SKIP: TestDoctorPromptValidationIntegration (0.00s)
=== RUN   TestValidatePlaceholders
=== RUN   TestValidatePlaceholders/No_placeholders
=== RUN   TestValidatePlaceholders/Valid_placeholders
=== RUN   TestValidatePlaceholders/Empty_template
--- PASS: TestValidatePlaceholders (0.00s)
    --- PASS: TestValidatePlaceholders/No_placeholders (0.00s)
    --- PASS: TestValidatePlaceholders/Valid_placeholders (0.00s)
    --- PASS: TestValidatePlaceholders/Empty_template (0.00s)
=== RUN   TestContains
=== RUN   TestContains/Substring_exists
=== RUN   TestContains/Substring_doesn't_exist
=== RUN   TestContains/Empty_string
=== RUN   TestContains/Empty_substring
=== RUN   TestContains/Case_sensitive
--- PASS: TestContains (0.00s)
    --- PASS: TestContains/Substring_exists (0.00s)
    --- PASS: TestContains/Substring_doesn't_exist (0.00s)
    --- PASS: TestContains/Empty_string (0.00s)
    --- PASS: TestContains/Empty_substring (0.00s)
    --- PASS: TestContains/Case_sensitive (0.00s)
=== RUN   TestContainsHelper
=== RUN   TestContainsHelper/Substring_exists
=== RUN   TestContainsHelper/Substring_doesn't_exist
=== RUN   TestContainsHelper/Empty_substring
=== RUN   TestContainsHelper/Empty_string
=== RUN   TestContainsHelper/Full_match
--- PASS: TestContainsHelper (0.00s)
    --- PASS: TestContainsHelper/Substring_exists (0.00s)
    --- PASS: TestContainsHelper/Substring_doesn't_exist (0.00s)
    --- PASS: TestContainsHelper/Empty_substring (0.00s)
    --- PASS: TestContainsHelper/Empty_string (0.00s)
    --- PASS: TestContainsHelper/Full_match (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/interface/cli/doctor	(cached)
?   	github.com/YoshitsuguKoike/deespec/internal/interface/cli/health	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/interface/cli/init	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/interface/cli/journal	[no test files]
# github.com/YoshitsuguKoike/deespec/internal/interface/cli/label.test
ld: warning: '/private/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/go-link-4211631328/000023.o' has malformed LC_DYSYMTAB, expected 98 undefined symbols to start at index 1626, found 95 undefined symbols starting at index 1626
=== RUN   TestLabelE2E
=== RUN   TestLabelE2E/Register
=== RUN   TestLabelE2E/FindByName
=== RUN   TestLabelE2E/ListActive
=== RUN   TestLabelE2E/Update
=== RUN   TestLabelE2E/ValidateIntegrity
=== RUN   TestLabelE2E/Deactivate
=== RUN   TestLabelE2E/Delete
--- PASS: TestLabelE2E (0.01s)
    --- PASS: TestLabelE2E/Register (0.00s)
    --- PASS: TestLabelE2E/FindByName (0.00s)
    --- PASS: TestLabelE2E/ListActive (0.00s)
    --- PASS: TestLabelE2E/Update (0.00s)
    --- PASS: TestLabelE2E/ValidateIntegrity (0.00s)
    --- PASS: TestLabelE2E/Deactivate (0.00s)
    --- PASS: TestLabelE2E/Delete (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/interface/cli/label	(cached)
?   	github.com/YoshitsuguKoike/deespec/internal/interface/cli/lock_cmd	[no test files]
# github.com/YoshitsuguKoike/deespec/internal/interface/cli/register.test
ld: warning: '/private/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/go-link-3977683375/000023.o' has malformed LC_DYSYMTAB, expected 98 undefined symbols to start at index 1626, found 95 undefined symbols starting at index 1626
=== RUN   TestDryRun_NoSideEffects
--- PASS: TestDryRun_NoSideEffects (0.01s)
=== RUN   TestDryRun_Precedence
--- PASS: TestDryRun_Precedence (0.00s)
=== RUN   TestDryRun_CollisionErrorMode_Fails
    dry_run_test.go:138: Created collision path: .deespec/specs/sbi/TEST-COLL-001_test
    dry_run_test.go:184: Dry-run resolution:
    dry_run_test.go:185:   BaseDir: .deespec/specs/sbi
    dry_run_test.go:186:   Slug: test
    dry_run_test.go:187:   SpecPath: .deespec/specs/sbi/TEST-COLL-001_test
    dry_run_test.go:188:   FinalPath: .deespec/specs/sbi/TEST-COLL-001_test
    dry_run_test.go:189:   Collision detected: true
--- PASS: TestDryRun_CollisionErrorMode_Fails (0.00s)
=== RUN   TestDryRun_CollisionSuffixMode_Succeeds
--- PASS: TestDryRun_CollisionSuffixMode_Succeeds (0.00s)
=== RUN   TestDryRun_PathSafety
--- PASS: TestDryRun_PathSafety (0.00s)
=== RUN   TestDryRun_JournalPreviewSchema
INFO: no policy file found, using defaults
--- PASS: TestDryRun_JournalPreviewSchema (0.00s)
=== RUN   TestDryRun_OutputSchemaStable
INFO: no policy file found, using defaults
INFO: no policy file found, using defaults
INFO: no policy file found, using defaults
--- PASS: TestDryRun_OutputSchemaStable (0.00s)
=== RUN   TestDryRun_StderrLevel
--- PASS: TestDryRun_StderrLevel (0.00s)
=== RUN   TestPrintEffectiveConfig_NoPolicy_Defaults
--- PASS: TestPrintEffectiveConfig_NoPolicy_Defaults (0.00s)
=== RUN   TestPrintEffectiveConfig_PolicyAndCLI_Precedence
--- PASS: TestPrintEffectiveConfig_PolicyAndCLI_Precedence (0.00s)
=== RUN   TestPrintEffectiveConfig_FormatCompact
--- PASS: TestPrintEffectiveConfig_FormatCompact (0.00s)
=== RUN   TestPrintEffectiveConfig_InvalidPolicy
--- PASS: TestPrintEffectiveConfig_InvalidPolicy (0.00s)
=== RUN   TestEffectiveConfig_ContainsPathInputs
--- PASS: TestEffectiveConfig_ContainsPathInputs (0.00s)
=== RUN   TestEffectiveConfig_StableKeyOrder
--- PASS: TestEffectiveConfig_StableKeyOrder (0.00s)
=== RUN   TestEffectiveConfig_MetadataFields
--- PASS: TestEffectiveConfig_MetadataFields (0.00s)
=== RUN   TestRunPrintEffectiveConfig_Integration
--- PASS: TestRunPrintEffectiveConfig_Integration (0.00s)
=== RUN   TestSlugifyTitle
=== RUN   TestSlugifyTitle/simple
=== RUN   TestSlugifyTitle/with_numbers
=== RUN   TestSlugifyTitle/with_hyphens
=== RUN   TestSlugifyTitle/japanese
=== RUN   TestSlugifyTitle/mixed
=== RUN   TestSlugifyTitle/full-width
=== RUN   TestSlugifyTitle/special_chars
=== RUN   TestSlugifyTitle/spaces
=== RUN   TestSlugifyTitle/leading/trailing
=== RUN   TestSlugifyTitle/empty
=== RUN   TestSlugifyTitle/all_special
=== RUN   TestSlugifyTitle/dots_and_spaces
=== RUN   TestSlugifyTitle/con
=== RUN   TestSlugifyTitle/prn
=== RUN   TestSlugifyTitle/aux
=== RUN   TestSlugifyTitle/com1
=== RUN   TestSlugifyTitle/lpt9
=== RUN   TestSlugifyTitle/long_title
=== RUN   TestSlugifyTitle/long_with_dash
--- PASS: TestSlugifyTitle (0.01s)
    --- PASS: TestSlugifyTitle/simple (0.00s)
    --- PASS: TestSlugifyTitle/with_numbers (0.00s)
    --- PASS: TestSlugifyTitle/with_hyphens (0.00s)
    --- PASS: TestSlugifyTitle/japanese (0.00s)
    --- PASS: TestSlugifyTitle/mixed (0.00s)
    --- PASS: TestSlugifyTitle/full-width (0.00s)
    --- PASS: TestSlugifyTitle/special_chars (0.00s)
    --- PASS: TestSlugifyTitle/spaces (0.00s)
    --- PASS: TestSlugifyTitle/leading/trailing (0.00s)
    --- PASS: TestSlugifyTitle/empty (0.00s)
    --- PASS: TestSlugifyTitle/all_special (0.00s)
    --- PASS: TestSlugifyTitle/dots_and_spaces (0.00s)
    --- PASS: TestSlugifyTitle/con (0.00s)
    --- PASS: TestSlugifyTitle/prn (0.00s)
    --- PASS: TestSlugifyTitle/aux (0.00s)
    --- PASS: TestSlugifyTitle/com1 (0.00s)
    --- PASS: TestSlugifyTitle/lpt9 (0.00s)
    --- PASS: TestSlugifyTitle/long_title (0.00s)
    --- PASS: TestSlugifyTitle/long_with_dash (0.00s)
=== RUN   TestIsWindowsReserved
=== RUN   TestIsWindowsReserved/con_lower
=== RUN   TestIsWindowsReserved/CON_upper
=== RUN   TestIsWindowsReserved/CoN_mixed
=== RUN   TestIsWindowsReserved/prn
=== RUN   TestIsWindowsReserved/aux
=== RUN   TestIsWindowsReserved/nul
=== RUN   TestIsWindowsReserved/com1
=== RUN   TestIsWindowsReserved/com9
=== RUN   TestIsWindowsReserved/lpt1
=== RUN   TestIsWindowsReserved/lpt9
=== RUN   TestIsWindowsReserved/not_reserved
=== RUN   TestIsWindowsReserved/not_reserved_com
=== RUN   TestIsWindowsReserved/not_reserved_com10
--- PASS: TestIsWindowsReserved (0.00s)
    --- PASS: TestIsWindowsReserved/con_lower (0.00s)
    --- PASS: TestIsWindowsReserved/CON_upper (0.00s)
    --- PASS: TestIsWindowsReserved/CoN_mixed (0.00s)
    --- PASS: TestIsWindowsReserved/prn (0.00s)
    --- PASS: TestIsWindowsReserved/aux (0.00s)
    --- PASS: TestIsWindowsReserved/nul (0.00s)
    --- PASS: TestIsWindowsReserved/com1 (0.00s)
    --- PASS: TestIsWindowsReserved/com9 (0.00s)
    --- PASS: TestIsWindowsReserved/lpt1 (0.00s)
    --- PASS: TestIsWindowsReserved/lpt9 (0.00s)
    --- PASS: TestIsWindowsReserved/not_reserved (0.00s)
    --- PASS: TestIsWindowsReserved/not_reserved_com (0.00s)
    --- PASS: TestIsWindowsReserved/not_reserved_com10 (0.00s)
=== RUN   TestBuildSafeSpecPath
=== RUN   TestBuildSafeSpecPath/normal_path
=== RUN   TestBuildSafeSpecPath/traversal_attempt_with_..
=== RUN   TestBuildSafeSpecPath/windows_reserved_name
=== RUN   TestBuildSafeSpecPath/very_long_path
=== RUN   TestBuildSafeSpecPath/path_with_slashes_removed
--- PASS: TestBuildSafeSpecPath (0.00s)
    --- PASS: TestBuildSafeSpecPath/normal_path (0.00s)
    --- PASS: TestBuildSafeSpecPath/traversal_attempt_with_.. (0.00s)
    --- PASS: TestBuildSafeSpecPath/windows_reserved_name (0.00s)
    --- PASS: TestBuildSafeSpecPath/very_long_path (0.00s)
    --- PASS: TestBuildSafeSpecPath/path_with_slashes_removed (0.00s)
=== RUN   TestIsPathSafe
=== RUN   TestIsPathSafe/path_within_base
=== RUN   TestIsPathSafe/path_equals_base
=== RUN   TestIsPathSafe/path_outside_base
=== RUN   TestIsPathSafe/path_with_..
--- PASS: TestIsPathSafe (0.00s)
    --- PASS: TestIsPathSafe/path_within_base (0.00s)
    --- PASS: TestIsPathSafe/path_equals_base (0.00s)
    --- PASS: TestIsPathSafe/path_outside_base (0.00s)
    --- PASS: TestIsPathSafe/path_with_.. (0.00s)
=== RUN   TestCheckForSymlinks
=== RUN   TestCheckForSymlinks/path_without_symlinks
=== RUN   TestCheckForSymlinks/path_with_symlink
=== RUN   TestCheckForSymlinks/non-existent_path
--- PASS: TestCheckForSymlinks (0.00s)
    --- PASS: TestCheckForSymlinks/path_without_symlinks (0.00s)
    --- PASS: TestCheckForSymlinks/path_with_symlink (0.00s)
    --- PASS: TestCheckForSymlinks/non-existent_path (0.00s)
=== RUN   TestResolveCollision
=== RUN   TestResolveCollision/error_mode_-_no_collision
=== RUN   TestResolveCollision/error_mode_-_with_collision
=== RUN   TestResolveCollision/suffix_mode_-_no_collision
=== RUN   TestResolveCollision/suffix_mode_-_with_collision
=== RUN   TestResolveCollision/replace_mode_-_no_collision
=== RUN   TestResolveCollision/replace_mode_-_with_collision
=== RUN   TestResolveCollision/invalid_mode
--- PASS: TestResolveCollision (0.00s)
    --- PASS: TestResolveCollision/error_mode_-_no_collision (0.00s)
    --- PASS: TestResolveCollision/error_mode_-_with_collision (0.00s)
    --- PASS: TestResolveCollision/suffix_mode_-_no_collision (0.00s)
    --- PASS: TestResolveCollision/suffix_mode_-_with_collision (0.00s)
    --- PASS: TestResolveCollision/replace_mode_-_no_collision (0.00s)
    --- PASS: TestResolveCollision/replace_mode_-_with_collision (0.00s)
    --- PASS: TestResolveCollision/invalid_mode (0.00s)
=== RUN   TestCollisionSuffixExhaustion
--- PASS: TestCollisionSuffixExhaustion (0.00s)
=== RUN   TestRegisterCommand
=== RUN   TestRegisterCommand/valid_YAML_input_with_new_ID_format
=== RUN   TestRegisterCommand/valid_JSON_input
=== RUN   TestRegisterCommand/new_ID_format_-_uppercase_letters_and_numbers
=== RUN   TestRegisterCommand/invalid_ID_-_lowercase_letters
=== RUN   TestRegisterCommand/invalid_ID_-_special_characters
=== RUN   TestRegisterCommand/ID_too_long
=== RUN   TestRegisterCommand/empty_title
=== RUN   TestRegisterCommand/title_too_long
=== RUN   TestRegisterCommand/labels_with_valid_format
=== RUN   TestRegisterCommand/invalid_label_format_-_uppercase
=== RUN   TestRegisterCommand/duplicate_labels_-_warning
=== RUN   TestRegisterCommand/too_many_labels_-_warning
=== RUN   TestRegisterCommand/unknown_fields
=== RUN   TestRegisterCommand/labels_are_optional
--- PASS: TestRegisterCommand (0.76s)
    --- PASS: TestRegisterCommand/valid_YAML_input_with_new_ID_format (0.09s)
    --- PASS: TestRegisterCommand/valid_JSON_input (0.09s)
    --- PASS: TestRegisterCommand/new_ID_format_-_uppercase_letters_and_numbers (0.12s)
    --- PASS: TestRegisterCommand/invalid_ID_-_lowercase_letters (0.01s)
    --- PASS: TestRegisterCommand/invalid_ID_-_special_characters (0.01s)
    --- PASS: TestRegisterCommand/ID_too_long (0.01s)
    --- PASS: TestRegisterCommand/empty_title (0.01s)
    --- PASS: TestRegisterCommand/title_too_long (0.01s)
    --- PASS: TestRegisterCommand/labels_with_valid_format (0.10s)
    --- PASS: TestRegisterCommand/invalid_label_format_-_uppercase (0.01s)
    --- PASS: TestRegisterCommand/duplicate_labels_-_warning (0.09s)
    --- PASS: TestRegisterCommand/too_many_labels_-_warning (0.10s)
    --- PASS: TestRegisterCommand/unknown_fields (0.01s)
    --- PASS: TestRegisterCommand/labels_are_optional (0.10s)
=== RUN   TestValidationFunctions
=== RUN   TestValidationFunctions/validateID
=== RUN   TestValidationFunctions/validateTitle
=== RUN   TestValidationFunctions/validateLabels
--- PASS: TestValidationFunctions (0.00s)
    --- PASS: TestValidationFunctions/validateID (0.00s)
    --- PASS: TestValidationFunctions/validateTitle (0.00s)
    --- PASS: TestValidationFunctions/validateLabels (0.00s)
=== RUN   TestInputSizeLimit
ERROR: failed to read input: input size exceeds limit of 65536 bytes
--- PASS: TestInputSizeLimit (0.01s)
=== RUN   TestBuildSpecPath
=== RUN   TestBuildSpecPath/Simple_Title
=== RUN   TestBuildSpecPath/Title_With__Multiple___Spaces
=== RUN   TestBuildSpecPath/Title-With-Hyphens
=== RUN   TestBuildSpecPath/Title_With_Underscores
=== RUN   TestBuildSpecPath/Title123With456Numbers
--- PASS: TestBuildSpecPath (0.01s)
    --- PASS: TestBuildSpecPath/Simple_Title (0.00s)
    --- PASS: TestBuildSpecPath/Title_With__Multiple___Spaces (0.00s)
    --- PASS: TestBuildSpecPath/Title-With-Hyphens (0.00s)
    --- PASS: TestBuildSpecPath/Title_With_Underscores (0.00s)
    --- PASS: TestBuildSpecPath/Title123With456Numbers (0.00s)
=== RUN   TestRegisterValidationBehavior
=== RUN   TestRegisterValidationBehavior/Fatal_validation_error_-_both_paths
=== RUN   TestRegisterValidationBehavior/Fatal_validation_error_-_TX_path
=== RUN   TestRegisterValidationBehavior/Duplicate_label_warning_-_non-TX
=== RUN   TestRegisterValidationBehavior/Duplicate_label_warning_-_TX
=== RUN   TestRegisterValidationBehavior/Valid_spec_-_non-TX
=== RUN   TestRegisterValidationBehavior/Valid_spec_-_TX
--- PASS: TestRegisterValidationBehavior (0.09s)
    --- PASS: TestRegisterValidationBehavior/Fatal_validation_error_-_both_paths (0.01s)
    --- PASS: TestRegisterValidationBehavior/Fatal_validation_error_-_TX_path (0.05s)
    --- PASS: TestRegisterValidationBehavior/Duplicate_label_warning_-_non-TX (0.01s)
    --- PASS: TestRegisterValidationBehavior/Duplicate_label_warning_-_TX (0.01s)
    --- PASS: TestRegisterValidationBehavior/Valid_spec_-_non-TX (0.00s)
    --- PASS: TestRegisterValidationBehavior/Valid_spec_-_TX (0.01s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/interface/cli/register	(cached)
# github.com/YoshitsuguKoike/deespec/internal/interface/cli/run.test
ld: warning: '/private/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/go-link-3422786977/000023.o' has malformed LC_DYSYMTAB, expected 98 undefined symbols to start at index 1626, found 95 undefined symbols starting at index 1626
=== RUN   TestParseInterval
=== RUN   TestParseInterval/Empty_string_uses_default
=== RUN   TestParseInterval/Valid_duration
=== RUN   TestParseInterval/Below_minimum_uses_minimum
[00:58:37.636] WARN: Interval 500ms too small, using minimum 1s
=== RUN   TestParseInterval/Above_maximum_uses_maximum
[00:58:37.637] WARN: Interval 1h0m0s too large, using maximum 10m0s
=== RUN   TestParseInterval/Invalid_format
--- PASS: TestParseInterval (0.00s)
    --- PASS: TestParseInterval/Empty_string_uses_default (0.00s)
    --- PASS: TestParseInterval/Valid_duration (0.00s)
    --- PASS: TestParseInterval/Below_minimum_uses_minimum (0.00s)
    --- PASS: TestParseInterval/Above_maximum_uses_maximum (0.00s)
    --- PASS: TestParseInterval/Invalid_format (0.00s)
=== RUN   TestSetupSignalHandler
--- PASS: TestSetupSignalHandler (0.05s)
=== RUN   TestSummarizeText
=== RUN   TestSummarizeText/Short_text
=== RUN   TestSummarizeText/Text_needs_truncation
=== RUN   TestSummarizeText/Empty_text
=== RUN   TestSummarizeText/Exact_line_count
--- PASS: TestSummarizeText (0.00s)
    --- PASS: TestSummarizeText/Short_text (0.00s)
    --- PASS: TestSummarizeText/Text_needs_truncation (0.00s)
    --- PASS: TestSummarizeText/Empty_text (0.00s)
    --- PASS: TestSummarizeText/Exact_line_count (0.00s)
=== RUN   TestBuildImplementPrompt
[00:58:37.690] INFO: Using default prompt (external prompt not found: unknown status: )
--- PASS: TestBuildImplementPrompt (0.00s)
=== RUN   TestBuildReviewPrompt
[00:58:37.691] INFO: Using default prompt (external prompt not found: unknown status: )
--- PASS: TestBuildReviewPrompt (0.00s)
=== RUN   TestGetCurrentWorkDir
--- PASS: TestGetCurrentWorkDir (0.00s)
=== RUN   TestLogClaudeInteraction
[00:58:37.692] INFO: ┌─ Claude Code Execution ─────────────────────────────────
[00:58:37.693] INFO: │ Start: 00:58:37.692
[00:58:37.693] INFO: │ Prompt: 11 chars, 1 lines
[00:58:37.693] INFO: │ Type: Test prompt
[00:58:37.693] INFO: │ End: 00:58:39.692 (Duration: 2.0s)
[00:58:37.693] INFO: │ Response: 11 chars, 1 lines
[00:58:37.693] WARN: │ Warning: Unusually short response (11 chars)
[00:58:37.693] WARN: │ Full content: Test result
[00:58:37.693] INFO: ┌─ AI Response Content ─────────────────────────────────────
[00:58:37.693] INFO: │    1: Test result
[00:58:37.693] INFO: └──────────────────────────────────────────────────────────
[00:58:37.693] INFO: └──────────────────────────────────────────────────────────
[00:58:37.693] INFO: ┌─ Claude Code Execution ─────────────────────────────────
[00:58:37.693] INFO: │ Start: 00:58:37.692
[00:58:37.693] INFO: │ Prompt: 11 chars, 1 lines
[00:58:37.693] INFO: │ Type: Test prompt
[00:58:37.693] INFO: │ End: 00:58:38.692 (Duration: 1.0s)
[00:58:37.693] INFO: │ Status: ERROR - test error
[00:58:37.693] INFO: └──────────────────────────────────────────────────────────
--- PASS: TestLogClaudeInteraction (0.00s)
=== RUN   TestGetTaskDescription
=== RUN   TestGetTaskDescription/With_WIP_task
=== RUN   TestGetTaskDescription/Empty_WIP
--- PASS: TestGetTaskDescription (0.00s)
    --- PASS: TestGetTaskDescription/With_WIP_task (0.00s)
    --- PASS: TestGetTaskDescription/Empty_WIP (0.00s)
=== RUN   TestDetermineStep
=== RUN   TestDetermineStep/WIP_status
=== RUN   TestDetermineStep/REVIEW_status
=== RUN   TestDetermineStep/REVIEW&WIP_status
=== RUN   TestDetermineStep/DONE_status
=== RUN   TestDetermineStep/READY_status
=== RUN   TestDetermineStep/Empty_status
--- PASS: TestDetermineStep (0.00s)
    --- PASS: TestDetermineStep/WIP_status (0.00s)
    --- PASS: TestDetermineStep/REVIEW_status (0.00s)
    --- PASS: TestDetermineStep/REVIEW&WIP_status (0.00s)
    --- PASS: TestDetermineStep/DONE_status (0.00s)
    --- PASS: TestDetermineStep/READY_status (0.00s)
    --- PASS: TestDetermineStep/Empty_status (0.00s)
=== RUN   TestBuildPromptByStatus
=== RUN   TestBuildPromptByStatus/WIP_status
[00:58:37.695] INFO: Using default prompt (external prompt not found: open .deespec/prompts/WIP.md: no such file or directory)
=== RUN   TestBuildPromptByStatus/REVIEW_status
[00:58:37.696] INFO: Using default prompt (external prompt not found: open .deespec/prompts/REVIEW.md: no such file or directory)
=== RUN   TestBuildPromptByStatus/REVIEW&WIP_status
[00:58:37.696] INFO: Using default prompt (external prompt not found: open .deespec/prompts/REVIEW_AND_WIP.md: no such file or directory)
--- PASS: TestBuildPromptByStatus (0.00s)
    --- PASS: TestBuildPromptByStatus/WIP_status (0.00s)
    --- PASS: TestBuildPromptByStatus/REVIEW_status (0.00s)
    --- PASS: TestBuildPromptByStatus/REVIEW&WIP_status (0.00s)
=== RUN   TestGetCurrentWorkingDirectory
--- PASS: TestGetCurrentWorkingDirectory (0.00s)
=== RUN   TestParseDecision
=== RUN   TestParseDecision/Simple_SUCCEEDED
[00:58:37.697] INFO: Decision extracted: SUCCEEDED (pattern: (?mi)DECISION:\s*(SUCCEEDED|NEEDS_CHANGES|FAILED))
=== RUN   TestParseDecision/Simple_FAILED
[00:58:37.697] INFO: Decision extracted: FAILED (pattern: (?mi)DECISION:\s*(SUCCEEDED|NEEDS_CHANGES|FAILED))
=== RUN   TestParseDecision/Simple_NEEDS_CHANGES
[00:58:37.697] INFO: Decision extracted: NEEDS_CHANGES (pattern: (?mi)DECISION:\s*(SUCCEEDED|NEEDS_CHANGES|FAILED))
=== RUN   TestParseDecision/FAILED_with_leading_asterisks
[00:58:37.698] INFO: Decision extracted: FAILED (pattern: (?mi)DECISION:\s*(SUCCEEDED|NEEDS_CHANGES|FAILED))
=== RUN   TestParseDecision/SUCCEEDED_with_trailing_asterisks
[00:58:37.698] INFO: Decision extracted: SUCCEEDED (pattern: (?mi)DECISION:\s*(SUCCEEDED|NEEDS_CHANGES|FAILED))
=== RUN   TestParseDecision/Mixed_case_decision
[00:58:37.699] INFO: Decision extracted: SUCCEEDED (pattern: (?mi)DECISION:\s*(SUCCEEDED|NEEDS_CHANGES|FAILED))
=== RUN   TestParseDecision/Decision_with_extra_whitespace
[00:58:37.699] INFO: Decision extracted: FAILED (pattern: (?mi)DECISION:\s*(SUCCEEDED|NEEDS_CHANGES|FAILED))
=== RUN   TestParseDecision/No_decision_found_-_default_to_NEEDS_CHANGES
[00:58:37.700] INFO: No valid DECISION found in response, defaulting to NEEDS_CHANGES
=== RUN   TestParseDecision/Invalid_decision_value_-_default_to_NEEDS_CHANGES
[00:58:37.701] INFO: No valid DECISION found in response, defaulting to NEEDS_CHANGES
=== RUN   TestParseDecision/Decision_in_middle_of_text
[00:58:37.702] INFO: Decision extracted: SUCCEEDED (pattern: (?mi)DECISION:\s*(SUCCEEDED|NEEDS_CHANGES|FAILED))
=== RUN   TestParseDecision/Multiple_decisions_-_takes_first
[00:58:37.702] INFO: Decision extracted: FAILED (pattern: (?mi)DECISION:\s*(SUCCEEDED|NEEDS_CHANGES|FAILED))
--- PASS: TestParseDecision (0.01s)
    --- PASS: TestParseDecision/Simple_SUCCEEDED (0.00s)
    --- PASS: TestParseDecision/Simple_FAILED (0.00s)
    --- PASS: TestParseDecision/Simple_NEEDS_CHANGES (0.00s)
    --- PASS: TestParseDecision/FAILED_with_leading_asterisks (0.00s)
    --- PASS: TestParseDecision/SUCCEEDED_with_trailing_asterisks (0.00s)
    --- PASS: TestParseDecision/Mixed_case_decision (0.00s)
    --- PASS: TestParseDecision/Decision_with_extra_whitespace (0.00s)
    --- PASS: TestParseDecision/No_decision_found_-_default_to_NEEDS_CHANGES (0.00s)
    --- PASS: TestParseDecision/Invalid_decision_value_-_default_to_NEEDS_CHANGES (0.00s)
    --- PASS: TestParseDecision/Decision_in_middle_of_text (0.00s)
    --- PASS: TestParseDecision/Multiple_decisions_-_takes_first (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/interface/cli/run	(cached)
