# PBIç™»éŒ²æ–¹æ³•ã®è¨­è¨ˆï¼šãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ vs ã‚³ãƒãƒ³ãƒ‰å¼•æ•°

> ã“ã®æ–‡æ›¸ã¯ `docs/pbi_how_to_work.md` ã‹ã‚‰åˆ†é›¢ã•ã‚Œã¾ã—ãŸã€‚
> PBIç™»éŒ²æ–¹æ³•ã®è¨­è¨ˆã«ã¤ã„ã¦è©³ç´°ã«è§£èª¬ã—ã¦ã„ã¾ã™ã€‚

---

## ç›®æ¬¡

1. [è¨­è¨ˆã«ãŠã‘ã‚‹æ ¹æœ¬çš„ãªå•ã„](#1-è¨­è¨ˆã«ãŠã‘ã‚‹æ ¹æœ¬çš„ãªå•ã„)
2. [çµè«–ï¼šãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ãŒä¸»ã€ã‚³ãƒãƒ³ãƒ‰å¼•æ•°ã¯è£œåŠ©](#2-çµè«–ãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ãŒä¸»ã‚³ãƒãƒ³ãƒ‰å¼•æ•°ã¯è£œåŠ©)
3. [å®Ÿç”¨æ€§ã®è¦³ç‚¹](#3-å®Ÿç”¨æ€§ã®è¦³ç‚¹)
4. [æ—¢å­˜ãƒ„ãƒ¼ãƒ«ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹](#4-æ—¢å­˜ãƒ„ãƒ¼ãƒ«ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹)
5. [deespecã®å“²å­¦ã¨ã®æ•´åˆæ€§](#5-deespecã®å“²å­¦ã¨ã®æ•´åˆæ€§)
6. [æ¨å¥¨è¨­è¨ˆï¼šãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ](#6-æ¨å¥¨è¨­è¨ˆãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ)
7. [å®Ÿè£…å„ªå…ˆåº¦](#7-å®Ÿè£…å„ªå…ˆåº¦)
8. [ãƒ•ã‚¡ã‚¤ãƒ«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆè©³ç´°](#8-ãƒ•ã‚¡ã‚¤ãƒ«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆè©³ç´°)
9. [ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°ï¼ˆç°¡æ˜“ç‰ˆï¼‰ã®ä»•æ§˜](#9-ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°ç°¡æ˜“ç‰ˆã®ä»•æ§˜)
10. [ã¾ã¨ã‚ï¼šè¨­è¨ˆã®åŸå‰‡](#10-ã¾ã¨ã‚è¨­è¨ˆã®åŸå‰‡)
11. [å®Ÿè£…ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³](#11-å®Ÿè£…ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³)

---

## 1. è¨­è¨ˆã«ãŠã‘ã‚‹æ ¹æœ¬çš„ãªå•ã„

PBIã®ã‚ˆã†ãª**é•·ã„ãƒ»æ§‹é€ åŒ–ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿**ã‚’ã©ã†å…¥åŠ›ã™ã‚‹ã‹ï¼Ÿ

ã“ã®å•ã„ã«å¯¾ã™ã‚‹ç­”ãˆã¯ã€deespecã®è¨­è¨ˆå“²å­¦ã¨ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£ã®ä¸¡æ–¹ã«å½±éŸ¿ã—ã¾ã™ã€‚

---

## 2. çµè«–ï¼š**ãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ãŒä¸»ã€ã‚³ãƒãƒ³ãƒ‰å¼•æ•°ã¯è£œåŠ©**

### ãªãœãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ãªã®ã‹ï¼Ÿ

**3ã¤ã®ãƒ¬ãƒ™ãƒ«ã§åˆ†æ**ï¼š

1. **å®Ÿç”¨æ€§ã®è¦³ç‚¹**
2. **æ—¢å­˜ãƒ„ãƒ¼ãƒ«ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹**
3. **deespecã®å“²å­¦ã¨ã®æ•´åˆæ€§**

---

## 3. å®Ÿç”¨æ€§ã®è¦³ç‚¹

### âŒ ã‚³ãƒãƒ³ãƒ‰å¼•æ•°ã§ç›´æ¥æŠ•å…¥ã™ã‚‹å•é¡Œç‚¹

```bash
# ç¾å®Ÿçš„ã«ä¸å¯èƒ½
deespec pbi register \
  --id PBI-001 \
  --title "ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸50%é”æˆ" \
  --description "CIã®è¦ä»¶ã§ã‚ã‚‹50%ã‚«ãƒãƒ¬ãƒƒã‚¸ã‚’é”æˆã™ã‚‹ãŸã‚ã€
  ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã€Repositoryã€Applicationå±¤ã®ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ ã™ã‚‹ã€‚

  ç¾çŠ¶ã®èª²é¡Œï¼š
  - Application Usecaseå±¤ãŒå®Œå…¨ã«æœªãƒ†ã‚¹ãƒˆï¼ˆ2,907è¡Œã€0%ï¼‰
  - ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«å±¤ã‚‚å¤§éƒ¨åˆ†ãŒæœªãƒ†ã‚¹ãƒˆ

  è§£æ±ºç­–ï¼š
  Phase 1: ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ãƒ†ã‚¹ãƒˆï¼ˆ1-2æ—¥ï¼‰
  Phase 2: Repositoryå±¤ãƒ†ã‚¹ãƒˆï¼ˆ2-3æ—¥ï¼‰
  Phase 3: Usecaseå±¤éƒ¨åˆ†ãƒ†ã‚¹ãƒˆï¼ˆ3-5æ—¥ï¼‰" \
  --acceptance-criteria "go test -cover ./... ã§50%ä»¥ä¸Š" \
  --acceptance-criteria "CIãŒæˆåŠŸã™ã‚‹" \
  --story-points 8 \
  --labels testing,ci-fix,technical-debt
```

**å•é¡Œç‚¹**:
- ğŸ”´ **é•·ã™ãã¦èª­ã‚ãªã„ãƒ»ç·¨é›†ã§ããªã„**
- ğŸ”´ **æ”¹è¡Œã‚„ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãŒå´©ã‚Œã‚‹**
- ğŸ”´ **ã‚·ã‚§ãƒ«ã®ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—å•é¡Œ** (å¼•ç”¨ç¬¦ã€$å¤‰æ•°ã€ãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥)
- ğŸ”´ **å±¥æ­´ã«æ®‹ã‚‹ãŒç®¡ç†ã—ã«ãã„** (bashã®å±¥æ­´ã¯æ¤œç´¢å›°é›£)
- ğŸ”´ **ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã§ããªã„** (Gitã§å·®åˆ†ãŒè¦‹ã‚‰ã‚Œãªã„)

### âœ… ãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ã®åˆ©ç‚¹

```bash
# ã‚·ãƒ³ãƒ—ãƒ«ã§æ˜ç¢º
deespec pbi register -f .deespec/specs/pbi/PBI-001.yaml
```

```yaml
# .deespec/specs/pbi/PBI-001.yaml
id: PBI-001
title: "ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸50%é”æˆ"
description: |
  CIã®è¦ä»¶ã§ã‚ã‚‹50%ã‚«ãƒãƒ¬ãƒƒã‚¸ã‚’é”æˆã™ã‚‹ãŸã‚ã€
  ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã€Repositoryã€Applicationå±¤ã®ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ ã™ã‚‹ã€‚

  ## ç¾çŠ¶ã®èª²é¡Œ
  - Application Usecaseå±¤ãŒå®Œå…¨ã«æœªãƒ†ã‚¹ãƒˆï¼ˆ2,907è¡Œã€0%ï¼‰
  - ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«å±¤ã‚‚å¤§éƒ¨åˆ†ãŒæœªãƒ†ã‚¹ãƒˆ

  ## è§£æ±ºç­–
  - Phase 1: ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ãƒ†ã‚¹ãƒˆï¼ˆ1-2æ—¥ï¼‰
  - Phase 2: Repositoryå±¤ãƒ†ã‚¹ãƒˆï¼ˆ2-3æ—¥ï¼‰
  - Phase 3: Usecaseå±¤éƒ¨åˆ†ãƒ†ã‚¹ãƒˆï¼ˆ3-5æ—¥ï¼‰

acceptance_criteria:
  - condition: "go test -cover ./..."
    expected: ">= 50.0%"
  - condition: "CI status"
    expected: "passing"
  - condition: "Domain model coverage"
    expected: ">= 90%"

estimated_story_points: 8
priority: 1
labels: [testing, ci-fix, technical-debt]
```

**åˆ©ç‚¹**:
- âœ… **èª­ã¿ã‚„ã™ã„ã€ç·¨é›†ã—ã‚„ã™ã„**
- âœ… **ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãŒä¿ãŸã‚Œã‚‹** (æ”¹è¡Œã€ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆ)
- âœ… **IDEã®ã‚µãƒãƒ¼ãƒˆ** (ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ãƒã‚¤ãƒ©ã‚¤ãƒˆã€è£œå®Œã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³)
- âœ… **Gitã§å·®åˆ†ç®¡ç†** (å¤‰æ›´å±¥æ­´ãŒè¿½è·¡å¯èƒ½)
- âœ… **ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼å¯èƒ½** (PRã§è­°è«–ã§ãã‚‹)
- âœ… **ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆåŒ–** (ã‚³ãƒ”ãƒšã§æ–°è¦ä½œæˆ)
- âœ… **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨ã—ã¦ã‚‚æ©Ÿèƒ½** (ãã®ã¾ã¾ä»•æ§˜æ›¸)

---

## 4. æ—¢å­˜ãƒ„ãƒ¼ãƒ«ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### ä¸»è¦ãªé–‹ç™ºãƒ„ãƒ¼ãƒ«ã¯ã™ã¹ã¦ã€Œãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ã€

| ãƒ„ãƒ¼ãƒ« | ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ | ã‚³ãƒãƒ³ãƒ‰ä¾‹ | ç†ç”± |
|--------|-------------|-----------|------|
| **Kubernetes** | YAML | `kubectl apply -f deployment.yaml` | è¤‡é›‘ãªè¨­å®šã‚’ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç† |
| **Docker** | Dockerfile | `docker build -f Dockerfile` | å†ç¾å¯èƒ½ãªãƒ“ãƒ«ãƒ‰ |
| **Terraform** | .tf | `terraform apply` | Infrastructure as Code |
| **GitHub Actions** | .yml | `.github/workflows/ci.yml` | CI/CDå®šç¾©ã®å…±æœ‰ |
| **Make** | Makefile | `make build` | ãƒ“ãƒ«ãƒ‰æ‰‹é †ã®æ¨™æº–åŒ– |
| **npm** | package.json | `npm install` | ä¾å­˜é–¢ä¿‚ã®å®£è¨€çš„ç®¡ç† |
| **Ansible** | .yaml | `ansible-playbook site.yml` | æ§‹æˆç®¡ç†ã®è‡ªå‹•åŒ– |

**å…±é€šãƒ‘ã‚¿ãƒ¼ãƒ³ï¼šInfrastructure as Code (IaC)**

```
è¨­å®šãƒ•ã‚¡ã‚¤ãƒ« (å®£è¨€çš„) â†’ ãƒ„ãƒ¼ãƒ« â†’ å®Ÿè¡Œçµæœ
     â†“                      â†“
  Gitç®¡ç†å¯èƒ½          å†ç¾å¯èƒ½
  ãƒ¬ãƒ“ãƒ¥ãƒ¼å¯èƒ½          è‡ªå‹•åŒ–å¯èƒ½
```

**ãªãœãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ï¼Ÿ**
- ğŸ“ **å®£è¨€çš„ç®¡ç†**: "ä½•ã‚’ã—ãŸã„ã‹"ã‚’è¨˜è¿°
- ğŸ”„ **ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†**: Gitã§å±¥æ­´è¿½è·¡
- ğŸ‘¥ **ãƒãƒ¼ãƒ å…±æœ‰**: èª°ã§ã‚‚åŒã˜çŠ¶æ…‹ã‚’å†ç¾
- ğŸ” **ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»ç›£æŸ»**: å¤‰æ›´ãŒå¯è¦–åŒ–
- ğŸ¤– **è‡ªå‹•åŒ–**: CIã§æ¤œè¨¼ãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤

### åä¾‹ï¼šã‚³ãƒãƒ³ãƒ‰å¼•æ•°ãŒä¸»ã®ãƒ„ãƒ¼ãƒ«

| ãƒ„ãƒ¼ãƒ« | ç†ç”± |
|--------|------|
| **ls, grep, find** | å˜ç™ºã®æ¤œç´¢ãƒ»è¡¨ç¤ºæ“ä½œ |
| **git add, commit** | å°ã•ãªå˜ä½ã®æ“ä½œ |
| **curl** | ä¸€æ™‚çš„ãªAPIãƒ†ã‚¹ãƒˆ |

â†’ ã“ã‚Œã‚‰ã¯**çŠ¶æ…‹ã‚’ä¿å­˜ã—ãªã„**æ“ä½œ

**PBIã¯çŠ¶æ…‹ã‚’ä¿å­˜ã™ã¹ã** â†’ ãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ãŒé©åˆ‡

---

## 5. deespecã®å“²å­¦ã¨ã®æ•´åˆæ€§

### deespecã¯ã€Œãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã€

```
.deespec/
â”œâ”€â”€ specs/           â† ã™ã¹ã¦ã®ä»•æ§˜ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ä¿å­˜
â”‚   â”œâ”€â”€ epic/
â”‚   â”‚   â””â”€â”€ EPIC-001.yaml
â”‚   â”œâ”€â”€ pbi/
â”‚   â”‚   â”œâ”€â”€ PBI-001.yaml    â† PBIã‚‚ã“ã“ã«
â”‚   â”‚   â””â”€â”€ PBI-002.yaml
â”‚   â””â”€â”€ sbi/
â”‚       â”œâ”€â”€ SBI-001/
â”‚       â”‚   â”œâ”€â”€ spec.yaml
â”‚       â”‚   â”œâ”€â”€ implement_1.md
â”‚       â”‚   â””â”€â”€ review_1.md
â”‚       â””â”€â”€ SBI-002/
â”œâ”€â”€ var/
â”‚   â”œâ”€â”€ journal.ndjson      â† å®Ÿè¡Œå±¥æ­´
â”‚   â””â”€â”€ health.json
â”œâ”€â”€ prompts/
â”‚   â”œâ”€â”€ IMPLEMENT.md
â”‚   â”œâ”€â”€ REVIEW.md
â”‚   â””â”€â”€ DONE.md
â””â”€â”€ docs/                   â† è¨ˆç”»ãƒ»è¨­è¨ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
    â”œâ”€â”€ architecture.md
    â””â”€â”€ test-coverage-improvement-plan.md
```

**deespecã®è¨­è¨ˆæ€æƒ³**:
1. ã™ã¹ã¦ã®**ä»•æ§˜**ã¯ `.deespec/specs/` ã«ä¿å­˜
2. ã™ã¹ã¦ã®**å®Ÿè¡Œå±¥æ­´**ã¯ `journal.ndjson` ã«è¨˜éŒ²
3. ã™ã¹ã¦ã®**è¨ˆç”»**ã¯ `docs/` ã«æ–‡æ›¸åŒ–
4. ã™ã¹ã¦ã®**ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**ã¯ `.deespec/prompts/` ã«ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆåŒ–

â†’ **PBIã‚‚ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ä¿å­˜ã™ã‚‹ã®ãŒè‡ªç„¶**

### æ—¢å­˜ã®SBI registerã‚³ãƒãƒ³ãƒ‰ã¨ã®ä¸€è²«æ€§

```bash
# SBI registerï¼ˆæ—¢å­˜ï¼‰
deespec sbi register -f spec.yaml
deespec sbi register -f spec.json
deespec sbi register --stdin < spec.yaml
```

â†’ **PBIã‚‚åŒã˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã§çµ±ä¸€**

```bash
# PBI registerï¼ˆææ¡ˆï¼‰
deespec pbi register -f pbi.yaml      # YAMLãƒ•ã‚¡ã‚¤ãƒ«
deespec pbi register -f pbi.json      # JSONãƒ•ã‚¡ã‚¤ãƒ«
deespec pbi register --stdin < pbi.yaml  # stdinçµŒç”±
```

---

## 6. æ¨å¥¨è¨­è¨ˆï¼šãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

### ä¸»è¦ï¼šãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ï¼ˆå®Œå…¨ãªæ©Ÿèƒ½ï¼‰

```bash
# 1. ã‚¨ãƒ‡ã‚£ã‚¿ã§YAMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
vim .deespec/specs/pbi/PBI-001.yaml

# 2. ç™»éŒ²
deespec pbi register -f .deespec/specs/pbi/PBI-001.yaml

# ã¾ãŸã¯ stdinçµŒç”±
cat pbi-template.yaml | deespec pbi register -f -
```

**ç”¨é€”**:
- è©³ç´°ãªPBIå®šç¾©
- è¤‡é›‘ãªå—ã‘å…¥ã‚ŒåŸºæº–
- é•·ã„èª¬æ˜æ–‡
- ãƒãƒ¼ãƒ ã§ã®å…±æœ‰ãƒ»ãƒ¬ãƒ“ãƒ¥ãƒ¼

### è£œåŠ©ï¼šã‚³ãƒãƒ³ãƒ‰å¼•æ•°ï¼ˆç°¡æ˜“ç‰ˆã®ã¿ï¼‰

```bash
# ç°¡å˜ãªPBIãªã‚‰ã‚³ãƒãƒ³ãƒ‰ã§ç´ æ—©ãç™»éŒ²
deespec pbi register \
  --id PBI-002 \
  --title "ãƒ­ã‚°å‡ºåŠ›æ”¹å–„" \
  --description "ãƒ­ã‚°ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’çµ±ä¸€ã™ã‚‹" \
  --story-points 2

# å†…éƒ¨çš„ã«ã¯ .deespec/specs/pbi/PBI-002.yaml ã‚’è‡ªå‹•ç”Ÿæˆ
# â†’ ã‚ã¨ã§ã‚¨ãƒ‡ã‚£ã‚¿ã§è©³ç´°ã‚’è¿½åŠ ã§ãã‚‹
```

**ç”¨é€”**:
- ç´ æ—©ã„ãƒ¡ãƒ¢ãƒ»ã‚¢ã‚¤ãƒ‡ã‚¢ã®è¨˜éŒ²
- ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ”ãƒ³ã‚°
- ãƒ‡ãƒ¢ãƒ»ãƒ†ã‚¹ãƒˆ
- è‡ªå‹•åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

**åˆ¶é™**:
- å˜ç´”ãªæ§‹é€ ã®ã¿
- è©³ç´°ã¯å¾Œã§ãƒ•ã‚¡ã‚¤ãƒ«ç·¨é›†ã§è¿½åŠ 

### ä¾¿åˆ©ï¼šå¯¾è©±ãƒ¢ãƒ¼ãƒ‰ï¼ˆå°†æ¥å®Ÿè£…ï¼‰

```bash
# ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰å½¢å¼ã§å…¥åŠ›ï¼ˆåˆå¿ƒè€…å‘ã‘ï¼‰
deespec pbi register --interactive

# å¯¾è©±çš„ã«å…¥åŠ›ã‚’ä¿ƒã™
# > PBI ID: PBI-003
# > Title: APIèªè¨¼æ©Ÿèƒ½è¿½åŠ 
# > Description (Ctrl+D to finish):
#   OAuth 2.0ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹
#   æ—¢å­˜ã®èªè¨¼ã¨å…±å­˜ã•ã›ã‚‹
#   ^D
# > Story Points: 5
# > Labels (comma-separated): feature,api
# > Edit in $EDITOR? [y/N]: y

# yã‚’é¸æŠã™ã‚‹ã¨ã‚¨ãƒ‡ã‚£ã‚¿ãŒèµ·å‹•
# ä¿å­˜ã™ã‚‹ã¨ .deespec/specs/pbi/PBI-003.yaml ã¨ã—ã¦ä¿å­˜
```

### æœ€ã‚‚è‡ªç„¶ï¼šã‚¨ãƒ‡ã‚£ã‚¿çµ±åˆï¼ˆå°†æ¥å®Ÿè£…ï¼‰

```bash
# ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ç”Ÿæˆã—ã¦ã‚¨ãƒ‡ã‚£ã‚¿ã§é–‹ã
deespec pbi init PBI-004
# â†’ .deespec/specs/pbi/PBI-004.yaml ã‚’ç”Ÿæˆã— $EDITOR ã§é–‹ã
# â†’ ä¿å­˜ã™ã‚‹ã¨è‡ªå‹•çš„ã«ç™»éŒ²ã•ã‚Œã‚‹

# æ—¢å­˜PBIã®ç·¨é›†
deespec pbi edit PBI-001
# â†’ $EDITORã§é–‹ã
# â†’ ä¿å­˜ã™ã‚‹ã¨å¤‰æ›´ã‚’æ¤œå‡ºã—ã¦æ›´æ–°

# ãƒ•ã‚¡ã‚¤ãƒ«ç›£è¦–ãƒ¢ãƒ¼ãƒ‰ï¼ˆè‡ªå‹•syncï¼‰
deespec pbi watch
# â†’ .deespec/specs/pbi/ ã‚’ç›£è¦–
# â†’ ãƒ•ã‚¡ã‚¤ãƒ«ãŒå¤‰æ›´ã•ã‚Œã‚‹ã¨è‡ªå‹•çš„ã«åæ˜ 
```

---

## 7. å®Ÿè£…å„ªå…ˆåº¦

### Phase 1: åŸºæœ¬æ©Ÿèƒ½ï¼ˆæœ€å„ªå…ˆï¼‰

```bash
# âœ… Priority 1
deespec pbi register -f <file>     # ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã®ç™»éŒ²
deespec pbi show <id>              # æ—¢å­˜PBIã®è¡¨ç¤º
deespec pbi list                   # ä¸€è¦§è¡¨ç¤º
deespec pbi list --status IMPLEMENTING  # ãƒ•ã‚£ãƒ«ã‚¿
```

**ç†ç”±**: æœ€ã‚‚é‡è¦ãªæ©Ÿèƒ½ã€‚ã“ã‚Œã ã‘ã§å®Ÿç”¨å¯èƒ½ã€‚

### Phase 2: åˆ©ä¾¿æ€§å‘ä¸Šï¼ˆæ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼‰

```bash
# âœ… Priority 2
deespec pbi register --title "..." --description "..."  # ç°¡æ˜“ç™»éŒ²
deespec pbi init PBI-005           # ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”Ÿæˆ
deespec pbi register --interactive # å¯¾è©±ãƒ¢ãƒ¼ãƒ‰
```

**ç†ç”±**: UXã®å‘ä¸Šã€‚åˆå¿ƒè€…ã«ã‚‚å„ªã—ãã€‚

### Phase 3: é«˜åº¦ãªæ©Ÿèƒ½ï¼ˆå°†æ¥ï¼‰

```bash
# âœ… Priority 3
deespec pbi edit PBI-001           # ã‚¨ãƒ‡ã‚£ã‚¿ã§ç·¨é›†
deespec pbi watch                  # ãƒ•ã‚¡ã‚¤ãƒ«ç›£è¦–
deespec pbi template --output custom-template.yaml  # ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
```

**ç†ç”±**: ãƒ‘ãƒ¯ãƒ¼ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ã€‚è‡ªå‹•åŒ–ã€‚

---

## 8. ãƒ•ã‚¡ã‚¤ãƒ«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆè©³ç´°

### æ¨å¥¨ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼šYAMLï¼ˆäººé–“ãŒèª­ã¿ã‚„ã™ã„ï¼‰

```yaml
# .deespec/specs/pbi/PBI-001.yaml
version: "1.0"  # ã‚¹ã‚­ãƒ¼ãƒãƒãƒ¼ã‚¸ãƒ§ãƒ³
type: pbi

# === åŸºæœ¬æƒ…å ± ===
id: PBI-001
title: "ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸50%é”æˆ"
description: |
  è¤‡æ•°è¡Œã®è©³ç´°ãªèª¬æ˜ã€‚
  Markdownã‚‚ä½¿ãˆã‚‹ã€‚

  ## èƒŒæ™¯
  CIãŒå¤±æ•—ã—ã¦ã„ã‚‹ã€‚

  ## ç›®æ¨™
  ã‚«ãƒãƒ¬ãƒƒã‚¸50%é”æˆã€‚

# === ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ ===
status: PENDING
estimated_story_points: 8
priority: 1  # 0=é€šå¸¸, 1=é«˜, 2=ç·Šæ€¥
labels:
  - testing
  - ci-fix
  - technical-debt
assigned_agent: claude-code

# === éšå±¤æ§‹é€  ===
parent_epic: null  # EPICã®IDã¾ãŸã¯null
child_sbis:
  - TEST-COV-SBI-001
  - TEST-COV-SBI-002
  - TEST-COV-SBI-003

# === å—ã‘å…¥ã‚ŒåŸºæº– ===
acceptance_criteria:
  - condition: "Coverage"
    expected: ">= 50%"
    measurement_command: "go test -cover ./..."
  - condition: "CI"
    expected: "passing"
    verification: "GitHub Actions must be green"

# === é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ ===
related_documents:
  - docs/test-coverage-improvement-plan.md
  - docs/architecture.md

# === ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆæ‹¡å¼µå¯èƒ½ï¼‰ ===
custom:
  related_issues:
    github: "#123"
    jira: "PROJ-456"
  risk_level: medium
  dependencies:
    - "Infrastructure setup"
```

### ä»£æ›¿ï¼šJSONï¼ˆæ©Ÿæ¢°ãŒèª­ã¿ã‚„ã™ã„ï¼‰

```json
{
  "version": "1.0",
  "type": "pbi",
  "id": "PBI-001",
  "title": "ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸50%é”æˆ",
  "description": "CIã®è¦ä»¶ã§ã‚ã‚‹50%ã‚«ãƒãƒ¬ãƒƒã‚¸ã‚’é”æˆ...",
  "status": "PENDING",
  "estimated_story_points": 8,
  "labels": ["testing", "ci-fix"]
}
```

**YAMLã¨JSONã®ä½¿ã„åˆ†ã‘**:
- **YAML**: äººé–“ãŒæ‰‹ã§æ›¸ããƒ»èª­ã‚€ï¼ˆæ¨å¥¨ï¼‰
- **JSON**: æ©Ÿæ¢°ç”Ÿæˆã€APIé€£æºã€è‡ªå‹•åŒ–

---

## 9. ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°ï¼ˆç°¡æ˜“ç‰ˆï¼‰ã®ä»•æ§˜

```bash
# å¿…é ˆé …ç›®ã®ã¿ã§ç™»éŒ²ï¼ˆä»–ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ï¼‰
deespec pbi register \
  --title "ãƒ­ã‚°å‡ºåŠ›æ”¹å–„" \
  --description "ãƒ­ã‚°ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’çµ±ä¸€"

# è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹å†…å®¹:
# - id: PBI-XXX (è‡ªå‹•æ¡ç•ª)
# - status: PENDING
# - priority: 0 (é€šå¸¸)
# - estimated_story_points: 0 (æœªè¦‹ç©ã‚‚ã‚Š)
# - created_at: ç¾åœ¨æ™‚åˆ»

# ã‚ªãƒ—ã‚·ãƒ§ãƒ³è¿½åŠ 
deespec pbi register \
  --title "ãƒ­ã‚°å‡ºåŠ›æ”¹å–„" \
  --description "ãƒ­ã‚°ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’çµ±ä¸€" \
  --story-points 2 \
  --priority 1 \
  --labels testing,logging \
  --output .deespec/specs/pbi/CUSTOM-001.yaml

# ç”Ÿæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèªãƒ»ç·¨é›†
cat .deespec/specs/pbi/CUSTOM-001.yaml
# â†’ å¿…è¦ã«å¿œã˜ã¦ã‚¨ãƒ‡ã‚£ã‚¿ã§è©³ç´°ã‚’è¿½åŠ 
```

---

## 10. ã¾ã¨ã‚ï¼šè¨­è¨ˆã®åŸå‰‡

### âœ… æ¨å¥¨ï¼šãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ã‚’ä¸»è»¸ã«

**ç†ç”±**:
1. âœ… é•·ã„å†…å®¹ï¼ˆèª¬æ˜ã€å—ã‘å…¥ã‚ŒåŸºæº–ã€é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼‰ã‚’æ‰±ãˆã‚‹
2. âœ… Gitã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã§ãã‚‹ï¼ˆå¤‰æ›´å±¥æ­´ã€å·®åˆ†ã€ãƒ–ãƒ©ãƒ³ãƒï¼‰
3. âœ… ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§ãã‚‹ï¼ˆPRã§ãƒãƒ¼ãƒ ã§è­°è«–ï¼‰
4. âœ… IDEã®ã‚µãƒãƒ¼ãƒˆï¼ˆã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ãƒã‚¤ãƒ©ã‚¤ãƒˆã€è£œå®Œã€æ¤œè¨¼ï¼‰
5. âœ… æ—¢å­˜ãƒ„ãƒ¼ãƒ«ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã«æº–æ‹ ï¼ˆKubernetes, Docker, Terraformç­‰ï¼‰
6. âœ… deespecã®ã€Œãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã€å“²å­¦ã«åˆè‡´
7. âœ… æ—¢å­˜ã®SBI registerã¨ã®ä¸€è²«æ€§

### âœ… è£œåŠ©ï¼šã‚³ãƒãƒ³ãƒ‰å¼•æ•°ï¼ˆé™å®šçš„ï¼‰

**ç”¨é€”**:
- ç´ æ—©ã„ãƒ¡ãƒ¢ãƒ»ã‚¢ã‚¤ãƒ‡ã‚¢ã®è¨˜éŒ²
- ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ”ãƒ³ã‚°ãƒ»ãƒ‡ãƒ¢
- è‡ªå‹•åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã®ç”Ÿæˆ

**åˆ¶é™**:
- å˜ç´”ãªæ§‹é€ ã®ã¿
- å†…éƒ¨çš„ã«YAMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆ
- è©³ç´°ã¯å¾Œã§ãƒ•ã‚¡ã‚¤ãƒ«ç·¨é›†

### âœ… å°†æ¥ï¼šå¯¾è©±ãƒ¢ãƒ¼ãƒ‰ & ã‚¨ãƒ‡ã‚£ã‚¿çµ±åˆ

**UXå‘ä¸Š**:
- åˆå¿ƒè€…ã«ã‚‚å„ªã—ã„æ®µéšçš„å…¥åŠ›
- ã‚¨ãƒ‡ã‚£ã‚¿ã§é•·æ–‡ã‚’å¿«é©ã«ç·¨é›†
- ãƒ•ã‚¡ã‚¤ãƒ«ç›£è¦–ã§è‡ªå‹•sync

---

## 11. å®Ÿè£…ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

```go
// internal/interface/cli/pbi/register.go

func newRegisterCmd() *cobra.Command {
    var (
        file        string  // -f, --file
        title       string  // --title
        description string  // --description
        storyPoints int     // --story-points
        interactive bool    // --interactive
    )

    cmd := &cobra.Command{
        Use:   "register",
        Short: "Register a new PBI",
        Long: `Register a new PBI from a YAML/JSON file or command-line arguments.

Recommended: Use a YAML file for detailed PBIs
Quick mode: Use --title for simple PBIs`,
        RunE: func(cmd *cobra.Command, args []string) error {
            // Priority 1: File-based
            if file != "" {
                return registerFromFile(file)
            }

            // Priority 2: Interactive mode
            if interactive {
                return registerInteractive()
            }

            // Priority 3: Command-line arguments (simple mode)
            if title != "" {
                return registerFromArgs(title, description, storyPoints)
            }

            // No input provided
            return cmd.Help()
        },
    }

    cmd.Flags().StringVarP(&file, "file", "f", "", "PBI YAML/JSON file")
    cmd.Flags().StringVar(&title, "title", "", "PBI title (simple mode)")
    cmd.Flags().StringVar(&description, "description", "", "PBI description")
    cmd.Flags().IntVar(&storyPoints, "story-points", 0, "Estimated story points")
    cmd.Flags().BoolVarP(&interactive, "interactive", "i", false, "Interactive mode")

    return cmd
}
```

---

**Infrastructure as Code ã®åŸå‰‡**:

Kubernetes, Docker, Terraform ãªã©ã€æˆåŠŸã—ã¦ã„ã‚‹ãƒ„ãƒ¼ãƒ«ã¯ã™ã¹ã¦ã€Œãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ã€ã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™ã€‚

ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°ã¯**ä¸€æ™‚çš„ãªæ“ä½œ**ç”¨ã€æ°¸ç¶šçš„ãªè¨­å®šã¯**ãƒ•ã‚¡ã‚¤ãƒ«**ã«ä¿å­˜ã€‚

deespecã‚‚åŒã˜åŸå‰‡ã«å¾“ã†ã“ã¨ã§ã€æ—¢å­˜ã®ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ï¼ˆGit, CI/CDã€IDEç­‰ï¼‰ã¨è‡ªç„¶ã«çµ±åˆã§ãã¾ã™ã€‚
