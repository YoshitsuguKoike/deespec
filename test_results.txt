# github.com/YoshitsuguKoike/deespec/internal/interface/cli
internal/interface/cli/lease_test.go:8:16: expected '(', found '.'
FAIL	github.com/YoshitsuguKoike/deespec/internal/interface/cli [setup failed]
?   	github.com/YoshitsuguKoike/deespec/cmd/deespec	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/adapter/controller/cli	[no test files]
=== RUN   TestGeminiMockGateway
--- PASS: TestGeminiMockGateway (0.10s)
=== RUN   TestCodexMockGateway
--- PASS: TestCodexMockGateway (0.16s)
=== RUN   TestClaudeCodeGateway
    agent_gateway_test.go:96: Skipping Claude Code test: ANTHROPIC_API_KEY not set
--- SKIP: TestClaudeCodeGateway (0.00s)
=== RUN   TestNewAgentGateway
=== RUN   TestNewAgentGateway/gemini-cli
=== RUN   TestNewAgentGateway/codex
=== RUN   TestNewAgentGateway/unknown_agent
=== RUN   TestNewAgentGateway/claude-code_without_API_key
=== RUN   TestNewAgentGateway/claude-code_with_API_key
--- PASS: TestNewAgentGateway (0.00s)
    --- PASS: TestNewAgentGateway/gemini-cli (0.00s)
    --- PASS: TestNewAgentGateway/codex (0.00s)
    --- PASS: TestNewAgentGateway/unknown_agent (0.00s)
    --- PASS: TestNewAgentGateway/claude-code_without_API_key (0.00s)
    --- PASS: TestNewAgentGateway/claude-code_with_API_key (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/adapter/gateway/agent	(cached)
=== RUN   TestLocalStorageGateway_SaveAndLoadArtifact
--- PASS: TestLocalStorageGateway_SaveAndLoadArtifact (0.01s)
=== RUN   TestLocalStorageGateway_ListArtifacts
--- PASS: TestLocalStorageGateway_ListArtifacts (0.00s)
=== RUN   TestLocalStorageGateway_ListArtifacts_EmptyTask
--- PASS: TestLocalStorageGateway_ListArtifacts_EmptyTask (0.00s)
=== RUN   TestLocalStorageGateway_LoadInstruction_AbsolutePath
--- PASS: TestLocalStorageGateway_LoadInstruction_AbsolutePath (0.01s)
=== RUN   TestLocalStorageGateway_LoadInstruction_RelativePath
--- PASS: TestLocalStorageGateway_LoadInstruction_RelativePath (0.00s)
=== RUN   TestLocalStorageGateway_DeleteArtifact
--- PASS: TestLocalStorageGateway_DeleteArtifact (0.00s)
=== RUN   TestLocalStorageGateway_EnsureInstructionFile
--- PASS: TestLocalStorageGateway_EnsureInstructionFile (0.00s)
=== RUN   TestLocalStorageGateway_CopyFile
--- PASS: TestLocalStorageGateway_CopyFile (0.00s)
=== RUN   TestLocalStorageGateway_GetStoragePath
--- PASS: TestLocalStorageGateway_GetStoragePath (0.00s)
=== RUN   TestS3StorageGateway_SaveAndLoadArtifact
--- PASS: TestS3StorageGateway_SaveAndLoadArtifact (0.00s)
=== RUN   TestS3StorageGateway_LoadArtifact_NotFound
--- PASS: TestS3StorageGateway_LoadArtifact_NotFound (0.00s)
=== RUN   TestS3StorageGateway_ListArtifacts
--- PASS: TestS3StorageGateway_ListArtifacts (0.00s)
=== RUN   TestS3StorageGateway_ListArtifacts_EmptyTask
--- PASS: TestS3StorageGateway_ListArtifacts_EmptyTask (0.00s)
=== RUN   TestS3StorageGateway_LoadInstruction
--- PASS: TestS3StorageGateway_LoadInstruction (0.00s)
=== RUN   TestS3StorageGateway_DeleteArtifact
--- PASS: TestS3StorageGateway_DeleteArtifact (0.00s)
=== RUN   TestS3StorageGateway_MultipleTasks
--- PASS: TestS3StorageGateway_MultipleTasks (0.00s)
=== RUN   TestS3StorageGateway_ArtifactMetadata
--- PASS: TestS3StorageGateway_ArtifactMetadata (0.00s)
=== RUN   TestS3StorageGateway_BuildKey
--- PASS: TestS3StorageGateway_BuildKey (0.00s)
=== RUN   TestMockStorageGateway_SaveAndLoad
--- PASS: TestMockStorageGateway_SaveAndLoad (0.00s)
=== RUN   TestMockStorageGateway_LoadInstruction
--- PASS: TestMockStorageGateway_LoadInstruction (0.00s)
=== RUN   TestMockStorageGateway_ListArtifacts
--- PASS: TestMockStorageGateway_ListArtifacts (0.00s)
=== RUN   TestMockStorageGateway_LoadArtifact_NotFound
--- PASS: TestMockStorageGateway_LoadArtifact_NotFound (0.00s)
=== RUN   TestMockStorageGateway_Clear
--- PASS: TestMockStorageGateway_Clear (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/adapter/gateway/storage	(cached)
?   	github.com/YoshitsuguKoike/deespec/internal/app/config	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/app/health	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/application/dto	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/application/port/input	[no test files]
=== RUN   TestCLITaskPresenter_PresentSuccess
=== RUN   TestCLITaskPresenter_PresentSuccess/present_SBI
=== RUN   TestCLITaskPresenter_PresentSuccess/present_task_list
--- PASS: TestCLITaskPresenter_PresentSuccess (0.00s)
    --- PASS: TestCLITaskPresenter_PresentSuccess/present_SBI (0.00s)
    --- PASS: TestCLITaskPresenter_PresentSuccess/present_task_list (0.00s)
=== RUN   TestCLITaskPresenter_PresentError
--- PASS: TestCLITaskPresenter_PresentError (0.00s)
=== RUN   TestCLITaskPresenter_PresentProgress
--- PASS: TestCLITaskPresenter_PresentProgress (0.00s)
=== RUN   TestJSONPresenter_PresentSuccess
--- PASS: TestJSONPresenter_PresentSuccess (0.00s)
=== RUN   TestJSONPresenter_PresentError
--- PASS: TestJSONPresenter_PresentError (0.00s)
=== RUN   TestJSONPresenter_PresentProgress
--- PASS: TestJSONPresenter_PresentProgress (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/adapter/presenter	0.210s
?   	github.com/YoshitsuguKoike/deespec/internal/application/usecase	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/application/usecase/execution	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/application/usecase/task	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/application/usecase/workflow	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/buildinfo	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/domain	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/domain/factory	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/domain/model	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/domain/model/epic	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/domain/model/lock	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/domain/model/pbi	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/domain/model/sbi	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/domain/model/task	[no test files]
=== RUN   TestNormalizeJournalEntry_FillsDefaults
--- PASS: TestNormalizeJournalEntry_FillsDefaults (0.00s)
=== RUN   TestNormalizeJournalEntry_PreservesExistingValues
--- PASS: TestNormalizeJournalEntry_PreservesExistingValues (0.00s)
=== RUN   TestNormalizeJournalEntryMap_FillsMissingKeys
--- PASS: TestNormalizeJournalEntryMap_FillsMissingKeys (0.00s)
=== RUN   TestNormalizeJournalEntryMap_PreservesExistingValues
--- PASS: TestNormalizeJournalEntryMap_PreservesExistingValues (0.00s)
=== RUN   TestNormalizeJournalEntryMap_HandlesStringArtifacts
--- PASS: TestNormalizeJournalEntryMap_HandlesStringArtifacts (0.00s)
=== RUN   TestJournalWriter_Append
--- PASS: TestJournalWriter_Append (0.02s)
=== RUN   TestJournalWriter_QuickAppend
--- PASS: TestJournalWriter_QuickAppend (0.02s)
=== RUN   TestJournalWriter_ValidationWarning
--- PASS: TestJournalWriter_ValidationWarning (0.01s)
=== RUN   TestJournalWriterAppend
--- PASS: TestJournalWriterAppend (0.01s)
=== RUN   TestJournalWriterMultipleAppends
--- PASS: TestJournalWriterMultipleAppends (0.06s)
=== RUN   TestJournalWriterConcurrentAppends
--- PASS: TestJournalWriterConcurrentAppends (0.02s)
=== RUN   TestJournalWriterNormalization
--- PASS: TestJournalWriterNormalization (0.01s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/app	0.564s
=== RUN   TestLoadState
=== RUN   TestLoadState/minimal_valid_state
=== RUN   TestLoadState/state_with_defaults
=== RUN   TestLoadState/legacy_current_field
2025/10/08 22:51:49 INFO: Migrating 'current' field to 'step' in state.json
=== RUN   TestLoadState/invalid_step_value
2025/10/08 22:51:49 WARN: Invalid step value 'foo' in state.json (expected: plan, implement, test, review, or done)
=== RUN   TestLoadState/both_step_and_current_(step_wins)
--- PASS: TestLoadState (0.08s)
    --- PASS: TestLoadState/minimal_valid_state (0.03s)
    --- PASS: TestLoadState/state_with_defaults (0.01s)
    --- PASS: TestLoadState/legacy_current_field (0.02s)
    --- PASS: TestLoadState/invalid_step_value (0.01s)
    --- PASS: TestLoadState/both_step_and_current_(step_wins) (0.00s)
=== RUN   TestSaveStateAtomic
--- PASS: TestSaveStateAtomic (0.01s)
=== RUN   TestSaveStateAtomicOverwrite
--- PASS: TestSaveStateAtomicOverwrite (0.01s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/app/state	(cached)
testing: warning: no tests to run
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/application/port/output	(cached) [no tests to run]
?   	github.com/YoshitsuguKoike/deespec/internal/embed	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/domain/service/strategy	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/infrastructure/repository	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/infrastructure/repository/mock	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/interface/cli/claude_prompt	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/interface/cli/common	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/interface/cli/doctor	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/interface/cli/health	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/interface/cli/init	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/interface/cli/journal	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/interface/cli/label	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/interface/cli/lock_cmd	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/interface/cli/clear	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/interface/cli/notes	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/interface/cli/picker	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/interface/cli/register	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/interface/cli/run	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/interface/cli/sbi	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/interface/cli/status	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/interface/cli/workflow	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/interface/cli/workflow_config	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/interface/cli/workflow_sbi	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/usecase	[no test files]
?   	github.com/YoshitsuguKoike/deespec/internal/validator/common	[no test files]
=== RUN   TestLockService_AcquireAndReleaseRunLock
--- PASS: TestLockService_AcquireAndReleaseRunLock (0.00s)
=== RUN   TestLockService_AcquireAndReleaseStateLock
--- PASS: TestLockService_AcquireAndReleaseStateLock (0.00s)
=== RUN   TestLockService_RunLockHeartbeat
--- PASS: TestLockService_RunLockHeartbeat (0.55s)
=== RUN   TestLockService_StateLockHeartbeat
--- PASS: TestLockService_StateLockHeartbeat (0.55s)
=== RUN   TestLockService_CleanupScheduler
--- PASS: TestLockService_CleanupScheduler (0.50s)
=== RUN   TestLockService_Stop
--- PASS: TestLockService_Stop (0.50s)
=== RUN   TestLockService_ExtendRunLock
--- PASS: TestLockService_ExtendRunLock (0.00s)
=== RUN   TestLockService_ExtendStateLock
--- PASS: TestLockService_ExtendStateLock (0.00s)
=== RUN   TestLockService_ListLocks
--- PASS: TestLockService_ListLocks (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/application/service	2.625s
=== RUN   TestWorkflowManager_NewWorkflowManager
--- PASS: TestWorkflowManager_NewWorkflowManager (0.00s)
=== RUN   TestWorkflowManager_RegisterWorkflow
--- PASS: TestWorkflowManager_RegisterWorkflow (0.00s)
=== RUN   TestWorkflowManager_GetEnabledWorkflows
--- PASS: TestWorkflowManager_GetEnabledWorkflows (0.00s)
=== RUN   TestWorkflowManager_RunWorkflow
--- PASS: TestWorkflowManager_RunWorkflow (0.20s)
=== RUN   TestWorkflowManager_RunAll
--- PASS: TestWorkflowManager_RunAll (0.20s)
=== RUN   TestWorkflowManager_ErrorHandling
--- PASS: TestWorkflowManager_ErrorHandling (0.20s)
=== RUN   TestWorkflowManager_Stats
--- PASS: TestWorkflowManager_Stats (0.20s)
=== RUN   TestWorkflowManager_ConcurrentAccess
--- PASS: TestWorkflowManager_ConcurrentAccess (0.11s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/application/workflow	(cached)
=== RUN   TestNewSBIExecution
--- PASS: TestNewSBIExecution (0.00s)
=== RUN   TestExecutionTransitions
=== RUN   TestExecutionTransitions/Ready_to_Implement
=== RUN   TestExecutionTransitions/Implement_to_Review
=== RUN   TestExecutionTransitions/Review_to_Implement_(retry)
=== RUN   TestExecutionTransitions/Review_to_Done_(success)
=== RUN   TestExecutionTransitions/Invalid:_Ready_to_Done
=== RUN   TestExecutionTransitions/Invalid:_Implement_to_Implement
--- PASS: TestExecutionTransitions (0.00s)
    --- PASS: TestExecutionTransitions/Ready_to_Implement (0.00s)
    --- PASS: TestExecutionTransitions/Implement_to_Review (0.00s)
    --- PASS: TestExecutionTransitions/Review_to_Implement_(retry) (0.00s)
    --- PASS: TestExecutionTransitions/Review_to_Done_(success) (0.00s)
    --- PASS: TestExecutionTransitions/Invalid:_Ready_to_Done (0.00s)
    --- PASS: TestExecutionTransitions/Invalid:_Implement_to_Implement (0.00s)
=== RUN   TestApplyDecision
=== RUN   TestApplyDecision/Apply_Succeeded_in_Review
=== RUN   TestApplyDecision/Apply_NeedsChanges_in_Review
=== RUN   TestApplyDecision/Cannot_apply_in_WIP
=== RUN   TestApplyDecision/Cannot_apply_in_Ready
=== RUN   TestApplyDecision/Invalid_decision
--- PASS: TestApplyDecision (0.00s)
    --- PASS: TestApplyDecision/Apply_Succeeded_in_Review (0.00s)
    --- PASS: TestApplyDecision/Apply_NeedsChanges_in_Review (0.00s)
    --- PASS: TestApplyDecision/Cannot_apply_in_WIP (0.00s)
    --- PASS: TestApplyDecision/Cannot_apply_in_Ready (0.00s)
    --- PASS: TestApplyDecision/Invalid_decision (0.00s)
=== RUN   TestNextStepLogic
=== RUN   TestNextStepLogic/Ready_->_Implement
=== RUN   TestNextStepLogic/First_Review_Success_->_Done
=== RUN   TestNextStepLogic/First_Review_Fail_->_Second_Try
=== RUN   TestNextStepLogic/Second_Review_Success_->_Done
=== RUN   TestNextStepLogic/Second_Review_Fail_->_Third_Try
=== RUN   TestNextStepLogic/Third_Review_Success_->_Done
=== RUN   TestNextStepLogic/Third_Review_Fail_->_Force
=== RUN   TestNextStepLogic/Force_->_Implementer_Review
=== RUN   TestNextStepLogic/Implementer_Review_->_Done
--- PASS: TestNextStepLogic (0.00s)
    --- PASS: TestNextStepLogic/Ready_->_Implement (0.00s)
    --- PASS: TestNextStepLogic/First_Review_Success_->_Done (0.00s)
    --- PASS: TestNextStepLogic/First_Review_Fail_->_Second_Try (0.00s)
    --- PASS: TestNextStepLogic/Second_Review_Success_->_Done (0.00s)
    --- PASS: TestNextStepLogic/Second_Review_Fail_->_Third_Try (0.00s)
    --- PASS: TestNextStepLogic/Third_Review_Success_->_Done (0.00s)
    --- PASS: TestNextStepLogic/Third_Review_Fail_->_Force (0.00s)
    --- PASS: TestNextStepLogic/Force_->_Implementer_Review (0.00s)
    --- PASS: TestNextStepLogic/Implementer_Review_->_Done (0.00s)
=== RUN   TestShouldForceTerminate
=== RUN   TestShouldForceTerminate/Not_enough_attempts
=== RUN   TestShouldForceTerminate/Three_attempts_with_failure
=== RUN   TestShouldForceTerminate/Three_attempts_but_success
=== RUN   TestShouldForceTerminate/Four_attempts
--- PASS: TestShouldForceTerminate (0.00s)
    --- PASS: TestShouldForceTerminate/Not_enough_attempts (0.00s)
    --- PASS: TestShouldForceTerminate/Three_attempts_with_failure (0.00s)
    --- PASS: TestShouldForceTerminate/Three_attempts_but_success (0.00s)
    --- PASS: TestShouldForceTerminate/Four_attempts (0.00s)
=== RUN   TestGetFinalDecision
=== RUN   TestGetFinalDecision/Not_completed
=== RUN   TestGetFinalDecision/Completed_with_Success
=== RUN   TestGetFinalDecision/Completed_with_Failure
=== RUN   TestGetFinalDecision/Completed_after_force_termination
--- PASS: TestGetFinalDecision (0.00s)
    --- PASS: TestGetFinalDecision/Not_completed (0.00s)
    --- PASS: TestGetFinalDecision/Completed_with_Success (0.00s)
    --- PASS: TestGetFinalDecision/Completed_with_Failure (0.00s)
    --- PASS: TestGetFinalDecision/Completed_after_force_termination (0.00s)
=== RUN   TestIsCompleted
=== RUN   TestIsCompleted/Not_completed_-_Ready
=== RUN   TestIsCompleted/Not_completed_-_Implementation
=== RUN   TestIsCompleted/Not_completed_-_Review
=== RUN   TestIsCompleted/Completed_-_Done
--- PASS: TestIsCompleted (0.00s)
    --- PASS: TestIsCompleted/Not_completed_-_Ready (0.00s)
    --- PASS: TestIsCompleted/Not_completed_-_Implementation (0.00s)
    --- PASS: TestIsCompleted/Not_completed_-_Review (0.00s)
    --- PASS: TestIsCompleted/Completed_-_Done (0.00s)
=== RUN   TestAttemptIncrement
--- PASS: TestAttemptIncrement (0.00s)
=== RUN   TestTimingFields
--- PASS: TestTimingFields (0.05s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/domain/execution	(cached)
=== RUN   TestNewLabel
--- PASS: TestNewLabel (0.00s)
=== RUN   TestReconstructLabel
--- PASS: TestReconstructLabel (0.00s)
=== RUN   TestSetContentHash
--- PASS: TestSetContentHash (0.00s)
=== RUN   TestSetLineCount
--- PASS: TestSetLineCount (0.00s)
=== RUN   TestUpdateSyncTime
--- PASS: TestUpdateSyncTime (0.01s)
=== RUN   TestActivateDeactivate
--- PASS: TestActivateDeactivate (0.00s)
=== RUN   TestAddRemoveTemplatePath
--- PASS: TestAddRemoveTemplatePath (0.00s)
=== RUN   TestClearContentHashes
--- PASS: TestClearContentHashes (0.00s)
=== RUN   TestSetParentLabelID
--- PASS: TestSetParentLabelID (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/domain/model/label	(cached)
testing: warning: no tests to run
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/domain/repository	0.641s [no tests to run]
=== RUN   TestLoadSettings
=== RUN   TestLoadSettings/Default_values_only
=== RUN   TestLoadSettings/JSON_file_only
--- PASS: TestLoadSettings (0.00s)
    --- PASS: TestLoadSettings/Default_values_only (0.00s)
    --- PASS: TestLoadSettings/JSON_file_only (0.00s)
=== RUN   TestToBool
=== RUN   TestToBool/1
=== RUN   TestToBool/true
=== RUN   TestToBool/TRUE
=== RUN   TestToBool/True
=== RUN   TestToBool/yes
=== RUN   TestToBool/YES
=== RUN   TestToBool/on
=== RUN   TestToBool/ON
=== RUN   TestToBool/0
=== RUN   TestToBool/false
=== RUN   TestToBool/FALSE
=== RUN   TestToBool/no
=== RUN   TestToBool/off
=== RUN   TestToBool/#00
=== RUN   TestToBool/invalid
--- PASS: TestToBool (0.00s)
    --- PASS: TestToBool/1 (0.00s)
    --- PASS: TestToBool/true (0.00s)
    --- PASS: TestToBool/TRUE (0.00s)
    --- PASS: TestToBool/True (0.00s)
    --- PASS: TestToBool/yes (0.00s)
    --- PASS: TestToBool/YES (0.00s)
    --- PASS: TestToBool/on (0.00s)
    --- PASS: TestToBool/ON (0.00s)
    --- PASS: TestToBool/0 (0.00s)
    --- PASS: TestToBool/false (0.00s)
    --- PASS: TestToBool/FALSE (0.00s)
    --- PASS: TestToBool/no (0.00s)
    --- PASS: TestToBool/off (0.00s)
    --- PASS: TestToBool/#00 (0.00s)
    --- PASS: TestToBool/invalid (0.00s)
=== RUN   TestCreateDefaultSettings
--- PASS: TestCreateDefaultSettings (0.00s)
=== RUN   TestLoadSettings_LabelConfig
=== RUN   TestLoadSettings_LabelConfig/Default_label_config
=== RUN   TestLoadSettings_LabelConfig/Custom_label_config_from_JSON
--- PASS: TestLoadSettings_LabelConfig (0.00s)
    --- PASS: TestLoadSettings_LabelConfig/Default_label_config (0.00s)
    --- PASS: TestLoadSettings_LabelConfig/Custom_label_config_from_JSON (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/infra/config	(cached)
=== RUN   TestFsyncFile
--- PASS: TestFsyncFile (0.01s)
=== RUN   TestFsyncDir
--- PASS: TestFsyncDir (0.02s)
=== RUN   TestAtomicRename
--- PASS: TestAtomicRename (0.01s)
=== RUN   TestWriteFileSync
--- PASS: TestWriteFileSync (0.03s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/infra/fs	(cached)
=== RUN   TestChecksumMismatchRecoveryIntegration
=== RUN   TestChecksumMismatchRecoveryIntegration/ChecksumMismatchFailsGracefully
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/var/txn/txn_1759998314_323827000/stage/test_file.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

ERROR: Checksum validation failed txn.checksum.validation.failed=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/var/txn/txn_1759998314_323827000/stage/test_file.txt txn.checksum.calculation.duration_ms=0ms error=size_mismatch expected_size=34 actual_size=30

=== RUN   TestChecksumMismatchRecoveryIntegration/RecoveryDetectsCorruptedTransaction
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/var/txn/txn_1759998314_371765000/stage/recovery_test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

[TXN-SCAN] 2025/10/09 17:25:14 WARN: Found transaction with intent but no commit txn.id=txn_1759998314_323827000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/09 17:25:14 WARN: Found transaction with intent but no commit txn.id=txn_1759998314_371765000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/09 17:25:14 SUMMARY: Transaction scan complete txn.scan.total=2 txn.scan.timestamp=2025-10-09T08:25:14Z
[TXN-SCAN] 2025/10/09 17:25:14   - Forward recovery needed txn.scan.intent_only_count=2 txn.scan.intent_only_ids=[txn_1759998314_323827000,txn_1759998314_371765000]
[TXN-SCAN] 2025/10/09 17:25:14 NOTE: Recovery disabled txn.scan.recovery_action=none txn.cleanup_policy=pending_step8
ERROR: Checksum validation failed txn.checksum.validation.failed=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/var/txn/txn_1759998314_323827000/stage/test_file.txt txn.checksum.calculation.duration_ms=0ms error=size_mismatch expected_size=34 actual_size=30

WARN: Transaction recovery timeout/cancelled txn.id=txn_1759998314_323827000 txn.retry.attempt=0

ERROR: Failed to recover transaction txn.recover.forward.failed=txn_1759998314_323827000 error=transaction recovery failed after 4 attempts: failed to complete commit during recovery: staged file checksum validation failed for test_file.txt: file size mismatch: expected 34 bytes, got 30 bytes

ERROR: Checksum validation failed txn.checksum.validation.failed=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/var/txn/txn_1759998314_371765000/stage/recovery_test.txt txn.checksum.calculation.duration_ms=0ms error=size_mismatch expected_size=21 actual_size=26

WARN: Transaction recovery timeout/cancelled txn.id=txn_1759998314_371765000 txn.retry.attempt=0

ERROR: Failed to recover transaction txn.recover.forward.failed=txn_1759998314_371765000 error=transaction recovery failed after 4 attempts: failed to complete commit during recovery: staged file checksum validation failed for recovery_test.txt: file size mismatch: expected 21 bytes, got 26 bytes

INFO: Recovery complete txn.recover.forward.count=2 txn.recover.forward.success=0 txn.cleanup.success=0 txn.recover.duration_ms=0

=== RUN   TestChecksumMismatchRecoveryIntegration/ParallelChecksumValidationDuringRecovery
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/TestChecksumMismatchRecoveryIntegrationParallelChecksumValidationDuringRecovery4284796511/001/.deespec/var/txn/txn_1759998314_405205000/stage/parallel_test_A.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/TestChecksumMismatchRecoveryIntegrationParallelChecksumValidationDuringRecovery4284796511/001/.deespec/var/txn/txn_1759998314_439113000/stage/parallel_test_B.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/TestChecksumMismatchRecoveryIntegrationParallelChecksumValidationDuringRecovery4284796511/001/.deespec/var/txn/txn_1759998314_475288000/stage/parallel_test_C.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

[TXN-SCAN] 2025/10/09 17:25:14 WARN: Found transaction with intent but no commit txn.id=txn_1759998314_405205000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/09 17:25:14 WARN: Found transaction with intent but no commit txn.id=txn_1759998314_439113000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/09 17:25:14 WARN: Found transaction with intent but no commit txn.id=txn_1759998314_475288000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/09 17:25:14 SUMMARY: Transaction scan complete txn.scan.total=3 txn.scan.timestamp=2025-10-09T08:25:14Z
[TXN-SCAN] 2025/10/09 17:25:14   - Forward recovery needed txn.scan.intent_only_count=3 txn.scan.intent_only_ids=[txn_1759998314_405205000,txn_1759998314_439113000,txn_1759998314_475288000]
[TXN-SCAN] 2025/10/09 17:25:14 NOTE: Recovery disabled txn.scan.recovery_action=none txn.cleanup_policy=pending_step8
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/TestChecksumMismatchRecoveryIntegrationParallelChecksumValidationDuringRecovery4284796511/001/.deespec/var/txn/txn_1759998314_405205000/stage/parallel_test_A.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/TestChecksumMismatchRecoveryIntegrationParallelChecksumValidationDuringRecovery4284796511/001/.deespec/parallel_test_A.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1759998314_405205000

INFO: Recovered transaction txn.recover.forward.success=txn_1759998314_405205000

ERROR: Checksum validation failed txn.checksum.validation.failed=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/TestChecksumMismatchRecoveryIntegrationParallelChecksumValidationDuringRecovery4284796511/001/.deespec/var/txn/txn_1759998314_439113000/stage/parallel_test_B.txt txn.checksum.calculation.duration_ms=0ms error=size_mismatch expected_size=23 actual_size=26

WARN: Transaction recovery timeout/cancelled txn.id=txn_1759998314_439113000 txn.retry.attempt=0

ERROR: Failed to recover transaction txn.recover.forward.failed=txn_1759998314_439113000 error=transaction recovery failed after 4 attempts: failed to complete commit during recovery: staged file checksum validation failed for parallel_test_B.txt: file size mismatch: expected 23 bytes, got 26 bytes

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/TestChecksumMismatchRecoveryIntegrationParallelChecksumValidationDuringRecovery4284796511/001/.deespec/var/txn/txn_1759998314_475288000/stage/parallel_test_C.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/TestChecksumMismatchRecoveryIntegrationParallelChecksumValidationDuringRecovery4284796511/001/.deespec/parallel_test_C.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1759998314_475288000

INFO: Recovered transaction txn.recover.forward.success=txn_1759998314_475288000

INFO: Recovery complete txn.recover.forward.count=3 txn.recover.forward.success=2 txn.cleanup.success=0 txn.recover.duration_ms=48

=== RUN   TestChecksumMismatchRecoveryIntegration/LargeTransactionWorkerPoolValidation
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/var/txn/txn_1759998314_558685000/stage/worker_test_0.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/var/txn/txn_1759998314_558685000/stage/worker_test_1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/var/txn/txn_1759998314_558685000/stage/worker_test_2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/var/txn/txn_1759998314_558685000/stage/worker_test_3.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/var/txn/txn_1759998314_558685000/stage/worker_test_4.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/var/txn/txn_1759998314_558685000/stage/worker_test_5.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/var/txn/txn_1759998314_558685000/stage/worker_test_6.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/var/txn/txn_1759998314_558685000/stage/worker_test_7.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/var/txn/txn_1759998314_558685000/stage/worker_test_0.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/var/txn/txn_1759998314_558685000/stage/worker_test_1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/var/txn/txn_1759998314_558685000/stage/worker_test_2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/var/txn/txn_1759998314_558685000/stage/worker_test_3.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/var/txn/txn_1759998314_558685000/stage/worker_test_4.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/var/txn/txn_1759998314_558685000/stage/worker_test_5.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/var/txn/txn_1759998314_558685000/stage/worker_test_7.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/var/txn/txn_1759998314_558685000/stage/worker_test_6.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Using parallel checksum validation txn.checksum.parallel=true txn.files=8 txn.workers=4

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/var/txn/txn_1759998314_558685000/stage/worker_test_1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/var/txn/txn_1759998314_558685000/stage/worker_test_0.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/var/txn/txn_1759998314_558685000/stage/worker_test_4.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/var/txn/txn_1759998314_558685000/stage/worker_test_3.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/var/txn/txn_1759998314_558685000/stage/worker_test_2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/var/txn/txn_1759998314_558685000/stage/worker_test_5.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/var/txn/txn_1759998314_558685000/stage/worker_test_6.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/var/txn/txn_1759998314_558685000/stage/worker_test_7.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/worker_test_0.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/worker_test_1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/worker_test_2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/worker_test_3.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/worker_test_4.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/worker_test_5.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/worker_test_6.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_815763198/.deespec/worker_test_7.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1759998314_558685000

--- PASS: TestChecksumMismatchRecoveryIntegration (0.41s)
    --- PASS: TestChecksumMismatchRecoveryIntegration/ChecksumMismatchFailsGracefully (0.05s)
    --- PASS: TestChecksumMismatchRecoveryIntegration/RecoveryDetectsCorruptedTransaction (0.03s)
    --- PASS: TestChecksumMismatchRecoveryIntegration/ParallelChecksumValidationDuringRecovery (0.15s)
    --- PASS: TestChecksumMismatchRecoveryIntegration/LargeTransactionWorkerPoolValidation (0.17s)
=== RUN   TestChecksumCalculation
--- PASS: TestChecksumCalculation (0.00s)
=== RUN   TestChecksumValidation
--- PASS: TestChecksumValidation (0.00s)
=== RUN   TestFileChecksumValidation
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_test_1231515586/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

ERROR: Checksum validation failed txn.checksum.validation.failed=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_test_1231515586/test.txt txn.checksum.calculation.duration_ms=0ms error=size_mismatch expected_size=26 actual_size=21

--- PASS: TestFileChecksumValidation (0.00s)
=== RUN   TestTransactionChecksumIntegration
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_checksum_test_1058545787/.deespec/var/txn/txn_1759998314_733437000/stage/checksum_test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_checksum_test_1058545787/.deespec/var/txn/txn_1759998314_733437000/stage/checksum_test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_checksum_test_1058545787/.deespec/checksum_test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1759998314_733437000

--- PASS: TestTransactionChecksumIntegration (0.09s)
=== RUN   TestChecksumCorruptionDetection
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/corruption_test_2677555994/.deespec/var/txn/txn_1759998314_818705000/stage/corrupt_test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

ERROR: Checksum validation failed txn.checksum.validation.failed=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/corruption_test_2677555994/.deespec/var/txn/txn_1759998314_818705000/stage/corrupt_test.txt txn.checksum.calculation.duration_ms=0ms error=size_mismatch expected_size=25 actual_size=17

--- PASS: TestChecksumCorruptionDetection (0.06s)
=== RUN   TestUnsupportedChecksumAlgorithm
--- PASS: TestUnsupportedChecksumAlgorithm (0.00s)
=== RUN   TestCompareFileChecksums
--- PASS: TestCompareFileChecksums (0.00s)
=== RUN   TestMetricsRaceConditions
=== RUN   TestMetricsRaceConditions/ConcurrentIncrements
=== RUN   TestMetricsRaceConditions/ConcurrentReadWrite
=== RUN   TestMetricsRaceConditions/ConcurrentFileAccess
=== RUN   TestMetricsRaceConditions/ConcurrentSnapshotOperations
INFO: Metrics snapshot created path=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/metrics_race_test_2039664950/snapshots/metrics_20251009_082515_955462000.json

INFO: Metrics snapshot created path=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/metrics_race_test_2039664950/snapshots/metrics_20251009_082515_955543000.json

INFO: Metrics snapshot created path=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/metrics_race_test_2039664950/snapshots/metrics_20251009_082515_955775000.json

INFO: Metrics rotated and reset counters=false
INFO: Metrics snapshot created path=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/metrics_race_test_2039664950/snapshots/metrics_20251009_082515_955479000.json

INFO: Metrics snapshot created path=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/metrics_race_test_2039664950/snapshots/metrics_20251009_082515_955555000.json

INFO: Metrics snapshot created path=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/metrics_race_test_2039664950/snapshots/metrics_20251009_082515_956029000.json

INFO: Metrics rotated and reset counters=false
INFO: Metrics snapshot created path=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/metrics_race_test_2039664950/snapshots/metrics_20251009_082515_955963000.json

INFO: Metrics rotated and reset counters=false
INFO: Metrics snapshot created path=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/metrics_race_test_2039664950/snapshots/metrics_20251009_082515_955912000.json

INFO: Metrics rotated and reset counters=false
--- PASS: TestMetricsRaceConditions (1.07s)
    --- PASS: TestMetricsRaceConditions/ConcurrentIncrements (0.00s)
    --- PASS: TestMetricsRaceConditions/ConcurrentReadWrite (0.00s)
    --- PASS: TestMetricsRaceConditions/ConcurrentFileAccess (1.07s)
    --- PASS: TestMetricsRaceConditions/ConcurrentSnapshotOperations (0.00s)
=== RUN   TestMetricsDeadlockDetection
    metrics_race_test.go:282: Deadlock test completed successfully
--- PASS: TestMetricsDeadlockDetection (0.43s)
=== RUN   TestMultiProcessConcurrentMetrics
    multiprocess_e2e_test.go:108: Final metrics after 3 processes Ã— 20 operations:
    multiprocess_e2e_test.go:109:   CommitSuccess: 15
    multiprocess_e2e_test.go:110:   CommitFailed: 15
    multiprocess_e2e_test.go:111:   CASConflicts: 15
    multiprocess_e2e_test.go:112:   RecoveryCount: 15
    multiprocess_e2e_test.go:113:   SchemaVersion: 1
--- PASS: TestMultiProcessConcurrentMetrics (0.27s)
=== RUN   TestMultiProcessRegisterAndStateTransactions
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998316_662111000/stage/specs/process-0-txn-0/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998316_662114000/stage/specs/process-1-txn-0/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998316_662111000/stage/specs/process-0-txn-0/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998316_662114000/stage/specs/process-1-txn-0/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998316_662111000/stage/specs/process-0-txn-0/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998316_662111000/stage/specs/process-0-txn-0/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998316_662114000/stage/specs/process-1-txn-0/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998316_662114000/stage/specs/process-1-txn-0/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/specs/process-0-txn-0/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/specs/process-0-txn-0/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/specs/process-1-txn-0/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/specs/process-1-txn-0/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998316_822768000/stage/specs/process-0-txn-1/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998316_834718000/stage/specs/process-1-txn-1/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998316_822768000/stage/specs/process-0-txn-1/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998316_834718000/stage/specs/process-1-txn-1/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998316_822768000/stage/specs/process-0-txn-1/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998316_822768000/stage/specs/process-0-txn-1/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998316_834718000/stage/specs/process-1-txn-1/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/specs/process-0-txn-1/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998316_834718000/stage/specs/process-1-txn-1/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/specs/process-0-txn-1/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/specs/process-1-txn-1/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/specs/process-1-txn-1/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998316_975339000/stage/specs/process-0-txn-2/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998316_975339000/stage/specs/process-0-txn-2/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998316_988366000/stage/specs/process-1-txn-2/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998316_988366000/stage/specs/process-1-txn-2/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998316_975339000/stage/specs/process-0-txn-2/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998316_975339000/stage/specs/process-0-txn-2/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/specs/process-0-txn-2/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/specs/process-0-txn-2/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998316_988366000/stage/specs/process-1-txn-2/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998316_988366000/stage/specs/process-1-txn-2/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/specs/process-1-txn-2/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/specs/process-1-txn-2/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998317_123161000/stage/specs/process-0-txn-3/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998317_123161000/stage/specs/process-0-txn-3/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998317_141227000/stage/specs/process-1-txn-3/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998317_141227000/stage/specs/process-1-txn-3/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998317_123161000/stage/specs/process-0-txn-3/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998317_123161000/stage/specs/process-0-txn-3/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/specs/process-0-txn-3/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998317_141227000/stage/specs/process-1-txn-3/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998317_141227000/stage/specs/process-1-txn-3/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/specs/process-0-txn-3/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/specs/process-1-txn-3/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/specs/process-1-txn-3/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998317_277455000/stage/specs/process-0-txn-4/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=2ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998317_292773000/stage/specs/process-1-txn-4/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998317_277455000/stage/specs/process-0-txn-4/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998317_292773000/stage/specs/process-1-txn-4/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998317_277455000/stage/specs/process-0-txn-4/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998317_277455000/stage/specs/process-0-txn-4/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998317_292773000/stage/specs/process-1-txn-4/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/var/txn/txn_1759998317_292773000/stage/specs/process-1-txn-4/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/specs/process-0-txn-4/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/specs/process-1-txn-4/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/specs/process-0-txn-4/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_1820596126/.deespec/specs/process-1-txn-4/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

    multiprocess_e2e_test.go:248: Multi-process register/state-tx test completed:
    multiprocess_e2e_test.go:249:   Expected successes: 10
    multiprocess_e2e_test.go:250:   Actual successes: 55
    multiprocess_e2e_test.go:251:   Actual failures: 0
    multiprocess_e2e_test.go:274: Multi-process E2E test completed successfully
    multiprocess_e2e_test.go:275: File locking and metrics synchronization verified
--- PASS: TestMultiProcessRegisterAndStateTransactions (0.81s)
=== RUN   TestMultiProcessMetricsConsistency
    multiprocess_e2e_test.go:367: High-concurrency test results:
    multiprocess_e2e_test.go:368:   Processes: 5
    multiprocess_e2e_test.go:369:   Operations per process: 100
    multiprocess_e2e_test.go:370:   Minimum expected: 500
    multiprocess_e2e_test.go:371:   Actual final count: 500
    multiprocess_e2e_test.go:377: Multi-process consistency test passed - file locking prevented data corruption
--- PASS: TestMultiProcessMetricsConsistency (2.46s)
=== RUN   TestForwardRecovery
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_test_2053158627/.deespec/var/txn/txn_1759998319_936546000/stage/test1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_test_2053158627/.deespec/var/txn/txn_1759998319_936546000/stage/test2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

[TXN-SCAN] 2025/10/09 17:25:19 WARN: Found transaction with intent but no commit txn.id=txn_1759998319_936546000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/09 17:25:19 SUMMARY: Transaction scan complete txn.scan.total=1 txn.scan.timestamp=2025-10-09T08:25:19Z
[TXN-SCAN] 2025/10/09 17:25:19   - Forward recovery needed txn.scan.intent_only_count=1 txn.scan.intent_only_ids=[txn_1759998319_936546000]
[TXN-SCAN] 2025/10/09 17:25:19 NOTE: Recovery disabled txn.scan.recovery_action=none txn.cleanup_policy=pending_step8
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_test_2053158627/.deespec/var/txn/txn_1759998319_936546000/stage/test1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_test_2053158627/.deespec/var/txn/txn_1759998319_936546000/stage/test2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_test_2053158627/.deespec/test1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_test_2053158627/.deespec/test2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1759998319_936546000

INFO: Recovered transaction txn.recover.forward.success=txn_1759998319_936546000

INFO: Recovery complete txn.recover.forward.count=1 txn.recover.forward.success=1 txn.cleanup.success=0 txn.recover.duration_ms=24

--- PASS: TestForwardRecovery (0.09s)
=== RUN   TestIdempotentCommit
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/idempotent_test_2899483951/.deespec/var/txn/txn_1759998320_23748000/stage/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/idempotent_test_2899483951/.deespec/var/txn/txn_1759998320_23748000/stage/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/idempotent_test_2899483951/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1759998320_23748000

INFO: Transaction already committed (no-op) txn.commit.idempotent=true txn.id=txn_1759998320_23748000

--- PASS: TestIdempotentCommit (0.06s)
=== RUN   TestCleanupAfterCommit
[TXN-SCAN] 2025/10/09 17:25:20 INFO: Found completed transaction txn.id=txn_test_cleanup txn.state=committed txn.action=cleanup_ready
[TXN-SCAN] 2025/10/09 17:25:20 SUMMARY: Transaction scan complete txn.scan.total=1 txn.scan.timestamp=2025-10-09T08:25:20Z
[TXN-SCAN] 2025/10/09 17:25:20   - Ready for cleanup txn.scan.committed_count=1 txn.scan.committed_ids=[txn_test_cleanup]
[TXN-SCAN] 2025/10/09 17:25:20 NOTE: Recovery disabled txn.scan.recovery_action=none txn.cleanup_policy=pending_step8
INFO: Cleaned up transaction txn.cleanup.success=txn_test_cleanup

INFO: Recovery complete txn.recover.forward.count=0 txn.recover.forward.success=0 txn.cleanup.success=1 txn.recover.duration_ms=0

--- PASS: TestCleanupAfterCommit (0.00s)
=== RUN   TestEarlyEXDEVDetection
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/exdev_test_3332272228/.deespec/var/txn/txn_1759998320_89583000/stage/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=2ms

    recovery_test.go:214: Same filesystem - no EXDEV error (expected)
--- PASS: TestEarlyEXDEVDetection (0.03s)
=== RUN   TestE2ECrashRecoveryWithRetry
=== RUN   TestE2ECrashRecoveryWithRetry/MultipleTransactionCrashRecovery
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_830377700/.deespec/var/txn/txn_1759998320_123044000/stage/artifacts/fileA.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_830377700/.deespec/var/txn/txn_1759998320_158417000/stage/artifacts/fileB.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_830377700/.deespec/var/txn/txn_1759998320_197332000/stage/artifacts/fileC.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

[TXN-SCAN] 2025/10/09 17:25:20 WARN: Found transaction with intent but no commit txn.id=txn_1759998320_123044000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/09 17:25:20 WARN: Found transaction with intent but no commit txn.id=txn_1759998320_158417000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/09 17:25:20 WARN: Found transaction with intent but no commit txn.id=txn_1759998320_197332000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/09 17:25:20 SUMMARY: Transaction scan complete txn.scan.total=3 txn.scan.timestamp=2025-10-09T08:25:20Z
[TXN-SCAN] 2025/10/09 17:25:20   - Forward recovery needed txn.scan.intent_only_count=3 txn.scan.intent_only_ids=[txn_1759998320_123044000,txn_1759998320_158417000,txn_1759998320_197332000]
[TXN-SCAN] 2025/10/09 17:25:20 NOTE: Recovery disabled txn.scan.recovery_action=none txn.cleanup_policy=pending_step8
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_830377700/.deespec/var/txn/txn_1759998320_123044000/stage/artifacts/fileA.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_830377700/.deespec/artifacts/fileA.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=1ms

WARN: Forward recovery without journal callback for txn_1759998320_123044000

INFO: Recovered transaction txn.recover.forward.success=txn_1759998320_123044000

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_830377700/.deespec/var/txn/txn_1759998320_158417000/stage/artifacts/fileB.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_830377700/.deespec/artifacts/fileB.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1759998320_158417000

INFO: Recovered transaction txn.recover.forward.success=txn_1759998320_158417000

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_830377700/.deespec/var/txn/txn_1759998320_197332000/stage/artifacts/fileC.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_830377700/.deespec/artifacts/fileC.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=1ms

WARN: Forward recovery without journal callback for txn_1759998320_197332000

INFO: Recovered transaction txn.recover.forward.success=txn_1759998320_197332000

INFO: Recovery complete txn.recover.forward.count=3 txn.recover.forward.success=3 txn.cleanup.success=0 txn.recover.duration_ms=50

=== RUN   TestE2ECrashRecoveryWithRetry/RecoveryWithTimeout
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_830377700/.deespec/var/txn/txn_1759998320_290382000/stage/timeout_test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=8ms

[TXN-SCAN] 2025/10/09 17:25:20 INFO: Found completed transaction txn.id=txn_1759998320_123044000 txn.state=committed txn.action=cleanup_ready
[TXN-SCAN] 2025/10/09 17:25:20 INFO: Found completed transaction txn.id=txn_1759998320_158417000 txn.state=committed txn.action=cleanup_ready
[TXN-SCAN] 2025/10/09 17:25:20 INFO: Found completed transaction txn.id=txn_1759998320_197332000 txn.state=committed txn.action=cleanup_ready
[TXN-SCAN] 2025/10/09 17:25:20 WARN: Found transaction with intent but no commit txn.id=txn_1759998320_290382000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/09 17:25:20 SUMMARY: Transaction scan complete txn.scan.total=4 txn.scan.timestamp=2025-10-09T08:25:20Z
[TXN-SCAN] 2025/10/09 17:25:20   - Forward recovery needed txn.scan.intent_only_count=1 txn.scan.intent_only_ids=[txn_1759998320_290382000]
[TXN-SCAN] 2025/10/09 17:25:20   - Ready for cleanup txn.scan.committed_count=3 txn.scan.committed_ids=[txn_1759998320_123044000,txn_1759998320_158417000,txn_1759998320_197332000]
[TXN-SCAN] 2025/10/09 17:25:20 NOTE: Recovery disabled txn.scan.recovery_action=none txn.cleanup_policy=pending_step8
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_830377700/.deespec/var/txn/txn_1759998320_290382000/stage/timeout_test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_830377700/.deespec/timeout_test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1759998320_290382000

INFO: Recovered transaction txn.recover.forward.success=txn_1759998320_290382000

INFO: Cleaned up transaction txn.cleanup.success=txn_1759998320_123044000

INFO: Cleaned up transaction txn.cleanup.success=txn_1759998320_158417000

INFO: Cleaned up transaction txn.cleanup.success=txn_1759998320_197332000

INFO: Recovery complete txn.recover.forward.count=1 txn.recover.forward.success=1 txn.cleanup.success=3 txn.recover.duration_ms=26

    recovery_test.go:352: Recovery succeeded despite short timeout
=== RUN   TestE2ECrashRecoveryWithRetry/RecoveryWithCorruptedTransaction
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_830377700/.deespec/var/txn/txn_1759998320_404897000/stage/corrupted_test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

[TXN-SCAN] 2025/10/09 17:25:20 INFO: Found completed transaction txn.id=txn_1759998320_290382000 txn.state=committed txn.action=cleanup_ready
[TXN-SCAN] 2025/10/09 17:25:20 WARN: Found transaction with intent but no commit txn.id=txn_1759998320_404897000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/09 17:25:20 SUMMARY: Transaction scan complete txn.scan.total=2 txn.scan.timestamp=2025-10-09T08:25:20Z
[TXN-SCAN] 2025/10/09 17:25:20   - Forward recovery needed txn.scan.intent_only_count=1 txn.scan.intent_only_ids=[txn_1759998320_404897000]
[TXN-SCAN] 2025/10/09 17:25:20   - Ready for cleanup txn.scan.committed_count=1 txn.scan.committed_ids=[txn_1759998320_290382000]
[TXN-SCAN] 2025/10/09 17:25:20 NOTE: Recovery disabled txn.scan.recovery_action=none txn.cleanup_policy=pending_step8
WARN: Transaction recovery timeout/cancelled txn.id=txn_1759998320_404897000 txn.retry.attempt=0

ERROR: Failed to recover transaction txn.recover.forward.failed=txn_1759998320_404897000 error=transaction recovery failed after 4 attempts: failed to parse manifest: invalid character 'c' looking for beginning of value

INFO: Cleaned up transaction txn.cleanup.success=txn_1759998320_290382000

INFO: Recovery complete txn.recover.forward.count=1 txn.recover.forward.success=0 txn.cleanup.success=1 txn.recover.duration_ms=18

--- PASS: TestE2ECrashRecoveryWithRetry (0.34s)
    --- PASS: TestE2ECrashRecoveryWithRetry/MultipleTransactionCrashRecovery (0.17s)
    --- PASS: TestE2ECrashRecoveryWithRetry/RecoveryWithTimeout (0.11s)
    --- PASS: TestE2ECrashRecoveryWithRetry/RecoveryWithCorruptedTransaction (0.05s)
=== RUN   TestRecoveryMetrics
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_metrics_test_597419757/.deespec/var/txn/txn_1759998320_459635000/stage/metrics_test1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_metrics_test_597419757/.deespec/var/txn/txn_1759998320_504113000/stage/metrics_test2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_metrics_test_597419757/.deespec/var/txn/txn_1759998320_504113000/stage/metrics_test2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_metrics_test_597419757/.deespec/metrics_test2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1759998320_504113000

[TXN-SCAN] 2025/10/09 17:25:20 WARN: Found transaction with intent but no commit txn.id=txn_1759998320_459635000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/09 17:25:20 INFO: Found completed transaction txn.id=txn_1759998320_504113000 txn.state=committed txn.action=cleanup_ready
[TXN-SCAN] 2025/10/09 17:25:20 SUMMARY: Transaction scan complete txn.scan.total=2 txn.scan.timestamp=2025-10-09T08:25:20Z
[TXN-SCAN] 2025/10/09 17:25:20   - Forward recovery needed txn.scan.intent_only_count=1 txn.scan.intent_only_ids=[txn_1759998320_459635000]
[TXN-SCAN] 2025/10/09 17:25:20   - Ready for cleanup txn.scan.committed_count=1 txn.scan.committed_ids=[txn_1759998320_504113000]
[TXN-SCAN] 2025/10/09 17:25:20 NOTE: Recovery disabled txn.scan.recovery_action=none txn.cleanup_policy=pending_step8
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_metrics_test_597419757/.deespec/var/txn/txn_1759998320_459635000/stage/metrics_test1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_metrics_test_597419757/.deespec/metrics_test1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1759998320_459635000

INFO: Recovered transaction txn.recover.forward.success=txn_1759998320_459635000

INFO: Cleaned up transaction txn.cleanup.success=txn_1759998320_504113000

INFO: Recovery complete txn.recover.forward.count=1 txn.recover.forward.success=1 txn.cleanup.success=1 txn.recover.duration_ms=20

--- PASS: TestRecoveryMetrics (0.13s)
=== RUN   TestRollbackBasic
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/rollback_test_86262105/.deespec/var/txn/txn_1759998320_587002000/stage/test_file.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Rolling back transaction txn.register.rollback.count=txn_1759998320_587002000 reason=test rollback

INFO: Transaction rollback completed txn.rollback.success=txn_1759998320_587002000 undo_performed=false duration_ms=4ms

--- PASS: TestRollbackBasic (0.05s)
=== RUN   TestRollbackWithUndo
INFO: Rolling back transaction txn.register.rollback.count=txn_1759998320_633705000 reason=test undo rollback

INFO: Transaction rollback completed txn.rollback.success=txn_1759998320_633705000 undo_performed=true duration_ms=8ms

--- PASS: TestRollbackWithUndo (0.02s)
=== RUN   TestRollbackCommittedTransaction
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/rollback_committed_test_1101799071/.deespec/var/txn/txn_1759998320_655897000/stage/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/rollback_committed_test_1101799071/.deespec/var/txn/txn_1759998320_655897000/stage/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/rollback_committed_test_1101799071/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1759998320_655897000

INFO: Rolling back transaction txn.register.rollback.count=txn_1759998320_655897000 reason=should fail

ERROR: Cannot rollback committed transaction txn.rollback.failed=txn_1759998320_655897000

--- PASS: TestRollbackCommittedTransaction (0.05s)
=== RUN   TestRollbackMetrics
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/rollback_metrics_test_1494431815/.deespec/var/txn/txn_1759998320_705998000/stage/metrics_test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Rolling back transaction txn.register.rollback.count=txn_1759998320_705998000 reason=metrics test

INFO: Transaction rollback completed txn.rollback.success=txn_1759998320_705998000 undo_performed=false duration_ms=5ms

--- PASS: TestRollbackMetrics (0.03s)
=== RUN   TestNewScanner
--- PASS: TestNewScanner (0.00s)
=== RUN   TestScanNoDirectory
[TXN-SCAN] 2025/10/09 17:25:20 INFO: No transaction directory found txn.base_dir=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/TestScanNoDirectory3119071339/001/non-existent txn.state=clean txn.count=0
--- PASS: TestScanNoDirectory (0.00s)
=== RUN   TestScanWithTransactions
[TXN-SCAN] 2025/10/09 17:25:20 WARN: Found abandoned transaction txn.id=txn_abandoned txn.state=abandoned txn.markers=none
[TXN-SCAN] 2025/10/09 17:25:20 INFO: Found completed transaction txn.id=txn_committed txn.state=committed txn.action=cleanup_ready
[TXN-SCAN] 2025/10/09 17:25:20 WARN: Found incomplete transaction txn.id=txn_incomplete txn.state=incomplete txn.staging=partial
[TXN-SCAN] 2025/10/09 17:25:20 WARN: Found transaction with intent but no commit txn.id=txn_intent_only txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/09 17:25:20 SUMMARY: Transaction scan complete txn.scan.total=4 txn.scan.timestamp=2025-10-09T08:25:20Z
[TXN-SCAN] 2025/10/09 17:25:20   - Forward recovery needed txn.scan.intent_only_count=1 txn.scan.intent_only_ids=[txn_intent_only]
[TXN-SCAN] 2025/10/09 17:25:20   - Incomplete transactions txn.scan.incomplete_count=1 txn.scan.incomplete_ids=[txn_incomplete]
[TXN-SCAN] 2025/10/09 17:25:20   - Abandoned transactions txn.scan.abandoned_count=1 txn.scan.abandoned_ids=[txn_abandoned]
[TXN-SCAN] 2025/10/09 17:25:20   - Ready for cleanup txn.scan.committed_count=1 txn.scan.committed_ids=[txn_committed]
[TXN-SCAN] 2025/10/09 17:25:20 NOTE: Recovery disabled txn.scan.recovery_action=none txn.cleanup_policy=pending_step8
--- PASS: TestScanWithTransactions (0.00s)
=== RUN   TestCheckTransactionState
=== RUN   TestCheckTransactionState/committed
=== RUN   TestCheckTransactionState/intent_only
=== RUN   TestCheckTransactionState/incomplete_with_manifest
=== RUN   TestCheckTransactionState/incomplete_with_stage
=== RUN   TestCheckTransactionState/abandoned
--- PASS: TestCheckTransactionState (0.00s)
    --- PASS: TestCheckTransactionState/committed (0.00s)
    --- PASS: TestCheckTransactionState/intent_only (0.00s)
    --- PASS: TestCheckTransactionState/incomplete_with_manifest (0.00s)
    --- PASS: TestCheckTransactionState/incomplete_with_stage (0.00s)
    --- PASS: TestCheckTransactionState/abandoned (0.00s)
=== RUN   TestFormatTxnIDs
=== RUN   TestFormatTxnIDs/empty
=== RUN   TestFormatTxnIDs/single
=== RUN   TestFormatTxnIDs/three
=== RUN   TestFormatTxnIDs/many
--- PASS: TestFormatTxnIDs (0.00s)
    --- PASS: TestFormatTxnIDs/empty (0.00s)
    --- PASS: TestFormatTxnIDs/single (0.00s)
    --- PASS: TestFormatTxnIDs/three (0.00s)
    --- PASS: TestFormatTxnIDs/many (0.00s)
=== RUN   TestScanWithErrors
[TXN-SCAN] 2025/10/09 17:25:20 WARN: Found abandoned transaction txn.id=good_txn txn.state=abandoned txn.markers=none
[TXN-SCAN] 2025/10/09 17:25:20 SUMMARY: Transaction scan complete txn.scan.total=1 txn.scan.timestamp=2025-10-09T08:25:20Z
[TXN-SCAN] 2025/10/09 17:25:20   - Abandoned transactions txn.scan.abandoned_count=1 txn.scan.abandoned_ids=[good_txn]
[TXN-SCAN] 2025/10/09 17:25:20 NOTE: Recovery disabled txn.scan.recovery_action=none txn.cleanup_policy=pending_step8
--- PASS: TestScanWithErrors (0.00s)
=== RUN   TestTransactionLifecycle
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_test_1577876240/.deespec/var/txn/txn_1759998320_747781000/stage/test/file.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_test_1577876240/.deespec/var/txn/txn_1759998320_747781000/stage/test/file.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_test_1577876240/test/file.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

--- PASS: TestTransactionLifecycle (0.06s)
=== RUN   TestTransactionStateValidation
=== RUN   TestTransactionStateValidation/Cannot_commit_without_intent
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_validation_2779730657/.deespec/var/txn/txn_1759998320_805680000/stage/dummy.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

=== RUN   TestTransactionStateValidation/Cannot_stage_after_intent
=== RUN   TestTransactionStateValidation/Cannot_mark_intent_twice
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_validation_2779730657/.deespec/var/txn/txn_1759998320_805680000/stage/dummy.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_validation_2779730657/dummy.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1759998320_805680000

=== RUN   TestTransactionStateValidation/Idempotent_commit
INFO: Transaction already committed (no-op) txn.commit.idempotent=true txn.id=txn_1759998320_805680000

=== RUN   TestTransactionStateValidation/Cannot_cleanup_uncommitted_transaction
--- PASS: TestTransactionStateValidation (0.06s)
    --- PASS: TestTransactionStateValidation/Cannot_commit_without_intent (0.00s)
    --- PASS: TestTransactionStateValidation/Cannot_stage_after_intent (0.00s)
    --- PASS: TestTransactionStateValidation/Cannot_mark_intent_twice (0.00s)
    --- PASS: TestTransactionStateValidation/Idempotent_commit (0.00s)
    --- PASS: TestTransactionStateValidation/Cannot_cleanup_uncommitted_transaction (0.01s)
=== RUN   TestMultipleFileStaging
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_multi_2466950064/.deespec/var/txn/txn_1759998320_866107000/stage/dir2/file3.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_multi_2466950064/.deespec/var/txn/txn_1759998320_866107000/stage/dir1/file1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_multi_2466950064/.deespec/var/txn/txn_1759998320_866107000/stage/dir1/file2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_multi_2466950064/.deespec/var/txn/txn_1759998320_866107000/stage/dir2/file3.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_multi_2466950064/.deespec/var/txn/txn_1759998320_866107000/stage/dir1/file1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_multi_2466950064/.deespec/var/txn/txn_1759998320_866107000/stage/dir1/file2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_multi_2466950064/dir2/file3.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_multi_2466950064/dir1/file1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_multi_2466950064/dir1/file2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1759998320_866107000

--- PASS: TestMultipleFileStaging (0.10s)
=== RUN   TestManifestValidation
--- PASS: TestManifestValidation (0.01s)
=== RUN   TestIntentMarkerFormat
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_format_3964538789/.deespec/var/txn/txn_1759998320_977747000/stage/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

--- PASS: TestIntentMarkerFormat (0.03s)
=== RUN   TestCommitMarkerFormat
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_commit_1481046523/.deespec/var/txn/txn_1759998321_12533000/stage/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_commit_1481046523/.deespec/var/txn/txn_1759998321_12533000/stage/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_commit_1481046523/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1759998321_12533000

--- PASS: TestCommitMarkerFormat (0.05s)
=== RUN   TestTxnStatus
--- PASS: TestTxnStatus (0.00s)
=== RUN   TestStatusIsValid
=== RUN   TestStatusIsValid/Valid_PENDING
=== RUN   TestStatusIsValid/Valid_INTENT
=== RUN   TestStatusIsValid/Valid_COMMIT
=== RUN   TestStatusIsValid/Valid_ABORTED
=== RUN   TestStatusIsValid/Valid_FAILED
=== RUN   TestStatusIsValid/Invalid_empty
=== RUN   TestStatusIsValid/Invalid_unknown
=== RUN   TestStatusIsValid/Invalid_lowercase
--- PASS: TestStatusIsValid (0.00s)
    --- PASS: TestStatusIsValid/Valid_PENDING (0.00s)
    --- PASS: TestStatusIsValid/Valid_INTENT (0.00s)
    --- PASS: TestStatusIsValid/Valid_COMMIT (0.00s)
    --- PASS: TestStatusIsValid/Valid_ABORTED (0.00s)
    --- PASS: TestStatusIsValid/Valid_FAILED (0.00s)
    --- PASS: TestStatusIsValid/Invalid_empty (0.00s)
    --- PASS: TestStatusIsValid/Invalid_unknown (0.00s)
    --- PASS: TestStatusIsValid/Invalid_lowercase (0.00s)
=== RUN   TestStatusUnmarshalJSON
=== RUN   TestStatusUnmarshalJSON/Valid_PENDING
=== RUN   TestStatusUnmarshalJSON/Valid_INTENT
=== RUN   TestStatusUnmarshalJSON/Valid_COMMIT
=== RUN   TestStatusUnmarshalJSON/Valid_ABORTED
=== RUN   TestStatusUnmarshalJSON/Valid_FAILED
=== RUN   TestStatusUnmarshalJSON/Invalid_unknown
=== RUN   TestStatusUnmarshalJSON/Invalid_lowercase
=== RUN   TestStatusUnmarshalJSON/Invalid_format
=== RUN   TestStatusUnmarshalJSON/Invalid_empty
--- PASS: TestStatusUnmarshalJSON (0.00s)
    --- PASS: TestStatusUnmarshalJSON/Valid_PENDING (0.00s)
    --- PASS: TestStatusUnmarshalJSON/Valid_INTENT (0.00s)
    --- PASS: TestStatusUnmarshalJSON/Valid_COMMIT (0.00s)
    --- PASS: TestStatusUnmarshalJSON/Valid_ABORTED (0.00s)
    --- PASS: TestStatusUnmarshalJSON/Valid_FAILED (0.00s)
    --- PASS: TestStatusUnmarshalJSON/Invalid_unknown (0.00s)
    --- PASS: TestStatusUnmarshalJSON/Invalid_lowercase (0.00s)
    --- PASS: TestStatusUnmarshalJSON/Invalid_format (0.00s)
    --- PASS: TestStatusUnmarshalJSON/Invalid_empty (0.00s)
=== RUN   TestFileOperation
--- PASS: TestFileOperation (0.00s)
=== RUN   TestFileOperationValidate
=== RUN   TestFileOperationValidate/Valid_create_operation
=== RUN   TestFileOperationValidate/Valid_rename_operation
=== RUN   TestFileOperationValidate/Missing_type
=== RUN   TestFileOperationValidate/Invalid_type
=== RUN   TestFileOperationValidate/Missing_destination
=== RUN   TestFileOperationValidate/Rename_missing_source
--- PASS: TestFileOperationValidate (0.00s)
    --- PASS: TestFileOperationValidate/Valid_create_operation (0.00s)
    --- PASS: TestFileOperationValidate/Valid_rename_operation (0.00s)
    --- PASS: TestFileOperationValidate/Missing_type (0.00s)
    --- PASS: TestFileOperationValidate/Invalid_type (0.00s)
    --- PASS: TestFileOperationValidate/Missing_destination (0.00s)
    --- PASS: TestFileOperationValidate/Rename_missing_source (0.00s)
=== RUN   TestManifest
--- PASS: TestManifest (0.00s)
=== RUN   TestManifestValidate
=== RUN   TestManifestValidate/Valid_manifest
=== RUN   TestManifestValidate/Missing_ID
=== RUN   TestManifestValidate/No_file_operations
=== RUN   TestManifestValidate/Invalid_file_operation
=== RUN   TestManifestValidate/Zero_timestamp
--- PASS: TestManifestValidate (0.00s)
    --- PASS: TestManifestValidate/Valid_manifest (0.00s)
    --- PASS: TestManifestValidate/Missing_ID (0.00s)
    --- PASS: TestManifestValidate/No_file_operations (0.00s)
    --- PASS: TestManifestValidate/Invalid_file_operation (0.00s)
    --- PASS: TestManifestValidate/Zero_timestamp (0.00s)
=== RUN   TestIntent
--- PASS: TestIntent (0.00s)
=== RUN   TestCommit
--- PASS: TestCommit (0.00s)
=== RUN   TestTransaction
--- PASS: TestTransaction (0.00s)
=== RUN   TestRecoveryInfo
--- PASS: TestRecoveryInfo (0.00s)
=== RUN   TestTxnError
--- PASS: TestTxnError (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/infra/fs/txn	7.531s
=== RUN   TestWriteFileAtomic
=== RUN   TestWriteFileAtomic/Write_new_file_successfully
=== RUN   TestWriteFileAtomic/Overwrite_existing_file
=== RUN   TestWriteFileAtomic/Write_to_deeply_nested_directory
=== RUN   TestWriteFileAtomic/Write_empty_file
--- PASS: TestWriteFileAtomic (0.00s)
    --- PASS: TestWriteFileAtomic/Write_new_file_successfully (0.00s)
    --- PASS: TestWriteFileAtomic/Overwrite_existing_file (0.00s)
    --- PASS: TestWriteFileAtomic/Write_to_deeply_nested_directory (0.00s)
    --- PASS: TestWriteFileAtomic/Write_empty_file (0.00s)
=== RUN   TestWriteFileAtomic_RenameFailure
--- PASS: TestWriteFileAtomic_RenameFailure (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/infra/persistence/file	(cached)
=== RUN   TestContainer_LockServiceIntegration
--- PASS: TestContainer_LockServiceIntegration (0.26s)
=== RUN   TestContainer_LockServiceCleanup
--- PASS: TestContainer_LockServiceCleanup (1.04s)
=== RUN   TestContainer_DefaultConfiguration
--- PASS: TestContainer_DefaultConfiguration (0.02s)
=== RUN   TestContainer_CloseStopsLockService
--- PASS: TestContainer_CloseStopsLockService (0.00s)
=== RUN   TestContainer_MultipleLocksSimultaneously
--- PASS: TestContainer_MultipleLocksSimultaneously (0.05s)
=== RUN   TestContainer_LockConflict
--- PASS: TestContainer_LockConflict (0.03s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/infrastructure/di	(cached)
=== RUN   TestRunLockRepository_AcquireAndRelease
--- PASS: TestRunLockRepository_AcquireAndRelease (0.00s)
=== RUN   TestRunLockRepository_Find
--- PASS: TestRunLockRepository_Find (0.00s)
=== RUN   TestRunLockRepository_Find_NotFound
--- PASS: TestRunLockRepository_Find_NotFound (0.00s)
=== RUN   TestRunLockRepository_UpdateHeartbeat
--- PASS: TestRunLockRepository_UpdateHeartbeat (1.00s)
=== RUN   TestRunLockRepository_Extend
--- PASS: TestRunLockRepository_Extend (0.00s)
=== RUN   TestRunLockRepository_CleanupExpired
--- PASS: TestRunLockRepository_CleanupExpired (2.00s)
=== RUN   TestRunLockRepository_List
--- PASS: TestRunLockRepository_List (0.00s)
=== RUN   TestRunLockRepository_AcquireExpiredLock
--- PASS: TestRunLockRepository_AcquireExpiredLock (2.01s)
=== RUN   TestStateLockRepository_AcquireAndRelease
--- PASS: TestStateLockRepository_AcquireAndRelease (0.00s)
=== RUN   TestStateLockRepository_Find
--- PASS: TestStateLockRepository_Find (0.00s)
=== RUN   TestStateLockRepository_Find_NotFound
--- PASS: TestStateLockRepository_Find_NotFound (0.00s)
=== RUN   TestStateLockRepository_UpdateHeartbeat
--- PASS: TestStateLockRepository_UpdateHeartbeat (1.00s)
=== RUN   TestStateLockRepository_Extend
--- PASS: TestStateLockRepository_Extend (0.00s)
=== RUN   TestStateLockRepository_CleanupExpired
--- PASS: TestStateLockRepository_CleanupExpired (2.02s)
=== RUN   TestStateLockRepository_List
--- PASS: TestStateLockRepository_List (0.01s)
=== RUN   TestStateLockRepository_AcquireExpiredLock
--- PASS: TestStateLockRepository_AcquireExpiredLock (2.02s)
=== RUN   TestStateLockRepository_ReadWriteLockTypes
--- PASS: TestStateLockRepository_ReadWriteLockTypes (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/infrastructure/persistence/sqlite	10.642s
=== RUN   TestExecuteRegisterTransaction
INFO: Checksum validation successful txn.checksum.validation.success=.deespec/var/txn/txn_1759998314_738612000/stage/specs/test-001_test_specification/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=.deespec/var/txn/txn_1759998314_738612000/stage/specs/test-001_test_specification/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=.deespec/var/txn/txn_1759998314_738612000/stage/specs/test-001_test_specification/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=.deespec/var/txn/txn_1759998314_738612000/stage/specs/test-001_test_specification/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=.deespec/specs/test-001_test_specification/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=.deespec/specs/test-001_test_specification/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

--- PASS: TestExecuteRegisterTransaction (0.14s)
=== RUN   TestExecuteRegisterTransactionFailure
--- PASS: TestExecuteRegisterTransactionFailure (0.00s)
=== RUN   TestExecuteRegisterTransactionEmptySpecPath
--- PASS: TestExecuteRegisterTransactionEmptySpecPath (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/infrastructure/transaction	0.879s
=== RUN   TestStreamEvent_JSON
--- PASS: TestStreamEvent_JSON (0.00s)
=== RUN   TestStreamContext_HistoryPath
--- PASS: TestStreamContext_HistoryPath (0.00s)
=== RUN   TestRunWithStream_CreatesHistoryDir
--- PASS: TestRunWithStream_CreatesHistoryDir (0.01s)
=== RUN   TestPackageLeaks
--- PASS: TestPackageLeaks (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/interface/external/claudecli	0.787s
=== RUN   TestComputeSpecPath
=== RUN   TestComputeSpecPath/basic_path_construction
=== RUN   TestComputeSpecPath/special_characters_in_title
=== RUN   TestComputeSpecPath/unicode_normalization
=== RUN   TestComputeSpecPath/consecutive_hyphens
=== RUN   TestComputeSpecPath/empty_title_becomes_untitled
=== RUN   TestComputeSpecPath/reserved_name_handling
=== RUN   TestComputeSpecPath/length_limit_applied
=== RUN   TestComputeSpecPath/custom_base_directory
=== RUN   TestComputeSpecPath/missing_ID
=== RUN   TestComputeSpecPath/missing_title
--- PASS: TestComputeSpecPath (0.00s)
    --- PASS: TestComputeSpecPath/basic_path_construction (0.00s)
    --- PASS: TestComputeSpecPath/special_characters_in_title (0.00s)
    --- PASS: TestComputeSpecPath/unicode_normalization (0.00s)
    --- PASS: TestComputeSpecPath/consecutive_hyphens (0.00s)
    --- PASS: TestComputeSpecPath/empty_title_becomes_untitled (0.00s)
    --- PASS: TestComputeSpecPath/reserved_name_handling (0.00s)
    --- PASS: TestComputeSpecPath/length_limit_applied (0.00s)
    --- PASS: TestComputeSpecPath/custom_base_directory (0.00s)
    --- PASS: TestComputeSpecPath/missing_ID (0.00s)
    --- PASS: TestComputeSpecPath/missing_title (0.00s)
=== RUN   TestSlugifyTitle
=== RUN   TestSlugifyTitle/basic_alphanumeric
=== RUN   TestSlugifyTitle/uppercase_to_lowercase
=== RUN   TestSlugifyTitle/special_characters_replaced
=== RUN   TestSlugifyTitle/leading_and_trailing_hyphens_trimmed
=== RUN   TestSlugifyTitle/unicode_normalized
=== RUN   TestSlugifyTitle/japanese_becomes_hyphens
=== RUN   TestSlugifyTitle/mixed_content
=== RUN   TestSlugifyTitle/windows_reserved_name_with_suffix
=== RUN   TestSlugifyTitle/trailing_dots_and_spaces_removed
=== RUN   TestSlugifyTitle/fallback_when_empty
=== RUN   TestSlugifyTitle/max_runes_limit
--- PASS: TestSlugifyTitle (0.00s)
    --- PASS: TestSlugifyTitle/basic_alphanumeric (0.00s)
    --- PASS: TestSlugifyTitle/uppercase_to_lowercase (0.00s)
    --- PASS: TestSlugifyTitle/special_characters_replaced (0.00s)
    --- PASS: TestSlugifyTitle/leading_and_trailing_hyphens_trimmed (0.00s)
    --- PASS: TestSlugifyTitle/unicode_normalized (0.00s)
    --- PASS: TestSlugifyTitle/japanese_becomes_hyphens (0.00s)
    --- PASS: TestSlugifyTitle/mixed_content (0.00s)
    --- PASS: TestSlugifyTitle/windows_reserved_name_with_suffix (0.00s)
    --- PASS: TestSlugifyTitle/trailing_dots_and_spaces_removed (0.00s)
    --- PASS: TestSlugifyTitle/fallback_when_empty (0.00s)
    --- PASS: TestSlugifyTitle/max_runes_limit (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/pkg/specpath	0.993s
=== RUN   TestReadPromptWithLimit
=== RUN   TestReadPromptWithLimit/file_within_limit
=== RUN   TestReadPromptWithLimit/file_at_exact_limit
=== RUN   TestReadPromptWithLimit/file_over_limit
=== RUN   TestReadPromptWithLimit/large_file_with_higher_limit
=== RUN   TestReadPromptWithLimit/small_file_with_small_limit
=== RUN   TestReadPromptWithLimit/2KB_file_with_1KB_limit
--- PASS: TestReadPromptWithLimit (0.01s)
    --- PASS: TestReadPromptWithLimit/file_within_limit (0.01s)
    --- PASS: TestReadPromptWithLimit/file_at_exact_limit (0.00s)
    --- PASS: TestReadPromptWithLimit/file_over_limit (0.00s)
    --- PASS: TestReadPromptWithLimit/large_file_with_higher_limit (0.00s)
    --- PASS: TestReadPromptWithLimit/small_file_with_small_limit (0.00s)
    --- PASS: TestReadPromptWithLimit/2KB_file_with_1KB_limit (0.00s)
=== RUN   TestReadPromptWithLimit_FileNotFound
--- PASS: TestReadPromptWithLimit_FileNotFound (0.00s)
=== RUN   TestReadPromptWithLimit_ErrorMessage
--- PASS: TestReadPromptWithLimit_ErrorMessage (0.01s)
=== RUN   TestParseDecision
=== RUN   TestParseDecision/OK_decision_at_end
=== RUN   TestParseDecision/NEEDS_CHANGES_decision_at_end
=== RUN   TestParseDecision/decision_in_middle,_last_one_wins
=== RUN   TestParseDecision/no_match_returns_pending
=== RUN   TestParseDecision/custom_regex_pattern_OK
=== RUN   TestParseDecision/custom_regex_pattern_NEEDS_CHANGES
=== RUN   TestParseDecision/whitespace_handling
=== RUN   TestParseDecision/nil_regex_returns_pending
=== RUN   TestParseDecision/empty_output
=== RUN   TestParseDecision/multiline_with_decision_at_end
--- PASS: TestParseDecision (0.00s)
    --- PASS: TestParseDecision/OK_decision_at_end (0.00s)
    --- PASS: TestParseDecision/NEEDS_CHANGES_decision_at_end (0.00s)
    --- PASS: TestParseDecision/decision_in_middle,_last_one_wins (0.00s)
    --- PASS: TestParseDecision/no_match_returns_pending (0.00s)
    --- PASS: TestParseDecision/custom_regex_pattern_OK (0.00s)
    --- PASS: TestParseDecision/custom_regex_pattern_NEEDS_CHANGES (0.00s)
    --- PASS: TestParseDecision/whitespace_handling (0.00s)
    --- PASS: TestParseDecision/nil_regex_returns_pending (0.00s)
    --- PASS: TestParseDecision/empty_output (0.00s)
    --- PASS: TestParseDecision/multiline_with_decision_at_end (0.00s)
=== RUN   TestExtractDecisionLine
=== RUN   TestExtractDecisionLine/extract_OK_line
=== RUN   TestExtractDecisionLine/extract_NEEDS_CHANGES_line
=== RUN   TestExtractDecisionLine/no_match
=== RUN   TestExtractDecisionLine/nil_regex
=== RUN   TestExtractDecisionLine/extract_last_matching_line
--- PASS: TestExtractDecisionLine (0.00s)
    --- PASS: TestExtractDecisionLine/extract_OK_line (0.00s)
    --- PASS: TestExtractDecisionLine/extract_NEEDS_CHANGES_line (0.00s)
    --- PASS: TestExtractDecisionLine/no_match (0.00s)
    --- PASS: TestExtractDecisionLine/nil_regex (0.00s)
    --- PASS: TestExtractDecisionLine/extract_last_matching_line (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/runner	1.209s
=== RUN   Test_NoAbsolutePathsInTests
--- PASS: Test_NoAbsolutePathsInTests (0.15s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/testutil	1.517s
=== RUN   TestNormalizeCRLFToLF
=== RUN   TestNormalizeCRLFToLF/CRLF_to_LF
=== RUN   TestNormalizeCRLFToLF/LF_unchanged
=== RUN   TestNormalizeCRLFToLF/mixed_CRLF_and_LF
=== RUN   TestNormalizeCRLFToLF/empty
--- PASS: TestNormalizeCRLFToLF (0.00s)
    --- PASS: TestNormalizeCRLFToLF/CRLF_to_LF (0.00s)
    --- PASS: TestNormalizeCRLFToLF/LF_unchanged (0.00s)
    --- PASS: TestNormalizeCRLFToLF/mixed_CRLF_and_LF (0.00s)
    --- PASS: TestNormalizeCRLFToLF/empty (0.00s)
=== RUN   TestWriteFileAtomic
=== RUN   TestWriteFileAtomic/happy_path
=== RUN   TestWriteFileAtomic/adds_trailing_newline
=== RUN   TestWriteFileAtomic/preserves_existing_newline
=== RUN   TestWriteFileAtomic/creates_directory_if_needed
=== RUN   TestWriteFileAtomic/overwrites_existing_file
=== RUN   TestWriteFileAtomic/normalizes_CRLF_to_LF
=== RUN   TestWriteFileAtomic/cleans_up_temp_file_on_failure
--- PASS: TestWriteFileAtomic (0.04s)
    --- PASS: TestWriteFileAtomic/happy_path (0.01s)
    --- PASS: TestWriteFileAtomic/adds_trailing_newline (0.00s)
    --- PASS: TestWriteFileAtomic/preserves_existing_newline (0.01s)
    --- PASS: TestWriteFileAtomic/creates_directory_if_needed (0.00s)
    --- PASS: TestWriteFileAtomic/overwrites_existing_file (0.01s)
    --- PASS: TestWriteFileAtomic/normalizes_CRLF_to_LF (0.01s)
    --- PASS: TestWriteFileAtomic/cleans_up_temp_file_on_failure (0.01s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/util	1.598s
=== RUN   TestLoadAgents
=== RUN   TestLoadAgents/file_not_exists_-_use_builtin
=== RUN   TestLoadAgents/valid_agents.yaml
=== RUN   TestLoadAgents/empty_agents_array
=== RUN   TestLoadAgents/duplicate_agents
=== RUN   TestLoadAgents/invalid_agent_name
=== RUN   TestLoadAgents/unknown_fields
=== RUN   TestLoadAgents/invalid_YAML
=== RUN   TestLoadAgents/empty_agent_name
--- PASS: TestLoadAgents (0.04s)
    --- PASS: TestLoadAgents/file_not_exists_-_use_builtin (0.00s)
    --- PASS: TestLoadAgents/valid_agents.yaml (0.01s)
    --- PASS: TestLoadAgents/empty_agents_array (0.00s)
    --- PASS: TestLoadAgents/duplicate_agents (0.00s)
    --- PASS: TestLoadAgents/invalid_agent_name (0.01s)
    --- PASS: TestLoadAgents/unknown_fields (0.01s)
    --- PASS: TestLoadAgents/invalid_YAML (0.00s)
    --- PASS: TestLoadAgents/empty_agent_name (0.01s)
=== RUN   TestValidateAgents
=== RUN   TestValidateAgents/valid_agents
=== RUN   TestValidateAgents/empty_array
=== RUN   TestValidateAgents/duplicate_agents
=== RUN   TestValidateAgents/invalid_characters
=== RUN   TestValidateAgents/empty_string
--- PASS: TestValidateAgents (0.00s)
    --- PASS: TestValidateAgents/valid_agents (0.00s)
    --- PASS: TestValidateAgents/empty_array (0.00s)
    --- PASS: TestValidateAgents/duplicate_agents (0.00s)
    --- PASS: TestValidateAgents/invalid_characters (0.00s)
    --- PASS: TestValidateAgents/empty_string (0.00s)
=== RUN   TestToMap
--- PASS: TestToMap (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/validator/agents	1.707s
=== RUN   TestValidateHealthFile
=== RUN   TestValidateHealthFile/valid_health.json
=== RUN   TestValidateHealthFile/missing_required_key
=== RUN   TestValidateHealthFile/invalid_timestamp_format
=== RUN   TestValidateHealthFile/negative_turn
=== RUN   TestValidateHealthFile/invalid_step
=== RUN   TestValidateHealthFile/invalid_ok_type
=== RUN   TestValidateHealthFile/invalid_error_type
=== RUN   TestValidateHealthFile/ok/error_consistency_warning_-_ok=true_with_error
=== RUN   TestValidateHealthFile/ok/error_consistency_warning_-_ok=false_without_error
=== RUN   TestValidateHealthFile/valid_ok=false_with_error
=== RUN   TestValidateHealthFile/multiple_errors
--- PASS: TestValidateHealthFile (0.07s)
    --- PASS: TestValidateHealthFile/valid_health.json (0.01s)
    --- PASS: TestValidateHealthFile/missing_required_key (0.00s)
    --- PASS: TestValidateHealthFile/invalid_timestamp_format (0.01s)
    --- PASS: TestValidateHealthFile/negative_turn (0.00s)
    --- PASS: TestValidateHealthFile/invalid_step (0.01s)
    --- PASS: TestValidateHealthFile/invalid_ok_type (0.01s)
    --- PASS: TestValidateHealthFile/invalid_error_type (0.01s)
    --- PASS: TestValidateHealthFile/ok/error_consistency_warning_-_ok=true_with_error (0.01s)
    --- PASS: TestValidateHealthFile/ok/error_consistency_warning_-_ok=false_without_error (0.01s)
    --- PASS: TestValidateHealthFile/valid_ok=false_with_error (0.01s)
    --- PASS: TestValidateHealthFile/multiple_errors (0.01s)
=== RUN   TestValidateHealthFile_NotFound
--- PASS: TestValidateHealthFile_NotFound (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/validator/health	1.392s
=== RUN   TestIntegratedValidation
--- PASS: TestIntegratedValidation (0.02s)
=== RUN   TestIntegratedValidationWithErrors
--- PASS: TestIntegratedValidationWithErrors (0.01s)
=== RUN   TestComponentStatus
--- PASS: TestComponentStatus (0.00s)
=== RUN   TestJSONMarshal
--- PASS: TestJSONMarshal (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/validator/integrated	1.287s
=== RUN   TestJournalValidation
=== RUN   TestJournalValidation/valid_journal_entry
=== RUN   TestJournalValidation/missing_required_key
=== RUN   TestJournalValidation/extra_key
=== RUN   TestJournalValidation/invalid_timestamp_(not_UTC)
=== RUN   TestJournalValidation/invalid_timestamp_format
=== RUN   TestJournalValidation/negative_turn
=== RUN   TestJournalValidation/invalid_step
=== RUN   TestJournalValidation/invalid_decision
=== RUN   TestJournalValidation/negative_elapsed_ms
=== RUN   TestJournalValidation/artifact_turn_inconsistency
=== RUN   TestJournalValidation/turn_monotonicity_warning
=== RUN   TestJournalValidation/empty_lines_ignored
=== RUN   TestJournalValidation/invalid_JSON
=== RUN   TestJournalValidation/mixed_artifact_types_(valid)
=== RUN   TestJournalValidation/artifact_with_wrong_type
--- PASS: TestJournalValidation (0.00s)
    --- PASS: TestJournalValidation/valid_journal_entry (0.00s)
    --- PASS: TestJournalValidation/missing_required_key (0.00s)
    --- PASS: TestJournalValidation/extra_key (0.00s)
    --- PASS: TestJournalValidation/invalid_timestamp_(not_UTC) (0.00s)
    --- PASS: TestJournalValidation/invalid_timestamp_format (0.00s)
    --- PASS: TestJournalValidation/negative_turn (0.00s)
    --- PASS: TestJournalValidation/invalid_step (0.00s)
    --- PASS: TestJournalValidation/invalid_decision (0.00s)
    --- PASS: TestJournalValidation/negative_elapsed_ms (0.00s)
    --- PASS: TestJournalValidation/artifact_turn_inconsistency (0.00s)
    --- PASS: TestJournalValidation/turn_monotonicity_warning (0.00s)
    --- PASS: TestJournalValidation/empty_lines_ignored (0.00s)
    --- PASS: TestJournalValidation/invalid_JSON (0.00s)
    --- PASS: TestJournalValidation/mixed_artifact_types_(valid) (0.00s)
    --- PASS: TestJournalValidation/artifact_with_wrong_type (0.00s)
=== RUN   TestValidTimestampFormats
=== RUN   TestValidTimestampFormats/valid_2025-09-26T00:12:34Z
=== RUN   TestValidTimestampFormats/valid_2025-09-26T00:12:34.1Z
=== RUN   TestValidTimestampFormats/valid_2025-09-26T00:12:34.12Z
=== RUN   TestValidTimestampFormats/valid_2025-09-26T00:12:34.123Z
=== RUN   TestValidTimestampFormats/valid_2025-09-26T00:12:34.1234Z
=== RUN   TestValidTimestampFormats/valid_2025-09-26T00:12:34.12345Z
=== RUN   TestValidTimestampFormats/valid_2025-09-26T00:12:34.123456Z
=== RUN   TestValidTimestampFormats/valid_2025-09-26T00:12:34.1234567Z
=== RUN   TestValidTimestampFormats/valid_2025-09-26T00:12:34.12345678Z
=== RUN   TestValidTimestampFormats/valid_2025-09-26T00:12:34.123456789Z
--- PASS: TestValidTimestampFormats (0.00s)
    --- PASS: TestValidTimestampFormats/valid_2025-09-26T00:12:34Z (0.00s)
    --- PASS: TestValidTimestampFormats/valid_2025-09-26T00:12:34.1Z (0.00s)
    --- PASS: TestValidTimestampFormats/valid_2025-09-26T00:12:34.12Z (0.00s)
    --- PASS: TestValidTimestampFormats/valid_2025-09-26T00:12:34.123Z (0.00s)
    --- PASS: TestValidTimestampFormats/valid_2025-09-26T00:12:34.1234Z (0.00s)
    --- PASS: TestValidTimestampFormats/valid_2025-09-26T00:12:34.12345Z (0.00s)
    --- PASS: TestValidTimestampFormats/valid_2025-09-26T00:12:34.123456Z (0.00s)
    --- PASS: TestValidTimestampFormats/valid_2025-09-26T00:12:34.1234567Z (0.00s)
    --- PASS: TestValidTimestampFormats/valid_2025-09-26T00:12:34.12345678Z (0.00s)
    --- PASS: TestValidTimestampFormats/valid_2025-09-26T00:12:34.123456789Z (0.00s)
=== RUN   TestInvalidTimestampFormats
=== RUN   TestInvalidTimestampFormats/invalid_2025-09-26T00:12:34.123456789+09:00
=== RUN   TestInvalidTimestampFormats/invalid_2025-09-26T00:12:34.123456789
=== RUN   TestInvalidTimestampFormats/invalid_2025-09-26_00:12:34Z
=== RUN   TestInvalidTimestampFormats/invalid_2025-09-26
=== RUN   TestInvalidTimestampFormats/invalid_00:12:34Z
=== RUN   TestInvalidTimestampFormats/invalid_invalid
=== RUN   TestInvalidTimestampFormats/invalid_
--- PASS: TestInvalidTimestampFormats (0.00s)
    --- PASS: TestInvalidTimestampFormats/invalid_2025-09-26T00:12:34.123456789+09:00 (0.00s)
    --- PASS: TestInvalidTimestampFormats/invalid_2025-09-26T00:12:34.123456789 (0.00s)
    --- PASS: TestInvalidTimestampFormats/invalid_2025-09-26_00:12:34Z (0.00s)
    --- PASS: TestInvalidTimestampFormats/invalid_2025-09-26 (0.00s)
    --- PASS: TestInvalidTimestampFormats/invalid_00:12:34Z (0.00s)
    --- PASS: TestInvalidTimestampFormats/invalid_invalid (0.00s)
    --- PASS: TestInvalidTimestampFormats/invalid_ (0.00s)
=== RUN   TestJournalSummaryConsistency
--- PASS: TestJournalSummaryConsistency (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/validator/journal	1.576s
=== RUN   TestValidateStateFile
=== RUN   TestValidateStateFile/valid_state.json
=== RUN   TestValidateStateFile/missing_required_key
=== RUN   TestValidateStateFile/forbidden_key_present
=== RUN   TestValidateStateFile/invalid_version
=== RUN   TestValidateStateFile/invalid_step
=== RUN   TestValidateStateFile/negative_turn
=== RUN   TestValidateStateFile/invalid_timestamp_format
=== RUN   TestValidateStateFile/invalid_JSON
=== RUN   TestValidateStateFile/type_mismatch_-_version_string
=== RUN   TestValidateStateFile/type_mismatch_-_meta.updated_at_number
--- PASS: TestValidateStateFile (0.10s)
    --- PASS: TestValidateStateFile/valid_state.json (0.01s)
    --- PASS: TestValidateStateFile/missing_required_key (0.01s)
    --- PASS: TestValidateStateFile/forbidden_key_present (0.01s)
    --- PASS: TestValidateStateFile/invalid_version (0.01s)
    --- PASS: TestValidateStateFile/invalid_step (0.01s)
    --- PASS: TestValidateStateFile/negative_turn (0.00s)
    --- PASS: TestValidateStateFile/invalid_timestamp_format (0.00s)
    --- PASS: TestValidateStateFile/invalid_JSON (0.01s)
    --- PASS: TestValidateStateFile/type_mismatch_-_version_string (0.01s)
    --- PASS: TestValidateStateFile/type_mismatch_-_meta.updated_at_number (0.02s)
=== RUN   TestValidateStateFile_NotFound
--- PASS: TestValidateStateFile_NotFound (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/validator/state	1.745s
=== RUN   TestValidator
=== RUN   TestValidator/valid_workflow
=== RUN   TestValidator/unknown_fields
=== RUN   TestValidator/duplicate_ids
=== RUN   TestValidator/unknown_agent
=== RUN   TestValidator/absolute_path
=== RUN   TestValidator/parent_directory_reference
=== RUN   TestValidator/missing_required_fields
=== RUN   TestValidator/empty_steps
=== RUN   TestValidator/invalid_constraints
=== RUN   TestValidator/valid_constraints
=== RUN   TestValidator/nonexistent_file
--- PASS: TestValidator (0.03s)
    --- PASS: TestValidator/valid_workflow (0.00s)
    --- PASS: TestValidator/unknown_fields (0.00s)
    --- PASS: TestValidator/duplicate_ids (0.00s)
    --- PASS: TestValidator/unknown_agent (0.00s)
    --- PASS: TestValidator/absolute_path (0.00s)
    --- PASS: TestValidator/parent_directory_reference (0.00s)
    --- PASS: TestValidator/missing_required_fields (0.00s)
    --- PASS: TestValidator/empty_steps (0.00s)
    --- PASS: TestValidator/invalid_constraints (0.00s)
    --- PASS: TestValidator/valid_constraints (0.00s)
    --- PASS: TestValidator/nonexistent_file (0.00s)
=== RUN   TestSymlinkValidation
    validator_test.go:210: Skipping symlink test - manual verification recommended
--- SKIP: TestSymlinkValidation (0.00s)
=== RUN   TestAgentsSourceBuiltin
--- PASS: TestAgentsSourceBuiltin (0.01s)
=== RUN   TestAgentsSourceFile
--- PASS: TestAgentsSourceFile (0.00s)
=== RUN   TestJSONOutput
--- PASS: TestJSONOutput (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/validator/workflow	1.513s
=== RUN   TestConstraintsNormalization
=== RUN   TestConstraintsNormalization/no_constraints_uses_default
=== RUN   TestConstraintsNormalization/valid_constraint_value
=== RUN   TestConstraintsNormalization/zero_falls_back_to_default
=== RUN   TestConstraintsNormalization/negative_falls_back_to_default
=== RUN   TestConstraintsNormalization/over_limit_falls_back_to_default
=== RUN   TestConstraintsNormalization/boundary_value_1
=== RUN   TestConstraintsNormalization/boundary_value_512
=== RUN   TestConstraintsNormalization/boundary_value_513_falls_back
--- PASS: TestConstraintsNormalization (0.03s)
    --- PASS: TestConstraintsNormalization/no_constraints_uses_default (0.00s)
    --- PASS: TestConstraintsNormalization/valid_constraint_value (0.00s)
    --- PASS: TestConstraintsNormalization/zero_falls_back_to_default (0.01s)
    --- PASS: TestConstraintsNormalization/negative_falls_back_to_default (0.00s)
    --- PASS: TestConstraintsNormalization/over_limit_falls_back_to_default (0.00s)
    --- PASS: TestConstraintsNormalization/boundary_value_1 (0.01s)
    --- PASS: TestConstraintsNormalization/boundary_value_512 (0.01s)
    --- PASS: TestConstraintsNormalization/boundary_value_513_falls_back (0.00s)
=== RUN   TestLoadWorkflow
=== RUN   TestLoadWorkflow/minimal_valid_workflow
=== RUN   TestLoadWorkflow/review_step_with_decision_regex
=== RUN   TestLoadWorkflow/missing_name
=== RUN   TestLoadWorkflow/missing_steps
=== RUN   TestLoadWorkflow/empty_steps_array
=== RUN   TestLoadWorkflow/missing_step_id
=== RUN   TestLoadWorkflow/missing_agent
=== RUN   TestLoadWorkflow/missing_prompt_path
=== RUN   TestLoadWorkflow/deprecated_prompt_field
=== RUN   TestLoadWorkflow/unsupported_agent
=== RUN   TestLoadWorkflow/bash_agent_not_supported
=== RUN   TestLoadWorkflow/duplicate_step_id
=== RUN   TestLoadWorkflow/empty_name
=== RUN   TestLoadWorkflow/empty_step_id
=== RUN   TestLoadWorkflow/empty_agent
=== RUN   TestLoadWorkflow/empty_prompt_path
=== RUN   TestLoadWorkflow/multiple_steps_valid
=== RUN   TestLoadWorkflow/absolute_path_not_allowed
=== RUN   TestLoadWorkflow/parent_directory_reference_not_allowed
=== RUN   TestLoadWorkflow/parent_directory_in_middle_not_allowed
=== RUN   TestLoadWorkflow/unknown_field_in_workflow
=== RUN   TestLoadWorkflow/unknown_field_in_step
=== RUN   TestLoadWorkflow/workflow_with_vars_field_is_valid
=== RUN   TestLoadWorkflow/decision_on_review_step_with_default_regex
=== RUN   TestLoadWorkflow/decision_on_review_step_with_custom_regex
=== RUN   TestLoadWorkflow/decision_on_non-review_step_is_not_allowed
=== RUN   TestLoadWorkflow/invalid_regex_in_decision
=== RUN   TestLoadWorkflow/constraints_with_default_max_prompt_kb
=== RUN   TestLoadWorkflow/constraints_with_valid_max_prompt_kb
=== RUN   TestLoadWorkflow/constraints_with_zero_max_prompt_kb_falls_back_to_default
=== RUN   TestLoadWorkflow/constraints_with_negative_max_prompt_kb_falls_back_to_default
=== RUN   TestLoadWorkflow/constraints_with_too_large_max_prompt_kb_falls_back_to_default
--- PASS: TestLoadWorkflow (0.14s)
    --- PASS: TestLoadWorkflow/minimal_valid_workflow (0.00s)
    --- PASS: TestLoadWorkflow/review_step_with_decision_regex (0.00s)
    --- PASS: TestLoadWorkflow/missing_name (0.00s)
    --- PASS: TestLoadWorkflow/missing_steps (0.00s)
    --- PASS: TestLoadWorkflow/empty_steps_array (0.00s)
    --- PASS: TestLoadWorkflow/missing_step_id (0.00s)
    --- PASS: TestLoadWorkflow/missing_agent (0.00s)
    --- PASS: TestLoadWorkflow/missing_prompt_path (0.00s)
    --- PASS: TestLoadWorkflow/deprecated_prompt_field (0.00s)
    --- PASS: TestLoadWorkflow/unsupported_agent (0.00s)
    --- PASS: TestLoadWorkflow/bash_agent_not_supported (0.00s)
    --- PASS: TestLoadWorkflow/duplicate_step_id (0.00s)
    --- PASS: TestLoadWorkflow/empty_name (0.00s)
    --- PASS: TestLoadWorkflow/empty_step_id (0.00s)
    --- PASS: TestLoadWorkflow/empty_agent (0.00s)
    --- PASS: TestLoadWorkflow/empty_prompt_path (0.00s)
    --- PASS: TestLoadWorkflow/multiple_steps_valid (0.01s)
    --- PASS: TestLoadWorkflow/absolute_path_not_allowed (0.00s)
    --- PASS: TestLoadWorkflow/parent_directory_reference_not_allowed (0.00s)
    --- PASS: TestLoadWorkflow/parent_directory_in_middle_not_allowed (0.00s)
    --- PASS: TestLoadWorkflow/unknown_field_in_workflow (0.00s)
    --- PASS: TestLoadWorkflow/unknown_field_in_step (0.00s)
    --- PASS: TestLoadWorkflow/workflow_with_vars_field_is_valid (0.00s)
    --- PASS: TestLoadWorkflow/decision_on_review_step_with_default_regex (0.00s)
    --- PASS: TestLoadWorkflow/decision_on_review_step_with_custom_regex (0.01s)
    --- PASS: TestLoadWorkflow/decision_on_non-review_step_is_not_allowed (0.00s)
    --- PASS: TestLoadWorkflow/invalid_regex_in_decision (0.00s)
    --- PASS: TestLoadWorkflow/constraints_with_default_max_prompt_kb (0.00s)
    --- PASS: TestLoadWorkflow/constraints_with_valid_max_prompt_kb (0.01s)
    --- PASS: TestLoadWorkflow/constraints_with_zero_max_prompt_kb_falls_back_to_default (0.00s)
    --- PASS: TestLoadWorkflow/constraints_with_negative_max_prompt_kb_falls_back_to_default (0.00s)
    --- PASS: TestLoadWorkflow/constraints_with_too_large_max_prompt_kb_falls_back_to_default (0.01s)
=== RUN   TestResolvePromptPath
=== RUN   TestResolvePromptPath/simple_relative_path_resolution
=== RUN   TestResolvePromptPath/multiple_paths_resolution
--- PASS: TestResolvePromptPath (0.01s)
    --- PASS: TestResolvePromptPath/simple_relative_path_resolution (0.00s)
    --- PASS: TestResolvePromptPath/multiple_paths_resolution (0.00s)
=== RUN   TestCheckDeprecatedPromptField
=== RUN   TestCheckDeprecatedPromptField/no_prompt_field
=== RUN   TestCheckDeprecatedPromptField/has_prompt_field_in_first_step
=== RUN   TestCheckDeprecatedPromptField/has_prompt_field_in_second_step
=== RUN   TestCheckDeprecatedPromptField/empty_yaml
=== RUN   TestCheckDeprecatedPromptField/no_steps
--- PASS: TestCheckDeprecatedPromptField (0.00s)
    --- PASS: TestCheckDeprecatedPromptField/no_prompt_field (0.00s)
    --- PASS: TestCheckDeprecatedPromptField/has_prompt_field_in_first_step (0.00s)
    --- PASS: TestCheckDeprecatedPromptField/has_prompt_field_in_second_step (0.00s)
    --- PASS: TestCheckDeprecatedPromptField/empty_yaml (0.00s)
    --- PASS: TestCheckDeprecatedPromptField/no_steps (0.00s)
=== RUN   TestValidatePlaceholders
=== RUN   TestValidatePlaceholders/all_allowed_placeholders
=== RUN   TestValidatePlaceholders/unknown_placeholder
=== RUN   TestValidatePlaceholders/escaped_placeholder_ignored
=== RUN   TestValidatePlaceholders/multiple_unknown
=== RUN   TestValidatePlaceholders/duplicate_placeholders_counted_once
=== RUN   TestValidatePlaceholders/no_placeholders
=== RUN   TestValidatePlaceholders/mixed_valid_and_invalid_names
--- PASS: TestValidatePlaceholders (0.00s)
    --- PASS: TestValidatePlaceholders/all_allowed_placeholders (0.00s)
    --- PASS: TestValidatePlaceholders/unknown_placeholder (0.00s)
    --- PASS: TestValidatePlaceholders/escaped_placeholder_ignored (0.00s)
    --- PASS: TestValidatePlaceholders/multiple_unknown (0.00s)
    --- PASS: TestValidatePlaceholders/duplicate_placeholders_counted_once (0.00s)
    --- PASS: TestValidatePlaceholders/no_placeholders (0.00s)
    --- PASS: TestValidatePlaceholders/mixed_valid_and_invalid_names (0.00s)
=== RUN   TestExpandPrompt
=== RUN   TestExpandPrompt/successful_expansion
=== RUN   TestExpandPrompt/unknown_placeholder_error
=== RUN   TestExpandPrompt/escaped_braces_preserved
=== RUN   TestExpandPrompt/empty_values_allowed
=== RUN   TestExpandPrompt/multiple_same_placeholder
=== RUN   TestExpandPrompt/no_placeholders
=== RUN   TestExpandPrompt/multiline_text
--- PASS: TestExpandPrompt (0.00s)
    --- PASS: TestExpandPrompt/successful_expansion (0.00s)
    --- PASS: TestExpandPrompt/unknown_placeholder_error (0.00s)
    --- PASS: TestExpandPrompt/escaped_braces_preserved (0.00s)
    --- PASS: TestExpandPrompt/empty_values_allowed (0.00s)
    --- PASS: TestExpandPrompt/multiple_same_placeholder (0.00s)
    --- PASS: TestExpandPrompt/no_placeholders (0.00s)
    --- PASS: TestExpandPrompt/multiline_text (0.00s)
=== RUN   TestBuildVarMap
=== RUN   TestBuildVarMap/defaults_only
=== RUN   TestBuildVarMap/workflow_vars_override_defaults
=== RUN   TestBuildVarMap/nil_state_handled
--- PASS: TestBuildVarMap (0.00s)
    --- PASS: TestBuildVarMap/defaults_only (0.00s)
    --- PASS: TestBuildVarMap/workflow_vars_override_defaults (0.00s)
    --- PASS: TestBuildVarMap/nil_state_handled (0.00s)
PASS
ok  	github.com/YoshitsuguKoike/deespec/internal/workflow	1.545s
FAIL
