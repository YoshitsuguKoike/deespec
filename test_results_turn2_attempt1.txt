go test -v -race -coverprofile=coverage.txt -covermode=atomic -p 1 ./...
	github.com/YoshitsuguKoike/deespec/cmd/deespec		coverage: 0.0% of statements
	github.com/YoshitsuguKoike/deespec/internal/adapter/controller/cli		coverage: 0.0% of statements
=== RUN   TestGeminiMockGateway
--- PASS: TestGeminiMockGateway (0.10s)
=== RUN   TestCodexMockGateway
--- PASS: TestCodexMockGateway (0.15s)
=== RUN   TestClaudeCodeGateway
    agent_gateway_test.go:96: Skipping Claude Code test: ANTHROPIC_API_KEY not set
--- SKIP: TestClaudeCodeGateway (0.00s)
=== RUN   TestNewAgentGateway
=== RUN   TestNewAgentGateway/gemini-cli
=== RUN   TestNewAgentGateway/codex
=== RUN   TestNewAgentGateway/unknown_agent
=== RUN   TestNewAgentGateway/claude-code_without_API_key
=== RUN   TestNewAgentGateway/claude-code_with_API_key
--- PASS: TestNewAgentGateway (0.00s)
    --- PASS: TestNewAgentGateway/gemini-cli (0.00s)
    --- PASS: TestNewAgentGateway/codex (0.00s)
    --- PASS: TestNewAgentGateway/unknown_agent (0.00s)
    --- PASS: TestNewAgentGateway/claude-code_without_API_key (0.00s)
    --- PASS: TestNewAgentGateway/claude-code_with_API_key (0.00s)
PASS
coverage: 25.3% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/adapter/gateway/agent	1.554s	coverage: 25.3% of statements
=== RUN   TestLocalStorageGateway_SaveAndLoadArtifact
--- PASS: TestLocalStorageGateway_SaveAndLoadArtifact (0.00s)
=== RUN   TestLocalStorageGateway_ListArtifacts
--- PASS: TestLocalStorageGateway_ListArtifacts (0.01s)
=== RUN   TestLocalStorageGateway_ListArtifacts_EmptyTask
--- PASS: TestLocalStorageGateway_ListArtifacts_EmptyTask (0.00s)
=== RUN   TestLocalStorageGateway_LoadInstruction_AbsolutePath
--- PASS: TestLocalStorageGateway_LoadInstruction_AbsolutePath (0.00s)
=== RUN   TestLocalStorageGateway_LoadInstruction_RelativePath
--- PASS: TestLocalStorageGateway_LoadInstruction_RelativePath (0.00s)
=== RUN   TestLocalStorageGateway_DeleteArtifact
--- PASS: TestLocalStorageGateway_DeleteArtifact (0.00s)
=== RUN   TestLocalStorageGateway_EnsureInstructionFile
--- PASS: TestLocalStorageGateway_EnsureInstructionFile (0.00s)
=== RUN   TestLocalStorageGateway_CopyFile
--- PASS: TestLocalStorageGateway_CopyFile (0.00s)
=== RUN   TestLocalStorageGateway_GetStoragePath
--- PASS: TestLocalStorageGateway_GetStoragePath (0.00s)
=== RUN   TestS3StorageGateway_SaveAndLoadArtifact
--- PASS: TestS3StorageGateway_SaveAndLoadArtifact (0.00s)
=== RUN   TestS3StorageGateway_LoadArtifact_NotFound
--- PASS: TestS3StorageGateway_LoadArtifact_NotFound (0.00s)
=== RUN   TestS3StorageGateway_ListArtifacts
--- PASS: TestS3StorageGateway_ListArtifacts (0.00s)
=== RUN   TestS3StorageGateway_ListArtifacts_EmptyTask
--- PASS: TestS3StorageGateway_ListArtifacts_EmptyTask (0.00s)
=== RUN   TestS3StorageGateway_LoadInstruction
--- PASS: TestS3StorageGateway_LoadInstruction (0.00s)
=== RUN   TestS3StorageGateway_DeleteArtifact
--- PASS: TestS3StorageGateway_DeleteArtifact (0.00s)
=== RUN   TestS3StorageGateway_MultipleTasks
--- PASS: TestS3StorageGateway_MultipleTasks (0.00s)
=== RUN   TestS3StorageGateway_ArtifactMetadata
--- PASS: TestS3StorageGateway_ArtifactMetadata (0.00s)
=== RUN   TestS3StorageGateway_BuildKey
--- PASS: TestS3StorageGateway_BuildKey (0.00s)
=== RUN   TestMockStorageGateway_SaveAndLoad
--- PASS: TestMockStorageGateway_SaveAndLoad (0.00s)
=== RUN   TestMockStorageGateway_LoadInstruction
--- PASS: TestMockStorageGateway_LoadInstruction (0.00s)
=== RUN   TestMockStorageGateway_ListArtifacts
--- PASS: TestMockStorageGateway_ListArtifacts (0.00s)
=== RUN   TestMockStorageGateway_LoadArtifact_NotFound
--- PASS: TestMockStorageGateway_LoadArtifact_NotFound (0.00s)
=== RUN   TestMockStorageGateway_Clear
--- PASS: TestMockStorageGateway_Clear (0.00s)
PASS
coverage: 80.7% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/adapter/gateway/storage	1.399s	coverage: 80.7% of statements
=== RUN   TestCLITaskPresenter_PresentSuccess
=== RUN   TestCLITaskPresenter_PresentSuccess/present_SBI
=== RUN   TestCLITaskPresenter_PresentSuccess/present_task_list
--- PASS: TestCLITaskPresenter_PresentSuccess (0.00s)
    --- PASS: TestCLITaskPresenter_PresentSuccess/present_SBI (0.00s)
    --- PASS: TestCLITaskPresenter_PresentSuccess/present_task_list (0.00s)
=== RUN   TestCLITaskPresenter_PresentError
--- PASS: TestCLITaskPresenter_PresentError (0.00s)
=== RUN   TestCLITaskPresenter_PresentProgress
--- PASS: TestCLITaskPresenter_PresentProgress (0.00s)
=== RUN   TestJSONPresenter_PresentSuccess
--- PASS: TestJSONPresenter_PresentSuccess (0.00s)
=== RUN   TestJSONPresenter_PresentError
--- PASS: TestJSONPresenter_PresentError (0.00s)
=== RUN   TestJSONPresenter_PresentProgress
--- PASS: TestJSONPresenter_PresentProgress (0.00s)
PASS
coverage: 33.1% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/adapter/presenter	1.343s	coverage: 33.1% of statements
=== RUN   TestNormalizeJournalEntry_FillsDefaults
--- PASS: TestNormalizeJournalEntry_FillsDefaults (0.00s)
=== RUN   TestNormalizeJournalEntry_PreservesExistingValues
--- PASS: TestNormalizeJournalEntry_PreservesExistingValues (0.00s)
=== RUN   TestNormalizeJournalEntryMap_FillsMissingKeys
--- PASS: TestNormalizeJournalEntryMap_FillsMissingKeys (0.00s)
=== RUN   TestNormalizeJournalEntryMap_PreservesExistingValues
--- PASS: TestNormalizeJournalEntryMap_PreservesExistingValues (0.00s)
=== RUN   TestNormalizeJournalEntryMap_HandlesStringArtifacts
--- PASS: TestNormalizeJournalEntryMap_HandlesStringArtifacts (0.00s)
=== RUN   TestJournalWriter_Append
--- PASS: TestJournalWriter_Append (0.01s)
=== RUN   TestJournalWriter_QuickAppend
--- PASS: TestJournalWriter_QuickAppend (0.02s)
=== RUN   TestJournalWriter_ValidationWarning
--- PASS: TestJournalWriter_ValidationWarning (0.02s)
=== RUN   TestJournalWriterAppend
--- PASS: TestJournalWriterAppend (0.01s)
=== RUN   TestJournalWriterMultipleAppends
--- PASS: TestJournalWriterMultipleAppends (0.09s)
=== RUN   TestJournalWriterConcurrentAppends
--- PASS: TestJournalWriterConcurrentAppends (0.01s)
=== RUN   TestJournalWriterNormalization
--- PASS: TestJournalWriterNormalization (0.01s)
PASS
coverage: 34.9% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/app	1.623s	coverage: 34.9% of statements
	github.com/YoshitsuguKoike/deespec/internal/app/config		coverage: 0.0% of statements
	github.com/YoshitsuguKoike/deespec/internal/app/health		coverage: 0.0% of statements
=== RUN   TestLoadState
=== RUN   TestLoadState/minimal_valid_state
=== RUN   TestLoadState/state_with_defaults
=== RUN   TestLoadState/legacy_current_field
2025/10/11 00:53:47 INFO: Migrating 'current' field to 'step' in state.json
=== RUN   TestLoadState/invalid_step_value
2025/10/11 00:53:47 WARN: Invalid step value 'foo' in state.json (expected: plan, implement, test, review, or done)
=== RUN   TestLoadState/both_step_and_current_(step_wins)
--- PASS: TestLoadState (0.05s)
    --- PASS: TestLoadState/minimal_valid_state (0.02s)
    --- PASS: TestLoadState/state_with_defaults (0.00s)
    --- PASS: TestLoadState/legacy_current_field (0.02s)
    --- PASS: TestLoadState/invalid_step_value (0.00s)
    --- PASS: TestLoadState/both_step_and_current_(step_wins) (0.01s)
=== RUN   TestSaveStateAtomic
--- PASS: TestSaveStateAtomic (0.01s)
=== RUN   TestSaveStateAtomicOverwrite
--- PASS: TestSaveStateAtomicOverwrite (0.00s)
PASS
coverage: 83.3% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/app/state	1.659s	coverage: 83.3% of statements
	github.com/YoshitsuguKoike/deespec/internal/application/dto		coverage: 0.0% of statements
?   	github.com/YoshitsuguKoike/deespec/internal/application/port/input	[no test files]
testing: warning: no tests to run
PASS
coverage: [no statements]
ok  	github.com/YoshitsuguKoike/deespec/internal/application/port/output	1.221s	coverage: [no statements] [no tests to run]
=== RUN   TestNewAgentPool
--- PASS: TestNewAgentPool (0.00s)
=== RUN   TestNewAgentPoolWithConfig
--- PASS: TestNewAgentPoolWithConfig (0.00s)
=== RUN   TestAgentPool_TryAcquire_Success
--- PASS: TestAgentPool_TryAcquire_Success (0.00s)
=== RUN   TestAgentPool_TryAcquire_Failure
--- PASS: TestAgentPool_TryAcquire_Failure (0.00s)
=== RUN   TestAgentPool_Release
--- PASS: TestAgentPool_Release (0.00s)
=== RUN   TestAgentPool_Release_WhenZero
--- PASS: TestAgentPool_Release_WhenZero (0.00s)
=== RUN   TestAgentPool_UnknownAgent_DefaultLimit
--- PASS: TestAgentPool_UnknownAgent_DefaultLimit (0.00s)
=== RUN   TestAgentPool_SetLimit
--- PASS: TestAgentPool_SetLimit (0.00s)
=== RUN   TestAgentPool_SetLimit_InvalidValue
--- PASS: TestAgentPool_SetLimit_InvalidValue (0.00s)
=== RUN   TestAgentPool_GetStats
--- PASS: TestAgentPool_GetStats (0.00s)
=== RUN   TestAgentPool_Reset
--- PASS: TestAgentPool_Reset (0.00s)
=== RUN   TestAgentPool_ConcurrentAccess
    agent_pool_test.go:241: Max concurrent: 8 out of 20 goroutines
--- PASS: TestAgentPool_ConcurrentAccess (0.00s)
=== RUN   TestAgentPool_MultipleAgents
--- PASS: TestAgentPool_MultipleAgents (0.00s)
=== RUN   TestAgentStats_IsAvailable
=== RUN   TestAgentStats_IsAvailable/Empty
=== RUN   TestAgentStats_IsAvailable/Partial
=== RUN   TestAgentStats_IsAvailable/Full
=== RUN   TestAgentStats_IsAvailable/Single_slot_available
=== RUN   TestAgentStats_IsAvailable/Single_slot_full
--- PASS: TestAgentStats_IsAvailable (0.00s)
    --- PASS: TestAgentStats_IsAvailable/Empty (0.00s)
    --- PASS: TestAgentStats_IsAvailable/Partial (0.00s)
    --- PASS: TestAgentStats_IsAvailable/Full (0.00s)
    --- PASS: TestAgentStats_IsAvailable/Single_slot_available (0.00s)
    --- PASS: TestAgentStats_IsAvailable/Single_slot_full (0.00s)
=== RUN   TestAgentStats_UtilizationPercent
=== RUN   TestAgentStats_UtilizationPercent/Empty
=== RUN   TestAgentStats_UtilizationPercent/Half
=== RUN   TestAgentStats_UtilizationPercent/Full
=== RUN   TestAgentStats_UtilizationPercent/Three_quarters
=== RUN   TestAgentStats_UtilizationPercent/Zero_max
--- PASS: TestAgentStats_UtilizationPercent (0.00s)
    --- PASS: TestAgentStats_UtilizationPercent/Empty (0.00s)
    --- PASS: TestAgentStats_UtilizationPercent/Half (0.00s)
    --- PASS: TestAgentStats_UtilizationPercent/Full (0.00s)
    --- PASS: TestAgentStats_UtilizationPercent/Three_quarters (0.00s)
    --- PASS: TestAgentStats_UtilizationPercent/Zero_max (0.00s)
=== RUN   TestAgentPool_ConcurrentAcquireRelease
--- PASS: TestAgentPool_ConcurrentAcquireRelease (0.00s)
=== RUN   TestAgentPool_StressTest
    agent_pool_test.go:410: Stress test: 1000 goroutines, max concurrent: 10
--- PASS: TestAgentPool_StressTest (0.01s)
=== RUN   TestConflictDetector_NewConflictDetector
--- PASS: TestConflictDetector_NewConflictDetector (0.00s)
=== RUN   TestConflictDetector_RegisterAndUnregister
--- PASS: TestConflictDetector_RegisterAndUnregister (0.00s)
=== RUN   TestConflictDetector_HasConflict_NoConflict
--- PASS: TestConflictDetector_HasConflict_NoConflict (0.00s)
=== RUN   TestConflictDetector_HasConflict_WithConflict
--- PASS: TestConflictDetector_HasConflict_WithConflict (0.00s)
=== RUN   TestConflictDetector_HasConflict_SameSBI
--- PASS: TestConflictDetector_HasConflict_SameSBI (0.00s)
=== RUN   TestConflictDetector_GetConflictingSBIID
--- PASS: TestConflictDetector_GetConflictingSBIID (0.00s)
=== RUN   TestConflictDetector_Clear
--- PASS: TestConflictDetector_Clear (0.00s)
=== RUN   TestConflictDetector_ConcurrentAccess
--- PASS: TestConflictDetector_ConcurrentAccess (0.00s)
=== RUN   TestConflictDetector_MultipleFilesConflict
--- PASS: TestConflictDetector_MultipleFilesConflict (0.00s)
=== RUN   TestConflictDetector_UnregisterPartial
--- PASS: TestConflictDetector_UnregisterPartial (0.00s)
=== RUN   TestConflictDetector_EmptyFilePaths
--- PASS: TestConflictDetector_EmptyFilePaths (0.00s)
=== RUN   TestLockService_AcquireAndReleaseRunLock
--- PASS: TestLockService_AcquireAndReleaseRunLock (0.00s)
=== RUN   TestLockService_AcquireAndReleaseStateLock
--- PASS: TestLockService_AcquireAndReleaseStateLock (0.00s)
=== RUN   TestLockService_RunLockHeartbeat
--- PASS: TestLockService_RunLockHeartbeat (0.55s)
=== RUN   TestLockService_StateLockHeartbeat
--- PASS: TestLockService_StateLockHeartbeat (0.55s)
=== RUN   TestLockService_CleanupScheduler
--- PASS: TestLockService_CleanupScheduler (0.50s)
=== RUN   TestLockService_Stop
--- PASS: TestLockService_Stop (0.50s)
=== RUN   TestLockService_ExtendRunLock
--- PASS: TestLockService_ExtendRunLock (0.00s)
=== RUN   TestLockService_ExtendStateLock
--- PASS: TestLockService_ExtendStateLock (0.00s)
=== RUN   TestLockService_ListLocks
--- PASS: TestLockService_ListLocks (0.00s)
=== RUN   TestSBIExecutionService_PickNextSBI_InProgress
--- PASS: TestSBIExecutionService_PickNextSBI_InProgress (0.00s)
=== RUN   TestSBIExecutionService_PickNextSBI_Pending
--- PASS: TestSBIExecutionService_PickNextSBI_Pending (0.00s)
=== RUN   TestSBIExecutionService_PickNextSBI_NoTasks
--- PASS: TestSBIExecutionService_PickNextSBI_NoTasks (0.00s)
=== RUN   TestSBIExecutionService_GetSBIByID
--- PASS: TestSBIExecutionService_GetSBIByID (0.00s)
=== RUN   TestSBIExecutionService_UpdateSBI
--- PASS: TestSBIExecutionService_UpdateSBI (0.00s)
=== RUN   TestSBIExecutionService_AcquireSBILock
--- PASS: TestSBIExecutionService_AcquireSBILock (0.00s)
=== RUN   TestSBIExecutionService_AcquireSBILock_AlreadyLocked
--- PASS: TestSBIExecutionService_AcquireSBILock_AlreadyLocked (0.00s)
=== RUN   TestSBIExecutionService_ReleaseSBILock
--- PASS: TestSBIExecutionService_ReleaseSBILock (0.00s)
=== RUN   TestSBIExecutionService_PickAndLockNextSBI
--- PASS: TestSBIExecutionService_PickAndLockNextSBI (0.00s)
=== RUN   TestSBIExecutionService_PickAndLockNextSBI_NoTasks
--- PASS: TestSBIExecutionService_PickAndLockNextSBI_NoTasks (0.00s)
=== RUN   TestSBIExecutionService_PickAndLockNextSBI_LockAlreadyHeld
--- PASS: TestSBIExecutionService_PickAndLockNextSBI_LockAlreadyHeld (0.00s)
=== RUN   ExampleAgentPool
--- PASS: ExampleAgentPool (0.00s)
PASS
coverage: 23.2% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/application/service	3.377s	coverage: 23.2% of statements
	github.com/YoshitsuguKoike/deespec/internal/application/usecase		coverage: 0.0% of statements
	github.com/YoshitsuguKoike/deespec/internal/application/usecase/execution		coverage: 0.0% of statements
	github.com/YoshitsuguKoike/deespec/internal/application/usecase/task		coverage: 0.0% of statements
	github.com/YoshitsuguKoike/deespec/internal/application/usecase/workflow		coverage: 0.0% of statements
=== RUN   TestWorkflowManager_NewWorkflowManager
--- PASS: TestWorkflowManager_NewWorkflowManager (0.00s)
=== RUN   TestWorkflowManager_RegisterWorkflow
--- PASS: TestWorkflowManager_RegisterWorkflow (0.00s)
=== RUN   TestWorkflowManager_GetEnabledWorkflows
--- PASS: TestWorkflowManager_GetEnabledWorkflows (0.00s)
=== RUN   TestWorkflowManager_RunWorkflow
--- PASS: TestWorkflowManager_RunWorkflow (0.20s)
=== RUN   TestWorkflowManager_RunAll
--- PASS: TestWorkflowManager_RunAll (0.20s)
=== RUN   TestWorkflowManager_ErrorHandling
--- PASS: TestWorkflowManager_ErrorHandling (0.21s)
=== RUN   TestWorkflowManager_Stats
--- PASS: TestWorkflowManager_Stats (0.20s)
=== RUN   TestWorkflowManager_ConcurrentAccess
--- PASS: TestWorkflowManager_ConcurrentAccess (0.11s)
PASS
coverage: 63.5% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/application/workflow	2.150s	coverage: 63.5% of statements
	github.com/YoshitsuguKoike/deespec/internal/buildinfo		coverage: 0.0% of statements
	github.com/YoshitsuguKoike/deespec/internal/domain		coverage: 0.0% of statements
=== RUN   TestNewSBIExecution
--- PASS: TestNewSBIExecution (0.00s)
=== RUN   TestExecutionTransitions
=== RUN   TestExecutionTransitions/Ready_to_Implement
=== RUN   TestExecutionTransitions/Implement_to_Review
=== RUN   TestExecutionTransitions/Review_to_Implement_(retry)
=== RUN   TestExecutionTransitions/Review_to_Done_(success)
=== RUN   TestExecutionTransitions/Invalid:_Ready_to_Done
=== RUN   TestExecutionTransitions/Invalid:_Implement_to_Implement
--- PASS: TestExecutionTransitions (0.00s)
    --- PASS: TestExecutionTransitions/Ready_to_Implement (0.00s)
    --- PASS: TestExecutionTransitions/Implement_to_Review (0.00s)
    --- PASS: TestExecutionTransitions/Review_to_Implement_(retry) (0.00s)
    --- PASS: TestExecutionTransitions/Review_to_Done_(success) (0.00s)
    --- PASS: TestExecutionTransitions/Invalid:_Ready_to_Done (0.00s)
    --- PASS: TestExecutionTransitions/Invalid:_Implement_to_Implement (0.00s)
=== RUN   TestApplyDecision
=== RUN   TestApplyDecision/Apply_Succeeded_in_Review
=== RUN   TestApplyDecision/Apply_NeedsChanges_in_Review
=== RUN   TestApplyDecision/Cannot_apply_in_WIP
=== RUN   TestApplyDecision/Cannot_apply_in_Ready
=== RUN   TestApplyDecision/Invalid_decision
--- PASS: TestApplyDecision (0.00s)
    --- PASS: TestApplyDecision/Apply_Succeeded_in_Review (0.00s)
    --- PASS: TestApplyDecision/Apply_NeedsChanges_in_Review (0.00s)
    --- PASS: TestApplyDecision/Cannot_apply_in_WIP (0.00s)
    --- PASS: TestApplyDecision/Cannot_apply_in_Ready (0.00s)
    --- PASS: TestApplyDecision/Invalid_decision (0.00s)
=== RUN   TestNextStepLogic
=== RUN   TestNextStepLogic/Ready_->_Implement
=== RUN   TestNextStepLogic/First_Review_Success_->_Done
=== RUN   TestNextStepLogic/First_Review_Fail_->_Second_Try
=== RUN   TestNextStepLogic/Second_Review_Success_->_Done
=== RUN   TestNextStepLogic/Second_Review_Fail_->_Third_Try
=== RUN   TestNextStepLogic/Third_Review_Success_->_Done
=== RUN   TestNextStepLogic/Third_Review_Fail_->_Force
=== RUN   TestNextStepLogic/Force_->_Implementer_Review
=== RUN   TestNextStepLogic/Implementer_Review_->_Done
--- PASS: TestNextStepLogic (0.00s)
    --- PASS: TestNextStepLogic/Ready_->_Implement (0.00s)
    --- PASS: TestNextStepLogic/First_Review_Success_->_Done (0.00s)
    --- PASS: TestNextStepLogic/First_Review_Fail_->_Second_Try (0.00s)
    --- PASS: TestNextStepLogic/Second_Review_Success_->_Done (0.00s)
    --- PASS: TestNextStepLogic/Second_Review_Fail_->_Third_Try (0.00s)
    --- PASS: TestNextStepLogic/Third_Review_Success_->_Done (0.00s)
    --- PASS: TestNextStepLogic/Third_Review_Fail_->_Force (0.00s)
    --- PASS: TestNextStepLogic/Force_->_Implementer_Review (0.00s)
    --- PASS: TestNextStepLogic/Implementer_Review_->_Done (0.00s)
=== RUN   TestShouldForceTerminate
=== RUN   TestShouldForceTerminate/Not_enough_attempts
=== RUN   TestShouldForceTerminate/Three_attempts_with_failure
=== RUN   TestShouldForceTerminate/Three_attempts_but_success
=== RUN   TestShouldForceTerminate/Four_attempts
--- PASS: TestShouldForceTerminate (0.00s)
    --- PASS: TestShouldForceTerminate/Not_enough_attempts (0.00s)
    --- PASS: TestShouldForceTerminate/Three_attempts_with_failure (0.00s)
    --- PASS: TestShouldForceTerminate/Three_attempts_but_success (0.00s)
    --- PASS: TestShouldForceTerminate/Four_attempts (0.00s)
=== RUN   TestGetFinalDecision
=== RUN   TestGetFinalDecision/Not_completed
=== RUN   TestGetFinalDecision/Completed_with_Success
=== RUN   TestGetFinalDecision/Completed_with_Failure
=== RUN   TestGetFinalDecision/Completed_after_force_termination
--- PASS: TestGetFinalDecision (0.00s)
    --- PASS: TestGetFinalDecision/Not_completed (0.00s)
    --- PASS: TestGetFinalDecision/Completed_with_Success (0.00s)
    --- PASS: TestGetFinalDecision/Completed_with_Failure (0.00s)
    --- PASS: TestGetFinalDecision/Completed_after_force_termination (0.00s)
=== RUN   TestIsCompleted
=== RUN   TestIsCompleted/Not_completed_-_Ready
=== RUN   TestIsCompleted/Not_completed_-_Implementation
=== RUN   TestIsCompleted/Not_completed_-_Review
=== RUN   TestIsCompleted/Completed_-_Done
--- PASS: TestIsCompleted (0.00s)
    --- PASS: TestIsCompleted/Not_completed_-_Ready (0.00s)
    --- PASS: TestIsCompleted/Not_completed_-_Implementation (0.00s)
    --- PASS: TestIsCompleted/Not_completed_-_Review (0.00s)
    --- PASS: TestIsCompleted/Completed_-_Done (0.00s)
=== RUN   TestAttemptIncrement
--- PASS: TestAttemptIncrement (0.00s)
=== RUN   TestTimingFields
--- PASS: TestTimingFields (0.05s)
PASS
coverage: 27.7% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/domain/execution	1.293s	coverage: 27.7% of statements
	github.com/YoshitsuguKoike/deespec/internal/domain/factory		coverage: 0.0% of statements
	github.com/YoshitsuguKoike/deespec/internal/domain/model		coverage: 0.0% of statements
	github.com/YoshitsuguKoike/deespec/internal/domain/model/epic		coverage: 0.0% of statements
=== RUN   TestNewLabel
--- PASS: TestNewLabel (0.00s)
=== RUN   TestReconstructLabel
--- PASS: TestReconstructLabel (0.00s)
=== RUN   TestSetContentHash
--- PASS: TestSetContentHash (0.00s)
=== RUN   TestSetLineCount
--- PASS: TestSetLineCount (0.00s)
=== RUN   TestUpdateSyncTime
--- PASS: TestUpdateSyncTime (0.01s)
=== RUN   TestActivateDeactivate
--- PASS: TestActivateDeactivate (0.00s)
=== RUN   TestAddRemoveTemplatePath
--- PASS: TestAddRemoveTemplatePath (0.00s)
=== RUN   TestClearContentHashes
--- PASS: TestClearContentHashes (0.00s)
=== RUN   TestSetParentLabelID
--- PASS: TestSetParentLabelID (0.00s)
PASS
coverage: 77.8% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/domain/model/label	1.237s	coverage: 77.8% of statements
	github.com/YoshitsuguKoike/deespec/internal/domain/model/lock		coverage: 0.0% of statements
	github.com/YoshitsuguKoike/deespec/internal/domain/model/pbi		coverage: 0.0% of statements
	github.com/YoshitsuguKoike/deespec/internal/domain/model/sbi		coverage: 0.0% of statements
	github.com/YoshitsuguKoike/deespec/internal/domain/model/task		coverage: 0.0% of statements
testing: warning: no tests to run
PASS
coverage: [no statements]
ok  	github.com/YoshitsuguKoike/deespec/internal/domain/repository	1.292s	coverage: [no statements] [no tests to run]
	github.com/YoshitsuguKoike/deespec/internal/domain/service/strategy		coverage: 0.0% of statements
	github.com/YoshitsuguKoike/deespec/internal/embed		coverage: 0.0% of statements
=== RUN   TestHelloWorld
--- PASS: TestHelloWorld (0.00s)
=== RUN   TestHelloWithName
=== RUN   TestHelloWithName/with_valid_name
=== RUN   TestHelloWithName/with_another_name
=== RUN   TestHelloWithName/with_empty_string
--- PASS: TestHelloWithName (0.00s)
    --- PASS: TestHelloWithName/with_valid_name (0.00s)
    --- PASS: TestHelloWithName/with_another_name (0.00s)
    --- PASS: TestHelloWithName/with_empty_string (0.00s)
PASS
coverage: 100.0% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/hello	1.231s	coverage: 100.0% of statements
=== RUN   TestLoadSettings
=== RUN   TestLoadSettings/Default_values_only
=== RUN   TestLoadSettings/JSON_file_only
--- PASS: TestLoadSettings (0.00s)
    --- PASS: TestLoadSettings/Default_values_only (0.00s)
    --- PASS: TestLoadSettings/JSON_file_only (0.00s)
=== RUN   TestToBool
=== RUN   TestToBool/1
=== RUN   TestToBool/true
=== RUN   TestToBool/TRUE
=== RUN   TestToBool/True
=== RUN   TestToBool/yes
=== RUN   TestToBool/YES
=== RUN   TestToBool/on
=== RUN   TestToBool/ON
=== RUN   TestToBool/0
=== RUN   TestToBool/false
=== RUN   TestToBool/FALSE
=== RUN   TestToBool/no
=== RUN   TestToBool/off
=== RUN   TestToBool/#00
=== RUN   TestToBool/invalid
--- PASS: TestToBool (0.00s)
    --- PASS: TestToBool/1 (0.00s)
    --- PASS: TestToBool/true (0.00s)
    --- PASS: TestToBool/TRUE (0.00s)
    --- PASS: TestToBool/True (0.00s)
    --- PASS: TestToBool/yes (0.00s)
    --- PASS: TestToBool/YES (0.00s)
    --- PASS: TestToBool/on (0.00s)
    --- PASS: TestToBool/ON (0.00s)
    --- PASS: TestToBool/0 (0.00s)
    --- PASS: TestToBool/false (0.00s)
    --- PASS: TestToBool/FALSE (0.00s)
    --- PASS: TestToBool/no (0.00s)
    --- PASS: TestToBool/off (0.00s)
    --- PASS: TestToBool/#00 (0.00s)
    --- PASS: TestToBool/invalid (0.00s)
=== RUN   TestCreateDefaultSettings
--- PASS: TestCreateDefaultSettings (0.00s)
=== RUN   TestLoadSettings_LabelConfig
=== RUN   TestLoadSettings_LabelConfig/Default_label_config
=== RUN   TestLoadSettings_LabelConfig/Custom_label_config_from_JSON
--- PASS: TestLoadSettings_LabelConfig (0.00s)
    --- PASS: TestLoadSettings_LabelConfig/Default_label_config (0.00s)
    --- PASS: TestLoadSettings_LabelConfig/Custom_label_config_from_JSON (0.00s)
=== RUN   TestLoadSettings_AgentPoolConfig
=== RUN   TestLoadSettings_AgentPoolConfig/Default_agent_pool_config
=== RUN   TestLoadSettings_AgentPoolConfig/Custom_agent_pool_config_from_JSON
=== RUN   TestLoadSettings_AgentPoolConfig/Partial_agent_pool_config
--- PASS: TestLoadSettings_AgentPoolConfig (0.00s)
    --- PASS: TestLoadSettings_AgentPoolConfig/Default_agent_pool_config (0.00s)
    --- PASS: TestLoadSettings_AgentPoolConfig/Custom_agent_pool_config_from_JSON (0.00s)
    --- PASS: TestLoadSettings_AgentPoolConfig/Partial_agent_pool_config (0.00s)
PASS
coverage: 90.3% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/infra/config	1.230s	coverage: 90.3% of statements
=== RUN   TestFsyncFile
--- PASS: TestFsyncFile (0.01s)
=== RUN   TestFsyncDir
--- PASS: TestFsyncDir (0.01s)
=== RUN   TestAtomicRename
--- PASS: TestAtomicRename (0.01s)
=== RUN   TestWriteFileSync
--- PASS: TestWriteFileSync (0.02s)
PASS
coverage: 40.6% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/infra/fs	1.294s	coverage: 40.6% of statements
=== RUN   TestChecksumMismatchRecoveryIntegration
=== RUN   TestChecksumMismatchRecoveryIntegration/ChecksumMismatchFailsGracefully
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/var/txn/txn_1760111649_160307000/stage/test_file.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

ERROR: Checksum validation failed txn.checksum.validation.failed=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/var/txn/txn_1760111649_160307000/stage/test_file.txt txn.checksum.calculation.duration_ms=0ms error=size_mismatch expected_size=34 actual_size=30

=== RUN   TestChecksumMismatchRecoveryIntegration/RecoveryDetectsCorruptedTransaction
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/var/txn/txn_1760111649_199144000/stage/recovery_test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

[TXN-SCAN] 2025/10/11 00:54:09 WARN: Found transaction with intent but no commit txn.id=txn_1760111649_160307000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/11 00:54:09 WARN: Found transaction with intent but no commit txn.id=txn_1760111649_199144000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/11 00:54:09 SUMMARY: Transaction scan complete txn.scan.total=2 txn.scan.timestamp=2025-10-10T15:54:09Z
[TXN-SCAN] 2025/10/11 00:54:09   - Forward recovery needed txn.scan.intent_only_count=2 txn.scan.intent_only_ids=[txn_1760111649_160307000,txn_1760111649_199144000]
[TXN-SCAN] 2025/10/11 00:54:09 NOTE: Recovery disabled txn.scan.recovery_action=none txn.cleanup_policy=pending_step8
ERROR: Checksum validation failed txn.checksum.validation.failed=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/var/txn/txn_1760111649_160307000/stage/test_file.txt txn.checksum.calculation.duration_ms=0ms error=size_mismatch expected_size=34 actual_size=30

WARN: Transaction recovery timeout/cancelled txn.id=txn_1760111649_160307000 txn.retry.attempt=0

ERROR: Failed to recover transaction txn.recover.forward.failed=txn_1760111649_160307000 error=transaction recovery failed after 4 attempts: failed to complete commit during recovery: staged file checksum validation failed for test_file.txt: file size mismatch: expected 34 bytes, got 30 bytes

ERROR: Checksum validation failed txn.checksum.validation.failed=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/var/txn/txn_1760111649_199144000/stage/recovery_test.txt txn.checksum.calculation.duration_ms=0ms error=size_mismatch expected_size=21 actual_size=26

WARN: Transaction recovery timeout/cancelled txn.id=txn_1760111649_199144000 txn.retry.attempt=0

ERROR: Failed to recover transaction txn.recover.forward.failed=txn_1760111649_199144000 error=transaction recovery failed after 4 attempts: failed to complete commit during recovery: staged file checksum validation failed for recovery_test.txt: file size mismatch: expected 21 bytes, got 26 bytes

INFO: Recovery complete txn.recover.forward.count=2 txn.recover.forward.success=0 txn.cleanup.success=0 txn.recover.duration_ms=2

=== RUN   TestChecksumMismatchRecoveryIntegration/ParallelChecksumValidationDuringRecovery
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/TestChecksumMismatchRecoveryIntegrationParallelChecksumValidationDuringRecovery2105591262/001/.deespec/var/txn/txn_1760111649_237620000/stage/parallel_test_A.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/TestChecksumMismatchRecoveryIntegrationParallelChecksumValidationDuringRecovery2105591262/001/.deespec/var/txn/txn_1760111649_274841000/stage/parallel_test_B.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/TestChecksumMismatchRecoveryIntegrationParallelChecksumValidationDuringRecovery2105591262/001/.deespec/var/txn/txn_1760111649_311182000/stage/parallel_test_C.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

[TXN-SCAN] 2025/10/11 00:54:09 WARN: Found transaction with intent but no commit txn.id=txn_1760111649_237620000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/11 00:54:09 WARN: Found transaction with intent but no commit txn.id=txn_1760111649_274841000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/11 00:54:09 WARN: Found transaction with intent but no commit txn.id=txn_1760111649_311182000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/11 00:54:09 SUMMARY: Transaction scan complete txn.scan.total=3 txn.scan.timestamp=2025-10-10T15:54:09Z
[TXN-SCAN] 2025/10/11 00:54:09   - Forward recovery needed txn.scan.intent_only_count=3 txn.scan.intent_only_ids=[txn_1760111649_237620000,txn_1760111649_274841000,txn_1760111649_311182000]
[TXN-SCAN] 2025/10/11 00:54:09 NOTE: Recovery disabled txn.scan.recovery_action=none txn.cleanup_policy=pending_step8
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/TestChecksumMismatchRecoveryIntegrationParallelChecksumValidationDuringRecovery2105591262/001/.deespec/var/txn/txn_1760111649_237620000/stage/parallel_test_A.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/TestChecksumMismatchRecoveryIntegrationParallelChecksumValidationDuringRecovery2105591262/001/.deespec/parallel_test_A.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1760111649_237620000

INFO: Recovered transaction txn.recover.forward.success=txn_1760111649_237620000

ERROR: Checksum validation failed txn.checksum.validation.failed=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/TestChecksumMismatchRecoveryIntegrationParallelChecksumValidationDuringRecovery2105591262/001/.deespec/var/txn/txn_1760111649_274841000/stage/parallel_test_B.txt txn.checksum.calculation.duration_ms=0ms error=size_mismatch expected_size=23 actual_size=26

WARN: Transaction recovery timeout/cancelled txn.id=txn_1760111649_274841000 txn.retry.attempt=0

ERROR: Failed to recover transaction txn.recover.forward.failed=txn_1760111649_274841000 error=transaction recovery failed after 4 attempts: failed to complete commit during recovery: staged file checksum validation failed for parallel_test_B.txt: file size mismatch: expected 23 bytes, got 26 bytes

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/TestChecksumMismatchRecoveryIntegrationParallelChecksumValidationDuringRecovery2105591262/001/.deespec/var/txn/txn_1760111649_311182000/stage/parallel_test_C.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/TestChecksumMismatchRecoveryIntegrationParallelChecksumValidationDuringRecovery2105591262/001/.deespec/parallel_test_C.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1760111649_311182000

INFO: Recovered transaction txn.recover.forward.success=txn_1760111649_311182000

INFO: Recovery complete txn.recover.forward.count=3 txn.recover.forward.success=2 txn.cleanup.success=0 txn.recover.duration_ms=41

=== RUN   TestChecksumMismatchRecoveryIntegration/LargeTransactionWorkerPoolValidation
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/var/txn/txn_1760111649_394787000/stage/worker_test_0.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/var/txn/txn_1760111649_394787000/stage/worker_test_1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/var/txn/txn_1760111649_394787000/stage/worker_test_2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/var/txn/txn_1760111649_394787000/stage/worker_test_3.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/var/txn/txn_1760111649_394787000/stage/worker_test_4.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/var/txn/txn_1760111649_394787000/stage/worker_test_5.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/var/txn/txn_1760111649_394787000/stage/worker_test_6.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/var/txn/txn_1760111649_394787000/stage/worker_test_7.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/var/txn/txn_1760111649_394787000/stage/worker_test_1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/var/txn/txn_1760111649_394787000/stage/worker_test_0.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/var/txn/txn_1760111649_394787000/stage/worker_test_2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/var/txn/txn_1760111649_394787000/stage/worker_test_3.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/var/txn/txn_1760111649_394787000/stage/worker_test_4.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/var/txn/txn_1760111649_394787000/stage/worker_test_5.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/var/txn/txn_1760111649_394787000/stage/worker_test_6.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/var/txn/txn_1760111649_394787000/stage/worker_test_7.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Using parallel checksum validation txn.checksum.parallel=true txn.files=8 txn.workers=4

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/var/txn/txn_1760111649_394787000/stage/worker_test_1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/var/txn/txn_1760111649_394787000/stage/worker_test_0.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/var/txn/txn_1760111649_394787000/stage/worker_test_2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/var/txn/txn_1760111649_394787000/stage/worker_test_3.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/var/txn/txn_1760111649_394787000/stage/worker_test_4.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/var/txn/txn_1760111649_394787000/stage/worker_test_7.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/var/txn/txn_1760111649_394787000/stage/worker_test_6.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Parallel checksum calculation completed txn.checksum.calculation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/var/txn/txn_1760111649_394787000/stage/worker_test_5.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/worker_test_0.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/worker_test_1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/worker_test_2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/worker_test_3.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/worker_test_4.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/worker_test_5.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/worker_test_6.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_recovery_test_4266138912/.deespec/worker_test_7.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1760111649_394787000

--- PASS: TestChecksumMismatchRecoveryIntegration (0.46s)
    --- PASS: TestChecksumMismatchRecoveryIntegration/ChecksumMismatchFailsGracefully (0.04s)
    --- PASS: TestChecksumMismatchRecoveryIntegration/RecoveryDetectsCorruptedTransaction (0.04s)
    --- PASS: TestChecksumMismatchRecoveryIntegration/ParallelChecksumValidationDuringRecovery (0.16s)
    --- PASS: TestChecksumMismatchRecoveryIntegration/LargeTransactionWorkerPoolValidation (0.22s)
=== RUN   TestChecksumCalculation
--- PASS: TestChecksumCalculation (0.00s)
=== RUN   TestChecksumValidation
--- PASS: TestChecksumValidation (0.00s)
=== RUN   TestFileChecksumValidation
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_test_1016233727/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

ERROR: Checksum validation failed txn.checksum.validation.failed=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/checksum_test_1016233727/test.txt txn.checksum.calculation.duration_ms=0ms error=size_mismatch expected_size=26 actual_size=21

--- PASS: TestFileChecksumValidation (0.00s)
=== RUN   TestTransactionChecksumIntegration
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_checksum_test_3223346838/.deespec/var/txn/txn_1760111649_621842000/stage/checksum_test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_checksum_test_3223346838/.deespec/var/txn/txn_1760111649_621842000/stage/checksum_test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_checksum_test_3223346838/.deespec/checksum_test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1760111649_621842000

--- PASS: TestTransactionChecksumIntegration (0.06s)
=== RUN   TestChecksumCorruptionDetection
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/corruption_test_1548670953/.deespec/var/txn/txn_1760111649_682356000/stage/corrupt_test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

ERROR: Checksum validation failed txn.checksum.validation.failed=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/corruption_test_1548670953/.deespec/var/txn/txn_1760111649_682356000/stage/corrupt_test.txt txn.checksum.calculation.duration_ms=0ms error=size_mismatch expected_size=25 actual_size=17

--- PASS: TestChecksumCorruptionDetection (0.04s)
=== RUN   TestUnsupportedChecksumAlgorithm
--- PASS: TestUnsupportedChecksumAlgorithm (0.00s)
=== RUN   TestCompareFileChecksums
--- PASS: TestCompareFileChecksums (0.00s)
=== RUN   TestMetricsRaceConditions
=== RUN   TestMetricsRaceConditions/ConcurrentIncrements
=== RUN   TestMetricsRaceConditions/ConcurrentReadWrite
=== RUN   TestMetricsRaceConditions/ConcurrentFileAccess
=== RUN   TestMetricsRaceConditions/ConcurrentSnapshotOperations
INFO: Metrics snapshot created path=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/metrics_race_test_1332292922/snapshots/metrics_20251010_155410_628473000.json

INFO: Metrics snapshot created path=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/metrics_race_test_1332292922/snapshots/metrics_20251010_155410_628539000.json

INFO: Metrics snapshot created path=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/metrics_race_test_1332292922/snapshots/metrics_20251010_155410_628570000.json

INFO: Metrics snapshot created path=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/metrics_race_test_1332292922/snapshots/metrics_20251010_155410_628514000.json

INFO: Metrics snapshot created path=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/metrics_race_test_1332292922/snapshots/metrics_20251010_155410_629132000.json

INFO: Metrics rotated and reset counters=false
INFO: Metrics snapshot created path=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/metrics_race_test_1332292922/snapshots/metrics_20251010_155410_629107000.json

INFO: Metrics rotated and reset counters=false
INFO: Metrics snapshot created path=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/metrics_race_test_1332292922/snapshots/metrics_20251010_155410_629244000.json

INFO: Metrics rotated and reset counters=false
INFO: Metrics snapshot created path=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/metrics_race_test_1332292922/snapshots/metrics_20251010_155410_629367000.json

INFO: Metrics rotated and reset counters=false
--- PASS: TestMetricsRaceConditions (0.91s)
    --- PASS: TestMetricsRaceConditions/ConcurrentIncrements (0.01s)
    --- PASS: TestMetricsRaceConditions/ConcurrentReadWrite (0.00s)
    --- PASS: TestMetricsRaceConditions/ConcurrentFileAccess (0.89s)
    --- PASS: TestMetricsRaceConditions/ConcurrentSnapshotOperations (0.00s)
=== RUN   TestMetricsDeadlockDetection
    metrics_race_test.go:282: Deadlock test completed successfully
--- PASS: TestMetricsDeadlockDetection (0.24s)
=== RUN   TestMultiProcessConcurrentMetrics
    multiprocess_e2e_test.go:108: Final metrics after 3 processes × 20 operations:
    multiprocess_e2e_test.go:109:   CommitSuccess: 15
    multiprocess_e2e_test.go:110:   CommitFailed: 15
    multiprocess_e2e_test.go:111:   CASConflicts: 15
    multiprocess_e2e_test.go:112:   RecoveryCount: 15
    multiprocess_e2e_test.go:113:   SchemaVersion: 1
--- PASS: TestMultiProcessConcurrentMetrics (0.27s)
=== RUN   TestMultiProcessRegisterAndStateTransactions
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_133668000/stage/specs/process-1-txn-0/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_133661000/stage/specs/process-0-txn-0/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_133668000/stage/specs/process-1-txn-0/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_133661000/stage/specs/process-0-txn-0/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_133668000/stage/specs/process-1-txn-0/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_133668000/stage/specs/process-1-txn-0/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_133661000/stage/specs/process-0-txn-0/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_133661000/stage/specs/process-0-txn-0/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/specs/process-1-txn-0/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/specs/process-0-txn-0/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=1ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/specs/process-1-txn-0/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/specs/process-0-txn-0/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=2ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_297395000/stage/specs/process-1-txn-1/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_301062000/stage/specs/process-0-txn-1/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_297395000/stage/specs/process-1-txn-1/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_301062000/stage/specs/process-0-txn-1/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_297395000/stage/specs/process-1-txn-1/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_297395000/stage/specs/process-1-txn-1/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/specs/process-1-txn-1/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=2ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_301062000/stage/specs/process-0-txn-1/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=2ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_301062000/stage/specs/process-0-txn-1/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/specs/process-1-txn-1/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/specs/process-0-txn-1/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/specs/process-0-txn-1/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_523074000/stage/specs/process-1-txn-2/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_523074000/stage/specs/process-1-txn-2/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=4ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_545755000/stage/specs/process-0-txn-2/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_545755000/stage/specs/process-0-txn-2/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_523074000/stage/specs/process-1-txn-2/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_523074000/stage/specs/process-1-txn-2/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/specs/process-1-txn-2/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_545755000/stage/specs/process-0-txn-2/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_545755000/stage/specs/process-0-txn-2/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/specs/process-0-txn-2/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/specs/process-1-txn-2/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/specs/process-0-txn-2/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_694801000/stage/specs/process-1-txn-3/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_702580000/stage/specs/process-0-txn-3/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_694801000/stage/specs/process-1-txn-3/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_702580000/stage/specs/process-0-txn-3/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_694801000/stage/specs/process-1-txn-3/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_694801000/stage/specs/process-1-txn-3/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/specs/process-1-txn-3/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_702580000/stage/specs/process-0-txn-3/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_702580000/stage/specs/process-0-txn-3/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/specs/process-1-txn-3/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/specs/process-0-txn-3/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/specs/process-0-txn-3/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_846719000/stage/specs/process-1-txn-4/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_859956000/stage/specs/process-0-txn-4/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_846719000/stage/specs/process-1-txn-4/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_859956000/stage/specs/process-0-txn-4/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_846719000/stage/specs/process-1-txn-4/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_846719000/stage/specs/process-1-txn-4/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_859956000/stage/specs/process-0-txn-4/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/var/txn/txn_1760111651_859956000/stage/specs/process-0-txn-4/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/specs/process-1-txn-4/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/specs/process-0-txn-4/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/specs/process-1-txn-4/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/multiprocess_register_e2e_2343619301/.deespec/specs/process-0-txn-4/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

    multiprocess_e2e_test.go:248: Multi-process register/state-tx test completed:
    multiprocess_e2e_test.go:249:   Expected successes: 10
    multiprocess_e2e_test.go:250:   Actual successes: 55
    multiprocess_e2e_test.go:251:   Actual failures: 0
    multiprocess_e2e_test.go:274: Multi-process E2E test completed successfully
    multiprocess_e2e_test.go:275: File locking and metrics synchronization verified
--- PASS: TestMultiProcessRegisterAndStateTransactions (0.90s)
=== RUN   TestMultiProcessMetricsConsistency
    multiprocess_e2e_test.go:367: High-concurrency test results:
    multiprocess_e2e_test.go:368:   Processes: 5
    multiprocess_e2e_test.go:369:   Operations per process: 100
    multiprocess_e2e_test.go:370:   Minimum expected: 500
    multiprocess_e2e_test.go:371:   Actual final count: 500
    multiprocess_e2e_test.go:377: Multi-process consistency test passed - file locking prevented data corruption
--- PASS: TestMultiProcessMetricsConsistency (2.49s)
=== RUN   TestForwardRecovery
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_test_4123274364/.deespec/var/txn/txn_1760111654_522487000/stage/test1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_test_4123274364/.deespec/var/txn/txn_1760111654_522487000/stage/test2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

[TXN-SCAN] 2025/10/11 00:54:14 WARN: Found transaction with intent but no commit txn.id=txn_1760111654_522487000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/11 00:54:14 SUMMARY: Transaction scan complete txn.scan.total=1 txn.scan.timestamp=2025-10-10T15:54:14Z
[TXN-SCAN] 2025/10/11 00:54:14   - Forward recovery needed txn.scan.intent_only_count=1 txn.scan.intent_only_ids=[txn_1760111654_522487000]
[TXN-SCAN] 2025/10/11 00:54:14 NOTE: Recovery disabled txn.scan.recovery_action=none txn.cleanup_policy=pending_step8
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_test_4123274364/.deespec/var/txn/txn_1760111654_522487000/stage/test1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=1ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_test_4123274364/.deespec/var/txn/txn_1760111654_522487000/stage/test2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_test_4123274364/.deespec/test1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_test_4123274364/.deespec/test2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1760111654_522487000

INFO: Recovered transaction txn.recover.forward.success=txn_1760111654_522487000

INFO: Recovery complete txn.recover.forward.count=1 txn.recover.forward.success=1 txn.cleanup.success=0 txn.recover.duration_ms=28

--- PASS: TestForwardRecovery (0.09s)
=== RUN   TestIdempotentCommit
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/idempotent_test_3265400102/.deespec/var/txn/txn_1760111654_612317000/stage/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/idempotent_test_3265400102/.deespec/var/txn/txn_1760111654_612317000/stage/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/idempotent_test_3265400102/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1760111654_612317000

INFO: Transaction already committed (no-op) txn.commit.idempotent=true txn.id=txn_1760111654_612317000

--- PASS: TestIdempotentCommit (0.06s)
=== RUN   TestCleanupAfterCommit
[TXN-SCAN] 2025/10/11 00:54:14 INFO: Found completed transaction txn.id=txn_test_cleanup txn.state=committed txn.action=cleanup_ready
[TXN-SCAN] 2025/10/11 00:54:14 SUMMARY: Transaction scan complete txn.scan.total=1 txn.scan.timestamp=2025-10-10T15:54:14Z
[TXN-SCAN] 2025/10/11 00:54:14   - Ready for cleanup txn.scan.committed_count=1 txn.scan.committed_ids=[txn_test_cleanup]
[TXN-SCAN] 2025/10/11 00:54:14 NOTE: Recovery disabled txn.scan.recovery_action=none txn.cleanup_policy=pending_step8
INFO: Cleaned up transaction txn.cleanup.success=txn_test_cleanup

INFO: Recovery complete txn.recover.forward.count=0 txn.recover.forward.success=0 txn.cleanup.success=1 txn.recover.duration_ms=0

--- PASS: TestCleanupAfterCommit (0.00s)
=== RUN   TestEarlyEXDEVDetection
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/exdev_test_2560130739/.deespec/var/txn/txn_1760111654_673288000/stage/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

    recovery_test.go:214: Same filesystem - no EXDEV error (expected)
--- PASS: TestEarlyEXDEVDetection (0.03s)
=== RUN   TestE2ECrashRecoveryWithRetry
=== RUN   TestE2ECrashRecoveryWithRetry/MultipleTransactionCrashRecovery
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_4245911899/.deespec/var/txn/txn_1760111654_704889000/stage/artifacts/fileA.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_4245911899/.deespec/var/txn/txn_1760111654_747034000/stage/artifacts/fileB.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_4245911899/.deespec/var/txn/txn_1760111654_786156000/stage/artifacts/fileC.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

[TXN-SCAN] 2025/10/11 00:54:14 WARN: Found transaction with intent but no commit txn.id=txn_1760111654_704889000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/11 00:54:14 WARN: Found transaction with intent but no commit txn.id=txn_1760111654_747034000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/11 00:54:14 WARN: Found transaction with intent but no commit txn.id=txn_1760111654_786156000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/11 00:54:14 SUMMARY: Transaction scan complete txn.scan.total=3 txn.scan.timestamp=2025-10-10T15:54:14Z
[TXN-SCAN] 2025/10/11 00:54:14   - Forward recovery needed txn.scan.intent_only_count=3 txn.scan.intent_only_ids=[txn_1760111654_704889000,txn_1760111654_747034000,txn_1760111654_786156000]
[TXN-SCAN] 2025/10/11 00:54:14 NOTE: Recovery disabled txn.scan.recovery_action=none txn.cleanup_policy=pending_step8
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_4245911899/.deespec/var/txn/txn_1760111654_704889000/stage/artifacts/fileA.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_4245911899/.deespec/artifacts/fileA.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1760111654_704889000

INFO: Recovered transaction txn.recover.forward.success=txn_1760111654_704889000

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_4245911899/.deespec/var/txn/txn_1760111654_747034000/stage/artifacts/fileB.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_4245911899/.deespec/artifacts/fileB.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1760111654_747034000

INFO: Recovered transaction txn.recover.forward.success=txn_1760111654_747034000

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_4245911899/.deespec/var/txn/txn_1760111654_786156000/stage/artifacts/fileC.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_4245911899/.deespec/artifacts/fileC.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1760111654_786156000

INFO: Recovered transaction txn.recover.forward.success=txn_1760111654_786156000

INFO: Recovery complete txn.recover.forward.count=3 txn.recover.forward.success=3 txn.cleanup.success=0 txn.recover.duration_ms=62

=== RUN   TestE2ECrashRecoveryWithRetry/RecoveryWithTimeout
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_4245911899/.deespec/var/txn/txn_1760111654_888575000/stage/timeout_test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

[TXN-SCAN] 2025/10/11 00:54:14 INFO: Found completed transaction txn.id=txn_1760111654_704889000 txn.state=committed txn.action=cleanup_ready
[TXN-SCAN] 2025/10/11 00:54:14 INFO: Found completed transaction txn.id=txn_1760111654_747034000 txn.state=committed txn.action=cleanup_ready
[TXN-SCAN] 2025/10/11 00:54:14 INFO: Found completed transaction txn.id=txn_1760111654_786156000 txn.state=committed txn.action=cleanup_ready
[TXN-SCAN] 2025/10/11 00:54:14 WARN: Found transaction with intent but no commit txn.id=txn_1760111654_888575000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/11 00:54:14 SUMMARY: Transaction scan complete txn.scan.total=4 txn.scan.timestamp=2025-10-10T15:54:14Z
[TXN-SCAN] 2025/10/11 00:54:14   - Forward recovery needed txn.scan.intent_only_count=1 txn.scan.intent_only_ids=[txn_1760111654_888575000]
[TXN-SCAN] 2025/10/11 00:54:14   - Ready for cleanup txn.scan.committed_count=3 txn.scan.committed_ids=[txn_1760111654_704889000,txn_1760111654_747034000,txn_1760111654_786156000]
[TXN-SCAN] 2025/10/11 00:54:14 NOTE: Recovery disabled txn.scan.recovery_action=none txn.cleanup_policy=pending_step8
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_4245911899/.deespec/var/txn/txn_1760111654_888575000/stage/timeout_test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_4245911899/.deespec/timeout_test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1760111654_888575000

INFO: Recovered transaction txn.recover.forward.success=txn_1760111654_888575000

INFO: Cleaned up transaction txn.cleanup.success=txn_1760111654_704889000

INFO: Cleaned up transaction txn.cleanup.success=txn_1760111654_747034000

INFO: Cleaned up transaction txn.cleanup.success=txn_1760111654_786156000

INFO: Recovery complete txn.recover.forward.count=1 txn.recover.forward.success=1 txn.cleanup.success=3 txn.recover.duration_ms=23

    recovery_test.go:352: Recovery succeeded despite short timeout
=== RUN   TestE2ECrashRecoveryWithRetry/RecoveryWithCorruptedTransaction
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/e2e_crash_test_4245911899/.deespec/var/txn/txn_1760111654_949769000/stage/corrupted_test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

[TXN-SCAN] 2025/10/11 00:54:14 INFO: Found completed transaction txn.id=txn_1760111654_888575000 txn.state=committed txn.action=cleanup_ready
[TXN-SCAN] 2025/10/11 00:54:14 WARN: Found transaction with intent but no commit txn.id=txn_1760111654_949769000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/11 00:54:14 SUMMARY: Transaction scan complete txn.scan.total=2 txn.scan.timestamp=2025-10-10T15:54:14Z
[TXN-SCAN] 2025/10/11 00:54:14   - Forward recovery needed txn.scan.intent_only_count=1 txn.scan.intent_only_ids=[txn_1760111654_949769000]
[TXN-SCAN] 2025/10/11 00:54:14   - Ready for cleanup txn.scan.committed_count=1 txn.scan.committed_ids=[txn_1760111654_888575000]
[TXN-SCAN] 2025/10/11 00:54:14 NOTE: Recovery disabled txn.scan.recovery_action=none txn.cleanup_policy=pending_step8
WARN: Transaction recovery timeout/cancelled txn.id=txn_1760111654_949769000 txn.retry.attempt=0

ERROR: Failed to recover transaction txn.recover.forward.failed=txn_1760111654_949769000 error=transaction recovery failed after 4 attempts: failed to parse manifest: invalid character 'c' looking for beginning of value

INFO: Cleaned up transaction txn.cleanup.success=txn_1760111654_888575000

INFO: Recovery complete txn.recover.forward.count=1 txn.recover.forward.success=0 txn.cleanup.success=1 txn.recover.duration_ms=2

--- PASS: TestE2ECrashRecoveryWithRetry (0.29s)
    --- PASS: TestE2ECrashRecoveryWithRetry/MultipleTransactionCrashRecovery (0.18s)
    --- PASS: TestE2ECrashRecoveryWithRetry/RecoveryWithTimeout (0.06s)
    --- PASS: TestE2ECrashRecoveryWithRetry/RecoveryWithCorruptedTransaction (0.04s)
=== RUN   TestRecoveryMetrics
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_metrics_test_366599713/.deespec/var/txn/txn_1760111654_994631000/stage/metrics_test1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_metrics_test_366599713/.deespec/var/txn/txn_1760111655_41871000/stage/metrics_test2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=1ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_metrics_test_366599713/.deespec/var/txn/txn_1760111655_41871000/stage/metrics_test2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=1ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_metrics_test_366599713/.deespec/metrics_test2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=1ms

WARN: Forward recovery without journal callback for txn_1760111655_41871000

[TXN-SCAN] 2025/10/11 00:54:15 WARN: Found transaction with intent but no commit txn.id=txn_1760111654_994631000 txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/11 00:54:15 INFO: Found completed transaction txn.id=txn_1760111655_41871000 txn.state=committed txn.action=cleanup_ready
[TXN-SCAN] 2025/10/11 00:54:15 SUMMARY: Transaction scan complete txn.scan.total=2 txn.scan.timestamp=2025-10-10T15:54:15Z
[TXN-SCAN] 2025/10/11 00:54:15   - Forward recovery needed txn.scan.intent_only_count=1 txn.scan.intent_only_ids=[txn_1760111654_994631000]
[TXN-SCAN] 2025/10/11 00:54:15   - Ready for cleanup txn.scan.committed_count=1 txn.scan.committed_ids=[txn_1760111655_41871000]
[TXN-SCAN] 2025/10/11 00:54:15 NOTE: Recovery disabled txn.scan.recovery_action=none txn.cleanup_policy=pending_step8
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_metrics_test_366599713/.deespec/var/txn/txn_1760111654_994631000/stage/metrics_test1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/recovery_metrics_test_366599713/.deespec/metrics_test1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1760111654_994631000

INFO: Recovered transaction txn.recover.forward.success=txn_1760111654_994631000

INFO: Cleaned up transaction txn.cleanup.success=txn_1760111655_41871000

INFO: Recovery complete txn.recover.forward.count=1 txn.recover.forward.success=1 txn.cleanup.success=1 txn.recover.duration_ms=34

--- PASS: TestRecoveryMetrics (0.14s)
=== RUN   TestRollbackBasic
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/rollback_test_2935380603/.deespec/var/txn/txn_1760111655_139573000/stage/test_file.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Rolling back transaction txn.register.rollback.count=txn_1760111655_139573000 reason=test rollback

INFO: Transaction rollback completed txn.rollback.success=txn_1760111655_139573000 undo_performed=false duration_ms=6ms

--- PASS: TestRollbackBasic (0.05s)
=== RUN   TestRollbackWithUndo
INFO: Rolling back transaction txn.register.rollback.count=txn_1760111655_186613000 reason=test undo rollback

INFO: Transaction rollback completed txn.rollback.success=txn_1760111655_186613000 undo_performed=true duration_ms=9ms

--- PASS: TestRollbackWithUndo (0.03s)
=== RUN   TestRollbackCommittedTransaction
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/rollback_committed_test_873614792/.deespec/var/txn/txn_1760111655_213578000/stage/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/rollback_committed_test_873614792/.deespec/var/txn/txn_1760111655_213578000/stage/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/rollback_committed_test_873614792/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1760111655_213578000

INFO: Rolling back transaction txn.register.rollback.count=txn_1760111655_213578000 reason=should fail

ERROR: Cannot rollback committed transaction txn.rollback.failed=txn_1760111655_213578000

--- PASS: TestRollbackCommittedTransaction (0.06s)
=== RUN   TestRollbackMetrics
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/rollback_metrics_test_3122672938/.deespec/var/txn/txn_1760111655_270892000/stage/metrics_test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Rolling back transaction txn.register.rollback.count=txn_1760111655_270892000 reason=metrics test

INFO: Transaction rollback completed txn.rollback.success=txn_1760111655_270892000 undo_performed=false duration_ms=4ms

--- PASS: TestRollbackMetrics (0.03s)
=== RUN   TestNewScanner
--- PASS: TestNewScanner (0.00s)
=== RUN   TestScanNoDirectory
[TXN-SCAN] 2025/10/11 00:54:15 INFO: No transaction directory found txn.base_dir=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/TestScanNoDirectory4192899843/001/non-existent txn.state=clean txn.count=0
--- PASS: TestScanNoDirectory (0.00s)
=== RUN   TestScanWithTransactions
[TXN-SCAN] 2025/10/11 00:54:15 WARN: Found abandoned transaction txn.id=txn_abandoned txn.state=abandoned txn.markers=none
[TXN-SCAN] 2025/10/11 00:54:15 INFO: Found completed transaction txn.id=txn_committed txn.state=committed txn.action=cleanup_ready
[TXN-SCAN] 2025/10/11 00:54:15 WARN: Found incomplete transaction txn.id=txn_incomplete txn.state=incomplete txn.staging=partial
[TXN-SCAN] 2025/10/11 00:54:15 WARN: Found transaction with intent but no commit txn.id=txn_intent_only txn.state=intent_only txn.action=forward_recovery_needed
[TXN-SCAN] 2025/10/11 00:54:15 SUMMARY: Transaction scan complete txn.scan.total=4 txn.scan.timestamp=2025-10-10T15:54:15Z
[TXN-SCAN] 2025/10/11 00:54:15   - Forward recovery needed txn.scan.intent_only_count=1 txn.scan.intent_only_ids=[txn_intent_only]
[TXN-SCAN] 2025/10/11 00:54:15   - Incomplete transactions txn.scan.incomplete_count=1 txn.scan.incomplete_ids=[txn_incomplete]
[TXN-SCAN] 2025/10/11 00:54:15   - Abandoned transactions txn.scan.abandoned_count=1 txn.scan.abandoned_ids=[txn_abandoned]
[TXN-SCAN] 2025/10/11 00:54:15   - Ready for cleanup txn.scan.committed_count=1 txn.scan.committed_ids=[txn_committed]
[TXN-SCAN] 2025/10/11 00:54:15 NOTE: Recovery disabled txn.scan.recovery_action=none txn.cleanup_policy=pending_step8
--- PASS: TestScanWithTransactions (0.00s)
=== RUN   TestCheckTransactionState
=== RUN   TestCheckTransactionState/committed
=== RUN   TestCheckTransactionState/intent_only
=== RUN   TestCheckTransactionState/incomplete_with_manifest
=== RUN   TestCheckTransactionState/incomplete_with_stage
=== RUN   TestCheckTransactionState/abandoned
--- PASS: TestCheckTransactionState (0.00s)
    --- PASS: TestCheckTransactionState/committed (0.00s)
    --- PASS: TestCheckTransactionState/intent_only (0.00s)
    --- PASS: TestCheckTransactionState/incomplete_with_manifest (0.00s)
    --- PASS: TestCheckTransactionState/incomplete_with_stage (0.00s)
    --- PASS: TestCheckTransactionState/abandoned (0.00s)
=== RUN   TestFormatTxnIDs
=== RUN   TestFormatTxnIDs/empty
=== RUN   TestFormatTxnIDs/single
=== RUN   TestFormatTxnIDs/three
=== RUN   TestFormatTxnIDs/many
--- PASS: TestFormatTxnIDs (0.00s)
    --- PASS: TestFormatTxnIDs/empty (0.00s)
    --- PASS: TestFormatTxnIDs/single (0.00s)
    --- PASS: TestFormatTxnIDs/three (0.00s)
    --- PASS: TestFormatTxnIDs/many (0.00s)
=== RUN   TestScanWithErrors
[TXN-SCAN] 2025/10/11 00:54:15 WARN: Found abandoned transaction txn.id=good_txn txn.state=abandoned txn.markers=none
[TXN-SCAN] 2025/10/11 00:54:15 SUMMARY: Transaction scan complete txn.scan.total=1 txn.scan.timestamp=2025-10-10T15:54:15Z
[TXN-SCAN] 2025/10/11 00:54:15   - Abandoned transactions txn.scan.abandoned_count=1 txn.scan.abandoned_ids=[good_txn]
[TXN-SCAN] 2025/10/11 00:54:15 NOTE: Recovery disabled txn.scan.recovery_action=none txn.cleanup_policy=pending_step8
--- PASS: TestScanWithErrors (0.00s)
=== RUN   TestTransactionLifecycle
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_test_3974397693/.deespec/var/txn/txn_1760111655_311138000/stage/test/file.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_test_3974397693/.deespec/var/txn/txn_1760111655_311138000/stage/test/file.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_test_3974397693/test/file.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

--- PASS: TestTransactionLifecycle (0.06s)
=== RUN   TestTransactionStateValidation
=== RUN   TestTransactionStateValidation/Cannot_commit_without_intent
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_validation_2831355357/.deespec/var/txn/txn_1760111655_372810000/stage/dummy.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

=== RUN   TestTransactionStateValidation/Cannot_stage_after_intent
=== RUN   TestTransactionStateValidation/Cannot_mark_intent_twice
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_validation_2831355357/.deespec/var/txn/txn_1760111655_372810000/stage/dummy.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_validation_2831355357/dummy.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1760111655_372810000

=== RUN   TestTransactionStateValidation/Idempotent_commit
INFO: Transaction already committed (no-op) txn.commit.idempotent=true txn.id=txn_1760111655_372810000

=== RUN   TestTransactionStateValidation/Cannot_cleanup_uncommitted_transaction
--- PASS: TestTransactionStateValidation (0.07s)
    --- PASS: TestTransactionStateValidation/Cannot_commit_without_intent (0.00s)
    --- PASS: TestTransactionStateValidation/Cannot_stage_after_intent (0.00s)
    --- PASS: TestTransactionStateValidation/Cannot_mark_intent_twice (0.00s)
    --- PASS: TestTransactionStateValidation/Idempotent_commit (0.00s)
    --- PASS: TestTransactionStateValidation/Cannot_cleanup_uncommitted_transaction (0.01s)
=== RUN   TestMultipleFileStaging
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_multi_1760051886/.deespec/var/txn/txn_1760111655_442515000/stage/dir1/file1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_multi_1760051886/.deespec/var/txn/txn_1760111655_442515000/stage/dir1/file2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_multi_1760051886/.deespec/var/txn/txn_1760111655_442515000/stage/dir2/file3.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=4ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_multi_1760051886/.deespec/var/txn/txn_1760111655_442515000/stage/dir1/file1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_multi_1760051886/.deespec/var/txn/txn_1760111655_442515000/stage/dir1/file2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_multi_1760051886/.deespec/var/txn/txn_1760111655_442515000/stage/dir2/file3.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_multi_1760051886/dir1/file1.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_multi_1760051886/dir1/file2.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_multi_1760051886/dir2/file3.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1760111655_442515000

--- PASS: TestMultipleFileStaging (0.12s)
=== RUN   TestManifestValidation
--- PASS: TestManifestValidation (0.02s)
=== RUN   TestIntentMarkerFormat
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_format_1333243240/.deespec/var/txn/txn_1760111655_582442000/stage/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

--- PASS: TestIntentMarkerFormat (0.04s)
=== RUN   TestCommitMarkerFormat
INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_commit_1616290252/.deespec/var/txn/txn_1760111655_621531000/stage/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_commit_1616290252/.deespec/var/txn/txn_1760111655_621531000/stage/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/txn_commit_1616290252/test.txt txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

WARN: Forward recovery without journal callback for txn_1760111655_621531000

--- PASS: TestCommitMarkerFormat (0.06s)
=== RUN   TestTxnStatus
--- PASS: TestTxnStatus (0.00s)
=== RUN   TestStatusIsValid
=== RUN   TestStatusIsValid/Valid_PENDING
=== RUN   TestStatusIsValid/Valid_INTENT
=== RUN   TestStatusIsValid/Valid_COMMIT
=== RUN   TestStatusIsValid/Valid_ABORTED
=== RUN   TestStatusIsValid/Valid_FAILED
=== RUN   TestStatusIsValid/Invalid_empty
=== RUN   TestStatusIsValid/Invalid_unknown
=== RUN   TestStatusIsValid/Invalid_lowercase
--- PASS: TestStatusIsValid (0.00s)
    --- PASS: TestStatusIsValid/Valid_PENDING (0.00s)
    --- PASS: TestStatusIsValid/Valid_INTENT (0.00s)
    --- PASS: TestStatusIsValid/Valid_COMMIT (0.00s)
    --- PASS: TestStatusIsValid/Valid_ABORTED (0.00s)
    --- PASS: TestStatusIsValid/Valid_FAILED (0.00s)
    --- PASS: TestStatusIsValid/Invalid_empty (0.00s)
    --- PASS: TestStatusIsValid/Invalid_unknown (0.00s)
    --- PASS: TestStatusIsValid/Invalid_lowercase (0.00s)
=== RUN   TestStatusUnmarshalJSON
=== RUN   TestStatusUnmarshalJSON/Valid_PENDING
=== RUN   TestStatusUnmarshalJSON/Valid_INTENT
=== RUN   TestStatusUnmarshalJSON/Valid_COMMIT
=== RUN   TestStatusUnmarshalJSON/Valid_ABORTED
=== RUN   TestStatusUnmarshalJSON/Valid_FAILED
=== RUN   TestStatusUnmarshalJSON/Invalid_unknown
=== RUN   TestStatusUnmarshalJSON/Invalid_lowercase
=== RUN   TestStatusUnmarshalJSON/Invalid_format
=== RUN   TestStatusUnmarshalJSON/Invalid_empty
--- PASS: TestStatusUnmarshalJSON (0.00s)
    --- PASS: TestStatusUnmarshalJSON/Valid_PENDING (0.00s)
    --- PASS: TestStatusUnmarshalJSON/Valid_INTENT (0.00s)
    --- PASS: TestStatusUnmarshalJSON/Valid_COMMIT (0.00s)
    --- PASS: TestStatusUnmarshalJSON/Valid_ABORTED (0.00s)
    --- PASS: TestStatusUnmarshalJSON/Valid_FAILED (0.00s)
    --- PASS: TestStatusUnmarshalJSON/Invalid_unknown (0.00s)
    --- PASS: TestStatusUnmarshalJSON/Invalid_lowercase (0.00s)
    --- PASS: TestStatusUnmarshalJSON/Invalid_format (0.00s)
    --- PASS: TestStatusUnmarshalJSON/Invalid_empty (0.00s)
=== RUN   TestFileOperation
--- PASS: TestFileOperation (0.00s)
=== RUN   TestFileOperationValidate
=== RUN   TestFileOperationValidate/Valid_create_operation
=== RUN   TestFileOperationValidate/Valid_rename_operation
=== RUN   TestFileOperationValidate/Missing_type
=== RUN   TestFileOperationValidate/Invalid_type
=== RUN   TestFileOperationValidate/Missing_destination
=== RUN   TestFileOperationValidate/Rename_missing_source
--- PASS: TestFileOperationValidate (0.00s)
    --- PASS: TestFileOperationValidate/Valid_create_operation (0.00s)
    --- PASS: TestFileOperationValidate/Valid_rename_operation (0.00s)
    --- PASS: TestFileOperationValidate/Missing_type (0.00s)
    --- PASS: TestFileOperationValidate/Invalid_type (0.00s)
    --- PASS: TestFileOperationValidate/Missing_destination (0.00s)
    --- PASS: TestFileOperationValidate/Rename_missing_source (0.00s)
=== RUN   TestManifest
--- PASS: TestManifest (0.00s)
=== RUN   TestManifestValidate
=== RUN   TestManifestValidate/Valid_manifest
=== RUN   TestManifestValidate/Missing_ID
=== RUN   TestManifestValidate/No_file_operations
=== RUN   TestManifestValidate/Invalid_file_operation
=== RUN   TestManifestValidate/Zero_timestamp
--- PASS: TestManifestValidate (0.00s)
    --- PASS: TestManifestValidate/Valid_manifest (0.00s)
    --- PASS: TestManifestValidate/Missing_ID (0.00s)
    --- PASS: TestManifestValidate/No_file_operations (0.00s)
    --- PASS: TestManifestValidate/Invalid_file_operation (0.00s)
    --- PASS: TestManifestValidate/Zero_timestamp (0.00s)
=== RUN   TestIntent
--- PASS: TestIntent (0.00s)
=== RUN   TestCommit
--- PASS: TestCommit (0.00s)
=== RUN   TestTransaction
--- PASS: TestTransaction (0.00s)
=== RUN   TestRecoveryInfo
--- PASS: TestRecoveryInfo (0.00s)
=== RUN   TestTxnError
--- PASS: TestTxnError (0.00s)
PASS
coverage: 65.4% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/infra/fs/txn	7.767s	coverage: 65.4% of statements
=== RUN   TestWriteFileAtomic
=== RUN   TestWriteFileAtomic/Write_new_file_successfully
=== RUN   TestWriteFileAtomic/Overwrite_existing_file
=== RUN   TestWriteFileAtomic/Write_to_deeply_nested_directory
=== RUN   TestWriteFileAtomic/Write_empty_file
--- PASS: TestWriteFileAtomic (0.00s)
    --- PASS: TestWriteFileAtomic/Write_new_file_successfully (0.00s)
    --- PASS: TestWriteFileAtomic/Overwrite_existing_file (0.00s)
    --- PASS: TestWriteFileAtomic/Write_to_deeply_nested_directory (0.00s)
    --- PASS: TestWriteFileAtomic/Write_empty_file (0.00s)
=== RUN   TestWriteFileAtomic_RenameFailure
--- PASS: TestWriteFileAtomic_RenameFailure (0.00s)
PASS
coverage: 65.0% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/infra/persistence/file	1.280s	coverage: 65.0% of statements
# github.com/YoshitsuguKoike/deespec/internal/infrastructure/di.test
ld: warning: '/private/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/go-link-2526101864/000023.o' has malformed LC_DYSYMTAB, expected 98 undefined symbols to start at index 1626, found 95 undefined symbols starting at index 1626
=== RUN   TestContainer_LockServiceIntegration
--- PASS: TestContainer_LockServiceIntegration (0.27s)
=== RUN   TestContainer_LockServiceCleanup
--- PASS: TestContainer_LockServiceCleanup (1.51s)
=== RUN   TestContainer_DefaultConfiguration
--- PASS: TestContainer_DefaultConfiguration (0.01s)
=== RUN   TestContainer_CloseStopsLockService
--- PASS: TestContainer_CloseStopsLockService (0.01s)
=== RUN   TestContainer_MultipleLocksSimultaneously
--- PASS: TestContainer_MultipleLocksSimultaneously (0.01s)
=== RUN   TestContainer_LockConflict
--- PASS: TestContainer_LockConflict (0.02s)
=== RUN   TestContainer_WALModeEnabled
--- PASS: TestContainer_WALModeEnabled (0.01s)
=== RUN   TestContainer_ConcurrentAccess
--- PASS: TestContainer_ConcurrentAccess (0.01s)
PASS
coverage: 51.7% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/infrastructure/di	3.146s	coverage: 51.7% of statements
# github.com/YoshitsuguKoike/deespec/internal/infrastructure/persistence/sqlite.test
ld: warning: '/private/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/go-link-2434463547/000023.o' has malformed LC_DYSYMTAB, expected 98 undefined symbols to start at index 1626, found 95 undefined symbols starting at index 1626
=== RUN   TestMigration_NewDatabase
--- PASS: TestMigration_NewDatabase (0.00s)
=== RUN   TestMigration_ExistingDatabase
    migration_test.go:224: Backfilled data: sequence=1, registered_at=2025-10-10T15:54:26Z
--- PASS: TestMigration_ExistingDatabase (0.00s)
=== RUN   TestRunLockRepository_AcquireAndRelease
--- PASS: TestRunLockRepository_AcquireAndRelease (0.00s)
=== RUN   TestRunLockRepository_Find
--- PASS: TestRunLockRepository_Find (0.00s)
=== RUN   TestRunLockRepository_Find_NotFound
--- PASS: TestRunLockRepository_Find_NotFound (0.00s)
=== RUN   TestRunLockRepository_UpdateHeartbeat
--- PASS: TestRunLockRepository_UpdateHeartbeat (1.06s)
=== RUN   TestRunLockRepository_Extend
--- PASS: TestRunLockRepository_Extend (0.04s)
=== RUN   TestRunLockRepository_CleanupExpired
--- PASS: TestRunLockRepository_CleanupExpired (2.02s)
=== RUN   TestRunLockRepository_List
--- PASS: TestRunLockRepository_List (0.00s)
=== RUN   TestRunLockRepository_AcquireExpiredLock
--- PASS: TestRunLockRepository_AcquireExpiredLock (2.01s)
=== RUN   TestStateLockRepository_AcquireAndRelease
--- PASS: TestStateLockRepository_AcquireAndRelease (0.00s)
=== RUN   TestStateLockRepository_Find
--- PASS: TestStateLockRepository_Find (0.00s)
=== RUN   TestStateLockRepository_Find_NotFound
--- PASS: TestStateLockRepository_Find_NotFound (0.00s)
=== RUN   TestStateLockRepository_UpdateHeartbeat
--- PASS: TestStateLockRepository_UpdateHeartbeat (1.00s)
=== RUN   TestStateLockRepository_Extend
--- PASS: TestStateLockRepository_Extend (0.00s)
=== RUN   TestStateLockRepository_CleanupExpired
--- PASS: TestStateLockRepository_CleanupExpired (2.01s)
=== RUN   TestStateLockRepository_List
--- PASS: TestStateLockRepository_List (0.00s)
=== RUN   TestStateLockRepository_AcquireExpiredLock
--- PASS: TestStateLockRepository_AcquireExpiredLock (2.01s)
=== RUN   TestStateLockRepository_ReadWriteLockTypes
--- PASS: TestStateLockRepository_ReadWriteLockTypes (0.01s)
PASS
coverage: 21.5% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/infrastructure/persistence/sqlite	11.591s	coverage: 21.5% of statements
	github.com/YoshitsuguKoike/deespec/internal/infrastructure/repository		coverage: 0.0% of statements
	github.com/YoshitsuguKoike/deespec/internal/infrastructure/repository/mock		coverage: 0.0% of statements
=== RUN   TestExecuteRegisterTransaction
INFO: Checksum validation successful txn.checksum.validation.success=.deespec/var/txn/txn_1760111679_983297000/stage/specs/test-001_test_specification/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=.deespec/var/txn/txn_1760111679_983297000/stage/specs/test-001_test_specification/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=.deespec/var/txn/txn_1760111679_983297000/stage/specs/test-001_test_specification/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=.deespec/var/txn/txn_1760111679_983297000/stage/specs/test-001_test_specification/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=.deespec/specs/test-001_test_specification/meta.yaml txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

INFO: Checksum validation successful txn.checksum.validation.success=.deespec/specs/test-001_test_specification/spec.md txn.checksum.algorithm=sha256 txn.checksum.calculation.duration_ms=0ms

--- PASS: TestExecuteRegisterTransaction (0.09s)
=== RUN   TestExecuteRegisterTransactionFailure
--- PASS: TestExecuteRegisterTransactionFailure (0.00s)
=== RUN   TestExecuteRegisterTransactionEmptySpecPath
--- PASS: TestExecuteRegisterTransactionEmptySpecPath (0.00s)
PASS
coverage: 39.4% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/infrastructure/transaction	1.325s	coverage: 39.4% of statements
# github.com/YoshitsuguKoike/deespec/internal/interface/cli.test
ld: warning: '/private/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/go-link-1493551917/000023.o' has malformed LC_DYSYMTAB, expected 98 undefined symbols to start at index 1626, found 95 undefined symbols starting at index 1626
=== RUN   TestPackageLeaks
--- PASS: TestPackageLeaks (0.00s)
PASS
coverage: 0.0% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/interface/cli	1.281s	coverage: 0.0% of statements
=== RUN   TestLoadExternalPrompt_Success
=== RUN   TestLoadExternalPrompt_Success/WIP_status_loads_WIP.md
=== RUN   TestLoadExternalPrompt_Success/READY_status_loads_WIP.md
=== RUN   TestLoadExternalPrompt_Success/REVIEW_status_loads_REVIEW.md
=== RUN   TestLoadExternalPrompt_Success/REVIEW&WIP_status_loads_REVIEW_AND_WIP.md
--- PASS: TestLoadExternalPrompt_Success (0.00s)
    --- PASS: TestLoadExternalPrompt_Success/WIP_status_loads_WIP.md (0.00s)
    --- PASS: TestLoadExternalPrompt_Success/READY_status_loads_WIP.md (0.00s)
    --- PASS: TestLoadExternalPrompt_Success/REVIEW_status_loads_REVIEW.md (0.00s)
    --- PASS: TestLoadExternalPrompt_Success/REVIEW&WIP_status_loads_REVIEW_AND_WIP.md (0.00s)
=== RUN   TestLoadExternalPrompt_FileNotFound
=== RUN   TestLoadExternalPrompt_FileNotFound/Missing_file_for_WIP
=== RUN   TestLoadExternalPrompt_FileNotFound/Missing_file_for_REVIEW
=== RUN   TestLoadExternalPrompt_FileNotFound/Missing_file_for_REVIEW&WIP
--- PASS: TestLoadExternalPrompt_FileNotFound (0.00s)
    --- PASS: TestLoadExternalPrompt_FileNotFound/Missing_file_for_WIP (0.00s)
    --- PASS: TestLoadExternalPrompt_FileNotFound/Missing_file_for_REVIEW (0.00s)
    --- PASS: TestLoadExternalPrompt_FileNotFound/Missing_file_for_REVIEW&WIP (0.00s)
=== RUN   TestLoadExternalPrompt_InvalidStatus
--- PASS: TestLoadExternalPrompt_InvalidStatus (0.00s)
=== RUN   TestLoadExternalPrompt_FileDeleted
--- PASS: TestLoadExternalPrompt_FileDeleted (0.00s)
=== RUN   TestPlaceholderReplacement
--- PASS: TestPlaceholderReplacement (0.00s)
PASS
coverage: 36.0% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/interface/cli/claude_prompt	1.231s	coverage: 36.0% of statements
# github.com/YoshitsuguKoike/deespec/internal/interface/cli/clear.test
ld: warning: '/private/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/go-link-140623769/000023.o' has malformed LC_DYSYMTAB, expected 98 undefined symbols to start at index 1626, found 95 undefined symbols starting at index 1626
=== RUN   TestClear
=== RUN   TestClear/successful_clear_without_WIP
[00:54:45.917] WARN: LoadState is deprecated - DB-based state management should be used instead
[00:54:45.917] INFO: Creating archive at: .deespec/archives/2025-10-11T00-54-45_01K77D9W8X2G3QPAVDRQ9FQHW9
[00:54:45.917] INFO: Archived journal.ndjson
[00:54:45.918] INFO: Moved 1 items from specs to archive
[00:54:45.918] WARN: SaveStateCAS is deprecated - DB-based state management should be used instead
[00:54:45.918] INFO: Reset state files
[00:54:45.918] INFO: Clear completed successfully. Archive created at: .deespec/archives/2025-10-11T00-54-45_01K77D9W8X2G3QPAVDRQ9FQHW9
[00:54:45.918] WARN: LoadState is deprecated - DB-based state management should be used instead
--- PASS: TestClear (0.00s)
    --- PASS: TestClear/successful_clear_without_WIP (0.00s)
=== RUN   TestClear_WithWIP
=== RUN   TestClear_WithWIP/WIP_without_lease_should_succeed
[00:54:45.920] WARN: LoadState is deprecated - DB-based state management should be used instead
[00:54:45.920] WARN: Clearing with WIP but no lease (WIP: TASK-001 may be stale)
[00:54:45.920] INFO: Creating archive at: .deespec/archives/2025-10-11T00-54-45_01K77D9W904M6HX30T7Y09S0B1
[00:54:45.920] INFO: No journal.ndjson to archive
[00:54:45.920] INFO: No specs directory to archive
[00:54:45.920] WARN: SaveStateCAS is deprecated - DB-based state management should be used instead
[00:54:45.920] INFO: Reset state files
[00:54:45.920] INFO: Clear completed successfully. Archive created at: .deespec/archives/2025-10-11T00-54-45_01K77D9W904M6HX30T7Y09S0B1
=== RUN   TestClear_WithWIP/WIP_with_active_lease_should_fail
[00:54:45.920] WARN: LoadState is deprecated - DB-based state management should be used instead
[00:54:45.920] WARN: LeaseExpired is deprecated - use lock service instead
--- PASS: TestClear_WithWIP (0.00s)
    --- PASS: TestClear_WithWIP/WIP_without_lease_should_succeed (0.00s)
    --- PASS: TestClear_WithWIP/WIP_with_active_lease_should_fail (0.00s)
=== RUN   TestClear_WithActiveLease
[00:54:45.921] WARN: LoadState is deprecated - DB-based state management should be used instead
[00:54:45.921] WARN: LeaseExpired is deprecated - use lock service instead
--- PASS: TestClear_WithActiveLease (0.00s)
=== RUN   TestClear_NoState
[00:54:45.922] WARN: LoadState is deprecated - DB-based state management should be used instead
[00:54:45.922] INFO: Creating archive at: .deespec/archives/2025-10-11T00-54-45_01K77D9W92ZFFEB4DZ53GY3HV6
[00:54:45.922] INFO: No journal.ndjson to archive
[00:54:45.922] INFO: No specs directory to archive
[00:54:45.922] WARN: SaveStateCAS is deprecated - DB-based state management should be used instead
[00:54:45.923] INFO: Reset state files
[00:54:45.923] INFO: Clear completed successfully. Archive created at: .deespec/archives/2025-10-11T00-54-45_01K77D9W92ZFFEB4DZ53GY3HV6
--- PASS: TestClear_NoState (0.00s)
=== RUN   TestArchiveJournal
[00:54:45.924] INFO: Archived journal.ndjson
--- PASS: TestArchiveJournal (0.00s)
=== RUN   TestArchiveJournal_NoFile
[00:54:45.924] INFO: No journal.ndjson to archive
--- PASS: TestArchiveJournal_NoFile (0.00s)
=== RUN   TestArchiveSpecs
[00:54:45.925] INFO: Moved 1 items from specs to archive
--- PASS: TestArchiveSpecs (0.00s)
=== RUN   TestArchiveSpecs_NoSpecs
[00:54:45.926] INFO: No specs directory to archive
--- PASS: TestArchiveSpecs_NoSpecs (0.00s)
PASS
coverage: 42.3% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/interface/cli/clear	1.261s	coverage: 42.3% of statements
# github.com/YoshitsuguKoike/deespec/internal/interface/cli/common.test
ld: warning: '/private/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/go-link-4272962231/000023.o' has malformed LC_DYSYMTAB, expected 98 undefined symbols to start at index 1626, found 95 undefined symbols starting at index 1626
=== RUN   TestStateHelpers
--- PASS: TestStateHelpers (0.00s)
=== RUN   TestStateIO
[00:54:47.821] WARN: LoadState is deprecated - DB-based state management should be used instead
--- PASS: TestStateIO (0.00s)
=== RUN   TestLoggerFunctions
[00:54:47.821] INFO: Test info message arg
[00:54:47.821] WARN: Test warning message 42
[00:54:47.821] ERROR: Test error message
[00:54:47.821] DEBUG: Debug level message
[00:54:47.821] WARN: Warn level message
[00:54:47.821] ERROR: Error level message
--- PASS: TestLoggerFunctions (0.00s)
PASS
coverage: 27.0% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/interface/cli/common	1.253s	coverage: 27.0% of statements
# github.com/YoshitsuguKoike/deespec/internal/interface/cli/doctor.test
ld: warning: '/private/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/go-link-2384065287/000023.o' has malformed LC_DYSYMTAB, expected 98 undefined symbols to start at index 1626, found 95 undefined symbols starting at index 1626
=== RUN   TestDoctorPromptValidation
=== RUN   TestDoctorPromptValidation/all_prompts_exist_and_readable
=== RUN   TestDoctorPromptValidation/prompt_file_missing
=== RUN   TestDoctorPromptValidation/prompt_path_is_directory
--- PASS: TestDoctorPromptValidation (0.00s)
    --- PASS: TestDoctorPromptValidation/all_prompts_exist_and_readable (0.00s)
    --- PASS: TestDoctorPromptValidation/prompt_file_missing (0.00s)
    --- PASS: TestDoctorPromptValidation/prompt_path_is_directory (0.00s)
=== RUN   TestDoctorPromptSizeAndEncoding
=== RUN   TestDoctorPromptSizeAndEncoding/prompt_within_size_limit
=== RUN   TestDoctorPromptSizeAndEncoding/prompt_exceeds_size_limit
=== RUN   TestDoctorPromptSizeAndEncoding/UTF-8_BOM_warning
=== RUN   TestDoctorPromptSizeAndEncoding/CRLF_warning
=== RUN   TestDoctorPromptSizeAndEncoding/invalid_UTF-8
--- PASS: TestDoctorPromptSizeAndEncoding (0.01s)
    --- PASS: TestDoctorPromptSizeAndEncoding/prompt_within_size_limit (0.00s)
    --- PASS: TestDoctorPromptSizeAndEncoding/prompt_exceeds_size_limit (0.00s)
    --- PASS: TestDoctorPromptSizeAndEncoding/UTF-8_BOM_warning (0.00s)
    --- PASS: TestDoctorPromptSizeAndEncoding/CRLF_warning (0.00s)
    --- PASS: TestDoctorPromptSizeAndEncoding/invalid_UTF-8 (0.00s)
=== RUN   TestDoctorPlaceholderValidation
=== RUN   TestDoctorPlaceholderValidation/valid_placeholders_only
=== RUN   TestDoctorPlaceholderValidation/empty_placeholder
=== RUN   TestDoctorPlaceholderValidation/unknown_placeholder
=== RUN   TestDoctorPlaceholderValidation/placeholder_in_fenced_code_block_(ignored)
=== RUN   TestDoctorPlaceholderValidation/placeholder_in_inline_code_(ignored)
=== RUN   TestDoctorPlaceholderValidation/escaped_placeholder_(ignored)
=== RUN   TestDoctorPlaceholderValidation/mustache_template_(warning)
=== RUN   TestDoctorPlaceholderValidation/invalid_identifier
=== RUN   TestDoctorPlaceholderValidation/whitespace_placeholder
--- PASS: TestDoctorPlaceholderValidation (0.00s)
    --- PASS: TestDoctorPlaceholderValidation/valid_placeholders_only (0.00s)
    --- PASS: TestDoctorPlaceholderValidation/empty_placeholder (0.00s)
    --- PASS: TestDoctorPlaceholderValidation/unknown_placeholder (0.00s)
    --- PASS: TestDoctorPlaceholderValidation/placeholder_in_fenced_code_block_(ignored) (0.00s)
    --- PASS: TestDoctorPlaceholderValidation/placeholder_in_inline_code_(ignored) (0.00s)
    --- PASS: TestDoctorPlaceholderValidation/escaped_placeholder_(ignored) (0.00s)
    --- PASS: TestDoctorPlaceholderValidation/mustache_template_(warning) (0.00s)
    --- PASS: TestDoctorPlaceholderValidation/invalid_identifier (0.00s)
    --- PASS: TestDoctorPlaceholderValidation/whitespace_placeholder (0.00s)
=== RUN   TestDoctorRemoveCodeBlocks
=== RUN   TestDoctorRemoveCodeBlocks/remove_fenced_code_block
=== RUN   TestDoctorRemoveCodeBlocks/remove_inline_code
=== RUN   TestDoctorRemoveCodeBlocks/remove_escaped_braces
=== RUN   TestDoctorRemoveCodeBlocks/mixed_content
--- PASS: TestDoctorRemoveCodeBlocks (0.00s)
    --- PASS: TestDoctorRemoveCodeBlocks/remove_fenced_code_block (0.00s)
    --- PASS: TestDoctorRemoveCodeBlocks/remove_inline_code (0.00s)
    --- PASS: TestDoctorRemoveCodeBlocks/remove_escaped_braces (0.00s)
    --- PASS: TestDoctorRemoveCodeBlocks/mixed_content (0.00s)
=== RUN   TestDoctorPromptValidationIntegration
    doctor_test.go:576: Integration test skipped - os.Exit() behavior is difficult to test in unit tests
--- SKIP: TestDoctorPromptValidationIntegration (0.00s)
=== RUN   TestValidatePlaceholders
=== RUN   TestValidatePlaceholders/No_placeholders
=== RUN   TestValidatePlaceholders/Valid_placeholders
=== RUN   TestValidatePlaceholders/Empty_template
--- PASS: TestValidatePlaceholders (0.00s)
    --- PASS: TestValidatePlaceholders/No_placeholders (0.00s)
    --- PASS: TestValidatePlaceholders/Valid_placeholders (0.00s)
    --- PASS: TestValidatePlaceholders/Empty_template (0.00s)
=== RUN   TestContains
=== RUN   TestContains/Substring_exists
=== RUN   TestContains/Substring_doesn't_exist
=== RUN   TestContains/Empty_string
=== RUN   TestContains/Empty_substring
=== RUN   TestContains/Case_sensitive
--- PASS: TestContains (0.00s)
    --- PASS: TestContains/Substring_exists (0.00s)
    --- PASS: TestContains/Substring_doesn't_exist (0.00s)
    --- PASS: TestContains/Empty_string (0.00s)
    --- PASS: TestContains/Empty_substring (0.00s)
    --- PASS: TestContains/Case_sensitive (0.00s)
=== RUN   TestContainsHelper
=== RUN   TestContainsHelper/Substring_exists
=== RUN   TestContainsHelper/Substring_doesn't_exist
=== RUN   TestContainsHelper/Empty_substring
=== RUN   TestContainsHelper/Empty_string
=== RUN   TestContainsHelper/Full_match
--- PASS: TestContainsHelper (0.00s)
    --- PASS: TestContainsHelper/Substring_exists (0.00s)
    --- PASS: TestContainsHelper/Substring_doesn't_exist (0.00s)
    --- PASS: TestContainsHelper/Empty_substring (0.00s)
    --- PASS: TestContainsHelper/Empty_string (0.00s)
    --- PASS: TestContainsHelper/Full_match (0.00s)
PASS
coverage: 7.0% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/interface/cli/doctor	0.265s	coverage: 7.0% of statements
	github.com/YoshitsuguKoike/deespec/internal/interface/cli/health		coverage: 0.0% of statements
	github.com/YoshitsuguKoike/deespec/internal/interface/cli/init		coverage: 0.0% of statements
	github.com/YoshitsuguKoike/deespec/internal/interface/cli/journal		coverage: 0.0% of statements
# github.com/YoshitsuguKoike/deespec/internal/interface/cli/label.test
ld: warning: '/private/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/go-link-179052216/000023.o' has malformed LC_DYSYMTAB, expected 98 undefined symbols to start at index 1626, found 95 undefined symbols starting at index 1626
=== RUN   TestLabelE2E
=== RUN   TestLabelE2E/Register
=== RUN   TestLabelE2E/FindByName
=== RUN   TestLabelE2E/ListActive
=== RUN   TestLabelE2E/Update
=== RUN   TestLabelE2E/ValidateIntegrity
=== RUN   TestLabelE2E/Deactivate
=== RUN   TestLabelE2E/Delete
--- PASS: TestLabelE2E (0.01s)
    --- PASS: TestLabelE2E/Register (0.00s)
    --- PASS: TestLabelE2E/FindByName (0.00s)
    --- PASS: TestLabelE2E/ListActive (0.00s)
    --- PASS: TestLabelE2E/Update (0.00s)
    --- PASS: TestLabelE2E/ValidateIntegrity (0.00s)
    --- PASS: TestLabelE2E/Deactivate (0.00s)
    --- PASS: TestLabelE2E/Delete (0.00s)
PASS
coverage: 0.0% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/interface/cli/label	1.483s	coverage: 0.0% of statements
	github.com/YoshitsuguKoike/deespec/internal/interface/cli/lock_cmd		coverage: 0.0% of statements
# github.com/YoshitsuguKoike/deespec/internal/interface/cli/register.test
ld: warning: '/private/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/go-link-1999814680/000023.o' has malformed LC_DYSYMTAB, expected 98 undefined symbols to start at index 1626, found 95 undefined symbols starting at index 1626
=== RUN   TestDryRun_NoSideEffects
--- PASS: TestDryRun_NoSideEffects (0.01s)
=== RUN   TestDryRun_Precedence
--- PASS: TestDryRun_Precedence (0.00s)
=== RUN   TestDryRun_CollisionErrorMode_Fails
    dry_run_test.go:138: Created collision path: .deespec/specs/sbi/TEST-COLL-001_test
    dry_run_test.go:184: Dry-run resolution:
    dry_run_test.go:185:   BaseDir: .deespec/specs/sbi
    dry_run_test.go:186:   Slug: test
    dry_run_test.go:187:   SpecPath: .deespec/specs/sbi/TEST-COLL-001_test
    dry_run_test.go:188:   FinalPath: .deespec/specs/sbi/TEST-COLL-001_test
    dry_run_test.go:189:   Collision detected: true
--- PASS: TestDryRun_CollisionErrorMode_Fails (0.00s)
=== RUN   TestDryRun_CollisionSuffixMode_Succeeds
--- PASS: TestDryRun_CollisionSuffixMode_Succeeds (0.00s)
=== RUN   TestDryRun_PathSafety
--- PASS: TestDryRun_PathSafety (0.00s)
=== RUN   TestDryRun_JournalPreviewSchema
INFO: no policy file found, using defaults
--- PASS: TestDryRun_JournalPreviewSchema (0.00s)
=== RUN   TestDryRun_OutputSchemaStable
INFO: no policy file found, using defaults
INFO: no policy file found, using defaults
INFO: no policy file found, using defaults
--- PASS: TestDryRun_OutputSchemaStable (0.00s)
=== RUN   TestDryRun_StderrLevel
--- PASS: TestDryRun_StderrLevel (0.00s)
=== RUN   TestPrintEffectiveConfig_NoPolicy_Defaults
--- PASS: TestPrintEffectiveConfig_NoPolicy_Defaults (0.00s)
=== RUN   TestPrintEffectiveConfig_PolicyAndCLI_Precedence
--- PASS: TestPrintEffectiveConfig_PolicyAndCLI_Precedence (0.00s)
=== RUN   TestPrintEffectiveConfig_FormatCompact
--- PASS: TestPrintEffectiveConfig_FormatCompact (0.00s)
=== RUN   TestPrintEffectiveConfig_InvalidPolicy
--- PASS: TestPrintEffectiveConfig_InvalidPolicy (0.00s)
=== RUN   TestEffectiveConfig_ContainsPathInputs
--- PASS: TestEffectiveConfig_ContainsPathInputs (0.00s)
=== RUN   TestEffectiveConfig_StableKeyOrder
--- PASS: TestEffectiveConfig_StableKeyOrder (0.00s)
=== RUN   TestEffectiveConfig_MetadataFields
--- PASS: TestEffectiveConfig_MetadataFields (0.00s)
=== RUN   TestRunPrintEffectiveConfig_Integration
--- PASS: TestRunPrintEffectiveConfig_Integration (0.00s)
=== RUN   TestSlugifyTitle
=== RUN   TestSlugifyTitle/simple
=== RUN   TestSlugifyTitle/with_numbers
=== RUN   TestSlugifyTitle/with_hyphens
=== RUN   TestSlugifyTitle/japanese
=== RUN   TestSlugifyTitle/mixed
=== RUN   TestSlugifyTitle/full-width
=== RUN   TestSlugifyTitle/special_chars
=== RUN   TestSlugifyTitle/spaces
=== RUN   TestSlugifyTitle/leading/trailing
=== RUN   TestSlugifyTitle/empty
=== RUN   TestSlugifyTitle/all_special
=== RUN   TestSlugifyTitle/dots_and_spaces
=== RUN   TestSlugifyTitle/con
=== RUN   TestSlugifyTitle/prn
=== RUN   TestSlugifyTitle/aux
=== RUN   TestSlugifyTitle/com1
=== RUN   TestSlugifyTitle/lpt9
=== RUN   TestSlugifyTitle/long_title
=== RUN   TestSlugifyTitle/long_with_dash
--- PASS: TestSlugifyTitle (0.02s)
    --- PASS: TestSlugifyTitle/simple (0.00s)
    --- PASS: TestSlugifyTitle/with_numbers (0.00s)
    --- PASS: TestSlugifyTitle/with_hyphens (0.00s)
    --- PASS: TestSlugifyTitle/japanese (0.00s)
    --- PASS: TestSlugifyTitle/mixed (0.00s)
    --- PASS: TestSlugifyTitle/full-width (0.00s)
    --- PASS: TestSlugifyTitle/special_chars (0.00s)
    --- PASS: TestSlugifyTitle/spaces (0.00s)
    --- PASS: TestSlugifyTitle/leading/trailing (0.00s)
    --- PASS: TestSlugifyTitle/empty (0.00s)
    --- PASS: TestSlugifyTitle/all_special (0.00s)
    --- PASS: TestSlugifyTitle/dots_and_spaces (0.00s)
    --- PASS: TestSlugifyTitle/con (0.00s)
    --- PASS: TestSlugifyTitle/prn (0.00s)
    --- PASS: TestSlugifyTitle/aux (0.00s)
    --- PASS: TestSlugifyTitle/com1 (0.00s)
    --- PASS: TestSlugifyTitle/lpt9 (0.00s)
    --- PASS: TestSlugifyTitle/long_title (0.00s)
    --- PASS: TestSlugifyTitle/long_with_dash (0.00s)
=== RUN   TestIsWindowsReserved
=== RUN   TestIsWindowsReserved/con_lower
=== RUN   TestIsWindowsReserved/CON_upper
=== RUN   TestIsWindowsReserved/CoN_mixed
=== RUN   TestIsWindowsReserved/prn
=== RUN   TestIsWindowsReserved/aux
=== RUN   TestIsWindowsReserved/nul
=== RUN   TestIsWindowsReserved/com1
=== RUN   TestIsWindowsReserved/com9
=== RUN   TestIsWindowsReserved/lpt1
=== RUN   TestIsWindowsReserved/lpt9
=== RUN   TestIsWindowsReserved/not_reserved
=== RUN   TestIsWindowsReserved/not_reserved_com
=== RUN   TestIsWindowsReserved/not_reserved_com10
--- PASS: TestIsWindowsReserved (0.00s)
    --- PASS: TestIsWindowsReserved/con_lower (0.00s)
    --- PASS: TestIsWindowsReserved/CON_upper (0.00s)
    --- PASS: TestIsWindowsReserved/CoN_mixed (0.00s)
    --- PASS: TestIsWindowsReserved/prn (0.00s)
    --- PASS: TestIsWindowsReserved/aux (0.00s)
    --- PASS: TestIsWindowsReserved/nul (0.00s)
    --- PASS: TestIsWindowsReserved/com1 (0.00s)
    --- PASS: TestIsWindowsReserved/com9 (0.00s)
    --- PASS: TestIsWindowsReserved/lpt1 (0.00s)
    --- PASS: TestIsWindowsReserved/lpt9 (0.00s)
    --- PASS: TestIsWindowsReserved/not_reserved (0.00s)
    --- PASS: TestIsWindowsReserved/not_reserved_com (0.00s)
    --- PASS: TestIsWindowsReserved/not_reserved_com10 (0.00s)
=== RUN   TestBuildSafeSpecPath
=== RUN   TestBuildSafeSpecPath/normal_path
=== RUN   TestBuildSafeSpecPath/traversal_attempt_with_..
=== RUN   TestBuildSafeSpecPath/windows_reserved_name
=== RUN   TestBuildSafeSpecPath/very_long_path
=== RUN   TestBuildSafeSpecPath/path_with_slashes_removed
--- PASS: TestBuildSafeSpecPath (0.00s)
    --- PASS: TestBuildSafeSpecPath/normal_path (0.00s)
    --- PASS: TestBuildSafeSpecPath/traversal_attempt_with_.. (0.00s)
    --- PASS: TestBuildSafeSpecPath/windows_reserved_name (0.00s)
    --- PASS: TestBuildSafeSpecPath/very_long_path (0.00s)
    --- PASS: TestBuildSafeSpecPath/path_with_slashes_removed (0.00s)
=== RUN   TestIsPathSafe
=== RUN   TestIsPathSafe/path_within_base
=== RUN   TestIsPathSafe/path_equals_base
=== RUN   TestIsPathSafe/path_outside_base
=== RUN   TestIsPathSafe/path_with_..
--- PASS: TestIsPathSafe (0.00s)
    --- PASS: TestIsPathSafe/path_within_base (0.00s)
    --- PASS: TestIsPathSafe/path_equals_base (0.00s)
    --- PASS: TestIsPathSafe/path_outside_base (0.00s)
    --- PASS: TestIsPathSafe/path_with_.. (0.00s)
=== RUN   TestCheckForSymlinks
=== RUN   TestCheckForSymlinks/path_without_symlinks
=== RUN   TestCheckForSymlinks/path_with_symlink
=== RUN   TestCheckForSymlinks/non-existent_path
--- PASS: TestCheckForSymlinks (0.00s)
    --- PASS: TestCheckForSymlinks/path_without_symlinks (0.00s)
    --- PASS: TestCheckForSymlinks/path_with_symlink (0.00s)
    --- PASS: TestCheckForSymlinks/non-existent_path (0.00s)
=== RUN   TestResolveCollision
=== RUN   TestResolveCollision/error_mode_-_no_collision
=== RUN   TestResolveCollision/error_mode_-_with_collision
=== RUN   TestResolveCollision/suffix_mode_-_no_collision
=== RUN   TestResolveCollision/suffix_mode_-_with_collision
=== RUN   TestResolveCollision/replace_mode_-_no_collision
=== RUN   TestResolveCollision/replace_mode_-_with_collision
=== RUN   TestResolveCollision/invalid_mode
--- PASS: TestResolveCollision (0.01s)
    --- PASS: TestResolveCollision/error_mode_-_no_collision (0.00s)
    --- PASS: TestResolveCollision/error_mode_-_with_collision (0.00s)
    --- PASS: TestResolveCollision/suffix_mode_-_no_collision (0.00s)
    --- PASS: TestResolveCollision/suffix_mode_-_with_collision (0.00s)
    --- PASS: TestResolveCollision/replace_mode_-_no_collision (0.00s)
    --- PASS: TestResolveCollision/replace_mode_-_with_collision (0.00s)
    --- PASS: TestResolveCollision/invalid_mode (0.00s)
=== RUN   TestCollisionSuffixExhaustion
--- PASS: TestCollisionSuffixExhaustion (0.01s)
=== RUN   TestRegisterCommand
=== RUN   TestRegisterCommand/valid_YAML_input_with_new_ID_format
=== RUN   TestRegisterCommand/valid_JSON_input
=== RUN   TestRegisterCommand/new_ID_format_-_uppercase_letters_and_numbers
=== RUN   TestRegisterCommand/invalid_ID_-_lowercase_letters
=== RUN   TestRegisterCommand/invalid_ID_-_special_characters
=== RUN   TestRegisterCommand/ID_too_long
=== RUN   TestRegisterCommand/empty_title
=== RUN   TestRegisterCommand/title_too_long
=== RUN   TestRegisterCommand/labels_with_valid_format
=== RUN   TestRegisterCommand/invalid_label_format_-_uppercase
=== RUN   TestRegisterCommand/duplicate_labels_-_warning
=== RUN   TestRegisterCommand/too_many_labels_-_warning
=== RUN   TestRegisterCommand/unknown_fields
=== RUN   TestRegisterCommand/labels_are_optional
--- PASS: TestRegisterCommand (0.91s)
    --- PASS: TestRegisterCommand/valid_YAML_input_with_new_ID_format (0.16s)
    --- PASS: TestRegisterCommand/valid_JSON_input (0.18s)
    --- PASS: TestRegisterCommand/new_ID_format_-_uppercase_letters_and_numbers (0.09s)
    --- PASS: TestRegisterCommand/invalid_ID_-_lowercase_letters (0.01s)
    --- PASS: TestRegisterCommand/invalid_ID_-_special_characters (0.01s)
    --- PASS: TestRegisterCommand/ID_too_long (0.01s)
    --- PASS: TestRegisterCommand/empty_title (0.01s)
    --- PASS: TestRegisterCommand/title_too_long (0.01s)
    --- PASS: TestRegisterCommand/labels_with_valid_format (0.09s)
    --- PASS: TestRegisterCommand/invalid_label_format_-_uppercase (0.02s)
    --- PASS: TestRegisterCommand/duplicate_labels_-_warning (0.10s)
    --- PASS: TestRegisterCommand/too_many_labels_-_warning (0.08s)
    --- PASS: TestRegisterCommand/unknown_fields (0.01s)
    --- PASS: TestRegisterCommand/labels_are_optional (0.13s)
=== RUN   TestValidationFunctions
=== RUN   TestValidationFunctions/validateID
=== RUN   TestValidationFunctions/validateTitle
=== RUN   TestValidationFunctions/validateLabels
--- PASS: TestValidationFunctions (0.00s)
    --- PASS: TestValidationFunctions/validateID (0.00s)
    --- PASS: TestValidationFunctions/validateTitle (0.00s)
    --- PASS: TestValidationFunctions/validateLabels (0.00s)
=== RUN   TestInputSizeLimit
ERROR: failed to read input: input size exceeds limit of 65536 bytes
--- PASS: TestInputSizeLimit (0.06s)
=== RUN   TestBuildSpecPath
=== RUN   TestBuildSpecPath/Simple_Title
=== RUN   TestBuildSpecPath/Title_With__Multiple___Spaces
=== RUN   TestBuildSpecPath/Title-With-Hyphens
=== RUN   TestBuildSpecPath/Title_With_Underscores
=== RUN   TestBuildSpecPath/Title123With456Numbers
--- PASS: TestBuildSpecPath (0.00s)
    --- PASS: TestBuildSpecPath/Simple_Title (0.00s)
    --- PASS: TestBuildSpecPath/Title_With__Multiple___Spaces (0.00s)
    --- PASS: TestBuildSpecPath/Title-With-Hyphens (0.00s)
    --- PASS: TestBuildSpecPath/Title_With_Underscores (0.00s)
    --- PASS: TestBuildSpecPath/Title123With456Numbers (0.00s)
=== RUN   TestRegisterValidationBehavior
=== RUN   TestRegisterValidationBehavior/Fatal_validation_error_-_both_paths
=== RUN   TestRegisterValidationBehavior/Fatal_validation_error_-_TX_path
=== RUN   TestRegisterValidationBehavior/Duplicate_label_warning_-_non-TX
=== RUN   TestRegisterValidationBehavior/Duplicate_label_warning_-_TX
=== RUN   TestRegisterValidationBehavior/Valid_spec_-_non-TX
=== RUN   TestRegisterValidationBehavior/Valid_spec_-_TX
--- PASS: TestRegisterValidationBehavior (0.02s)
    --- PASS: TestRegisterValidationBehavior/Fatal_validation_error_-_both_paths (0.00s)
    --- PASS: TestRegisterValidationBehavior/Fatal_validation_error_-_TX_path (0.02s)
    --- PASS: TestRegisterValidationBehavior/Duplicate_label_warning_-_non-TX (0.00s)
    --- PASS: TestRegisterValidationBehavior/Duplicate_label_warning_-_TX (0.00s)
    --- PASS: TestRegisterValidationBehavior/Valid_spec_-_non-TX (0.00s)
    --- PASS: TestRegisterValidationBehavior/Valid_spec_-_TX (0.00s)
PASS
coverage: 71.6% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/interface/cli/register	2.573s	coverage: 71.6% of statements
# github.com/YoshitsuguKoike/deespec/internal/interface/cli/run.test
ld: warning: '/private/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/go-link-172872590/000023.o' has malformed LC_DYSYMTAB, expected 98 undefined symbols to start at index 1626, found 95 undefined symbols starting at index 1626
=== RUN   TestParseInterval
=== RUN   TestParseInterval/Empty_string_uses_default
=== RUN   TestParseInterval/Valid_duration
=== RUN   TestParseInterval/Below_minimum_uses_minimum
[00:55:02.371] WARN: Interval 500ms too small, using minimum 1s
=== RUN   TestParseInterval/Above_maximum_uses_maximum
[00:55:02.371] WARN: Interval 1h0m0s too large, using maximum 10m0s
=== RUN   TestParseInterval/Invalid_format
--- PASS: TestParseInterval (0.00s)
    --- PASS: TestParseInterval/Empty_string_uses_default (0.00s)
    --- PASS: TestParseInterval/Valid_duration (0.00s)
    --- PASS: TestParseInterval/Below_minimum_uses_minimum (0.00s)
    --- PASS: TestParseInterval/Above_maximum_uses_maximum (0.00s)
    --- PASS: TestParseInterval/Invalid_format (0.00s)
=== RUN   TestSetupSignalHandler
--- PASS: TestSetupSignalHandler (0.05s)
=== RUN   TestSummarizeText
=== RUN   TestSummarizeText/Short_text
=== RUN   TestSummarizeText/Text_needs_truncation
=== RUN   TestSummarizeText/Empty_text
=== RUN   TestSummarizeText/Exact_line_count
--- PASS: TestSummarizeText (0.00s)
    --- PASS: TestSummarizeText/Short_text (0.00s)
    --- PASS: TestSummarizeText/Text_needs_truncation (0.00s)
    --- PASS: TestSummarizeText/Empty_text (0.00s)
    --- PASS: TestSummarizeText/Exact_line_count (0.00s)
=== RUN   TestBuildImplementPrompt
[00:55:02.425] INFO: Using default prompt (external prompt not found: unknown status: )
--- PASS: TestBuildImplementPrompt (0.00s)
=== RUN   TestBuildReviewPrompt
[00:55:02.425] INFO: Using default prompt (external prompt not found: unknown status: )
--- PASS: TestBuildReviewPrompt (0.00s)
=== RUN   TestGetCurrentWorkDir
--- PASS: TestGetCurrentWorkDir (0.00s)
=== RUN   TestLogClaudeInteraction
[00:55:02.426] INFO: ┌─ Claude Code Execution ─────────────────────────────────
[00:55:02.426] INFO: │ Start: 00:55:02.426
[00:55:02.426] INFO: │ Prompt: 11 chars, 1 lines
[00:55:02.426] INFO: │ Type: Test prompt
[00:55:02.426] INFO: │ End: 00:55:04.426 (Duration: 2.0s)
[00:55:02.426] INFO: │ Response: 11 chars, 1 lines
[00:55:02.426] WARN: │ Warning: Unusually short response (11 chars)
[00:55:02.426] WARN: │ Full content: Test result
[00:55:02.426] INFO: ┌─ AI Response Content ─────────────────────────────────────
[00:55:02.426] INFO: │    1: Test result
[00:55:02.426] INFO: └──────────────────────────────────────────────────────────
[00:55:02.426] INFO: └──────────────────────────────────────────────────────────
[00:55:02.426] INFO: ┌─ Claude Code Execution ─────────────────────────────────
[00:55:02.426] INFO: │ Start: 00:55:02.426
[00:55:02.426] INFO: │ Prompt: 11 chars, 1 lines
[00:55:02.426] INFO: │ Type: Test prompt
[00:55:02.426] INFO: │ End: 00:55:03.426 (Duration: 1.0s)
[00:55:02.427] INFO: │ Status: ERROR - test error
[00:55:02.427] INFO: └──────────────────────────────────────────────────────────
--- PASS: TestLogClaudeInteraction (0.00s)
=== RUN   TestGetTaskDescription
=== RUN   TestGetTaskDescription/With_WIP_task
=== RUN   TestGetTaskDescription/Empty_WIP
--- PASS: TestGetTaskDescription (0.00s)
    --- PASS: TestGetTaskDescription/With_WIP_task (0.00s)
    --- PASS: TestGetTaskDescription/Empty_WIP (0.00s)
=== RUN   TestDetermineStep
=== RUN   TestDetermineStep/WIP_status
=== RUN   TestDetermineStep/REVIEW_status
=== RUN   TestDetermineStep/REVIEW&WIP_status
=== RUN   TestDetermineStep/DONE_status
=== RUN   TestDetermineStep/READY_status
=== RUN   TestDetermineStep/Empty_status
--- PASS: TestDetermineStep (0.00s)
    --- PASS: TestDetermineStep/WIP_status (0.00s)
    --- PASS: TestDetermineStep/REVIEW_status (0.00s)
    --- PASS: TestDetermineStep/REVIEW&WIP_status (0.00s)
    --- PASS: TestDetermineStep/DONE_status (0.00s)
    --- PASS: TestDetermineStep/READY_status (0.00s)
    --- PASS: TestDetermineStep/Empty_status (0.00s)
=== RUN   TestBuildPromptByStatus
=== RUN   TestBuildPromptByStatus/WIP_status
[00:55:02.428] INFO: Using default prompt (external prompt not found: open .deespec/prompts/WIP.md: no such file or directory)
=== RUN   TestBuildPromptByStatus/REVIEW_status
[00:55:02.428] INFO: Using default prompt (external prompt not found: open .deespec/prompts/REVIEW.md: no such file or directory)
=== RUN   TestBuildPromptByStatus/REVIEW&WIP_status
[00:55:02.428] INFO: Using default prompt (external prompt not found: open .deespec/prompts/REVIEW_AND_WIP.md: no such file or directory)
--- PASS: TestBuildPromptByStatus (0.00s)
    --- PASS: TestBuildPromptByStatus/WIP_status (0.00s)
    --- PASS: TestBuildPromptByStatus/REVIEW_status (0.00s)
    --- PASS: TestBuildPromptByStatus/REVIEW&WIP_status (0.00s)
=== RUN   TestGetCurrentWorkingDirectory
--- PASS: TestGetCurrentWorkingDirectory (0.00s)
=== RUN   TestParseDecision
=== RUN   TestParseDecision/Simple_SUCCEEDED
[00:55:02.429] INFO: Decision extracted: SUCCEEDED (pattern: (?mi)DECISION:\s*(SUCCEEDED|NEEDS_CHANGES|FAILED))
=== RUN   TestParseDecision/Simple_FAILED
[00:55:02.429] INFO: Decision extracted: FAILED (pattern: (?mi)DECISION:\s*(SUCCEEDED|NEEDS_CHANGES|FAILED))
=== RUN   TestParseDecision/Simple_NEEDS_CHANGES
[00:55:02.430] INFO: Decision extracted: NEEDS_CHANGES (pattern: (?mi)DECISION:\s*(SUCCEEDED|NEEDS_CHANGES|FAILED))
=== RUN   TestParseDecision/FAILED_with_leading_asterisks
[00:55:02.430] INFO: Decision extracted: FAILED (pattern: (?mi)DECISION:\s*(SUCCEEDED|NEEDS_CHANGES|FAILED))
=== RUN   TestParseDecision/SUCCEEDED_with_trailing_asterisks
[00:55:02.430] INFO: Decision extracted: SUCCEEDED (pattern: (?mi)DECISION:\s*(SUCCEEDED|NEEDS_CHANGES|FAILED))
=== RUN   TestParseDecision/Mixed_case_decision
[00:55:02.431] INFO: Decision extracted: SUCCEEDED (pattern: (?mi)DECISION:\s*(SUCCEEDED|NEEDS_CHANGES|FAILED))
=== RUN   TestParseDecision/Decision_with_extra_whitespace
[00:55:02.431] INFO: Decision extracted: FAILED (pattern: (?mi)DECISION:\s*(SUCCEEDED|NEEDS_CHANGES|FAILED))
=== RUN   TestParseDecision/No_decision_found_-_default_to_NEEDS_CHANGES
[00:55:02.432] INFO: No valid DECISION found in response, defaulting to NEEDS_CHANGES
=== RUN   TestParseDecision/Invalid_decision_value_-_default_to_NEEDS_CHANGES
[00:55:02.433] INFO: No valid DECISION found in response, defaulting to NEEDS_CHANGES
=== RUN   TestParseDecision/Decision_in_middle_of_text
[00:55:02.433] INFO: Decision extracted: SUCCEEDED (pattern: (?mi)DECISION:\s*(SUCCEEDED|NEEDS_CHANGES|FAILED))
=== RUN   TestParseDecision/Multiple_decisions_-_takes_first
[00:55:02.434] INFO: Decision extracted: FAILED (pattern: (?mi)DECISION:\s*(SUCCEEDED|NEEDS_CHANGES|FAILED))
--- PASS: TestParseDecision (0.00s)
    --- PASS: TestParseDecision/Simple_SUCCEEDED (0.00s)
    --- PASS: TestParseDecision/Simple_FAILED (0.00s)
    --- PASS: TestParseDecision/Simple_NEEDS_CHANGES (0.00s)
    --- PASS: TestParseDecision/FAILED_with_leading_asterisks (0.00s)
    --- PASS: TestParseDecision/SUCCEEDED_with_trailing_asterisks (0.00s)
    --- PASS: TestParseDecision/Mixed_case_decision (0.00s)
    --- PASS: TestParseDecision/Decision_with_extra_whitespace (0.00s)
    --- PASS: TestParseDecision/No_decision_found_-_default_to_NEEDS_CHANGES (0.00s)
    --- PASS: TestParseDecision/Invalid_decision_value_-_default_to_NEEDS_CHANGES (0.00s)
    --- PASS: TestParseDecision/Decision_in_middle_of_text (0.00s)
    --- PASS: TestParseDecision/Multiple_decisions_-_takes_first (0.00s)
PASS
coverage: 20.0% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/interface/cli/run	1.347s	coverage: 20.0% of statements
# github.com/YoshitsuguKoike/deespec/internal/interface/cli/sbi.test
ld: warning: '/private/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/go-link-3818886631/000023.o' has malformed LC_DYSYMTAB, expected 98 undefined symbols to start at index 1626, found 95 undefined symbols starting at index 1626
=== RUN   TestNewSBIRegisterCommand
--- PASS: TestNewSBIRegisterCommand (0.00s)
=== RUN   TestSBIRegister_MissingTitle
Error: required flag(s) "title" not set
Usage:
  register [flags]

Flags:
      --body string     Body content of the specification (reads from stdin if not provided)
      --dry-run         Simulate registration without creating files
  -h, --help            help for register
      --json            Output result in JSON format
      --label strings   Label for the specification (can be specified multiple times)
      --labels string   Comma-separated list of labels
      --quiet           Suppress non-error output
      --title string    Title of the specification (required)

--- PASS: TestSBIRegister_MissingTitle (0.00s)
=== RUN   TestSBIRegister_DryRun
=== RUN   TestSBIRegister_DryRun/Dry_run_with_valid_input
=== RUN   TestSBIRegister_DryRun/Dry_run_with_JSON_output
{
  "created": false,
  "id": "SBI-DRYRUN-EXAMPLE",
  "ok": true,
  "spec_path": ".deespec/specs/sbi/SBI-DRYRUN-EXAMPLE/spec.md"
}
=== RUN   TestSBIRegister_DryRun/Dry_run_missing_title
Error: required flag(s) "title" not set
Usage:
  register [flags]

Flags:
      --body string     Body content of the specification (reads from stdin if not provided)
      --dry-run         Simulate registration without creating files
  -h, --help            help for register
      --json            Output result in JSON format
      --label strings   Label for the specification (can be specified multiple times)
      --labels string   Comma-separated list of labels
      --quiet           Suppress non-error output
      --title string    Title of the specification (required)

--- PASS: TestSBIRegister_DryRun (0.00s)
    --- PASS: TestSBIRegister_DryRun/Dry_run_with_valid_input (0.00s)
    --- PASS: TestSBIRegister_DryRun/Dry_run_with_JSON_output (0.00s)
    --- PASS: TestSBIRegister_DryRun/Dry_run_missing_title (0.00s)
=== RUN   TestSBIRegister_StdinInput
--- PASS: TestSBIRegister_StdinInput (0.00s)
=== RUN   TestRunSBIRegister_EmptyTitle
--- PASS: TestRunSBIRegister_EmptyTitle (0.00s)
=== RUN   TestIsInputFromTerminal
--- PASS: TestIsInputFromTerminal (0.00s)
=== RUN   TestProcessLabels
=== RUN   TestProcessLabels/Empty_inputs
=== RUN   TestProcessLabels/Single_label_from_--label
=== RUN   TestProcessLabels/Multiple_labels_from_--label
=== RUN   TestProcessLabels/Single_label_from_--labels
=== RUN   TestProcessLabels/Multiple_labels_from_--labels_(comma-separated)
=== RUN   TestProcessLabels/Labels_with_spaces_(should_be_trimmed)
=== RUN   TestProcessLabels/Duplicate_labels_(should_be_deduplicated)
=== RUN   TestProcessLabels/Mixed_input_from_both_flags
=== RUN   TestProcessLabels/Empty_strings_in_input_(should_be_filtered)
=== RUN   TestProcessLabels/Whitespace-only_labels_(should_be_filtered)
--- PASS: TestProcessLabels (0.00s)
    --- PASS: TestProcessLabels/Empty_inputs (0.00s)
    --- PASS: TestProcessLabels/Single_label_from_--label (0.00s)
    --- PASS: TestProcessLabels/Multiple_labels_from_--label (0.00s)
    --- PASS: TestProcessLabels/Single_label_from_--labels (0.00s)
    --- PASS: TestProcessLabels/Multiple_labels_from_--labels_(comma-separated) (0.00s)
    --- PASS: TestProcessLabels/Labels_with_spaces_(should_be_trimmed) (0.00s)
    --- PASS: TestProcessLabels/Duplicate_labels_(should_be_deduplicated) (0.00s)
    --- PASS: TestProcessLabels/Mixed_input_from_both_flags (0.00s)
    --- PASS: TestProcessLabels/Empty_strings_in_input_(should_be_filtered) (0.00s)
    --- PASS: TestProcessLabels/Whitespace-only_labels_(should_be_filtered) (0.00s)
=== RUN   TestSBIRegisterWithLabels
=== RUN   TestSBIRegisterWithLabels/Register_with_single_--label
=== RUN   TestSBIRegisterWithLabels/Register_with_multiple_--label_flags
=== RUN   TestSBIRegisterWithLabels/Register_with_--labels_(comma-separated)
=== RUN   TestSBIRegisterWithLabels/Register_with_both_--label_and_--labels
=== RUN   TestSBIRegisterWithLabels/Register_with_duplicate_labels
--- PASS: TestSBIRegisterWithLabels (0.00s)
    --- PASS: TestSBIRegisterWithLabels/Register_with_single_--label (0.00s)
    --- PASS: TestSBIRegisterWithLabels/Register_with_multiple_--label_flags (0.00s)
    --- PASS: TestSBIRegisterWithLabels/Register_with_--labels_(comma-separated) (0.00s)
    --- PASS: TestSBIRegisterWithLabels/Register_with_both_--label_and_--labels (0.00s)
    --- PASS: TestSBIRegisterWithLabels/Register_with_duplicate_labels (0.00s)
=== RUN   TestNewSBIRunCommand
--- PASS: TestNewSBIRunCommand (0.00s)
=== RUN   TestNewSBIRunCommand_NotNil
=== RUN   TestNewSBIRunCommand_NotNil/NewSBIRunCommand
--- PASS: TestNewSBIRunCommand_NotNil (0.00s)
    --- PASS: TestNewSBIRunCommand_NotNil/NewSBIRunCommand (0.00s)
PASS
coverage: 17.0% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/interface/cli/sbi	1.326s	coverage: 17.0% of statements
	github.com/YoshitsuguKoike/deespec/internal/interface/cli/status		coverage: 0.0% of statements
	github.com/YoshitsuguKoike/deespec/internal/interface/cli/version		coverage: 0.0% of statements
# github.com/YoshitsuguKoike/deespec/internal/interface/cli/workflow_config.test
ld: warning: '/private/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/go-link-3117299768/000023.o' has malformed LC_DYSYMTAB, expected 98 undefined symbols to start at index 1626, found 95 undefined symbols starting at index 1626
=== RUN   TestLoadWorkflowConfig_DefaultConfig
--- PASS: TestLoadWorkflowConfig_DefaultConfig (0.00s)
=== RUN   TestLoadWorkflowConfig_ValidFile
--- PASS: TestLoadWorkflowConfig_ValidFile (0.00s)
=== RUN   TestLoadWorkflowConfig_InvalidYAML
--- PASS: TestLoadWorkflowConfig_InvalidYAML (0.00s)
=== RUN   TestSaveWorkflowConfig
--- PASS: TestSaveWorkflowConfig (0.00s)
=== RUN   TestWorkflowConfiguration_Validate
--- PASS: TestWorkflowConfiguration_Validate (0.00s)
=== RUN   TestWorkflowConfiguration_ProcessIntervals
--- PASS: TestWorkflowConfiguration_ProcessIntervals (0.00s)
=== RUN   TestWorkflowConfiguration_ProcessIntervals_InvalidDefault
--- PASS: TestWorkflowConfiguration_ProcessIntervals_InvalidDefault (0.00s)
=== RUN   TestGetDefaultConfigPath
--- PASS: TestGetDefaultConfigPath (0.00s)
=== RUN   TestGenerateExampleConfig
--- PASS: TestGenerateExampleConfig (0.00s)
=== RUN   TestCreateManagerFromConfig
[00:55:06.452] INFO: Registered workflow: sbi (Spec Backlog Item processing workflow)
[00:55:06.453] INFO: Stopping all workflows...
[00:55:06.453] INFO: All workflows stopped
--- PASS: TestCreateManagerFromConfig (0.00s)
=== RUN   TestWorkflowConfigBuilder
--- PASS: TestWorkflowConfigBuilder (0.00s)
PASS
coverage: 81.4% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/interface/cli/workflow_config	1.260s	coverage: 81.4% of statements
# github.com/YoshitsuguKoike/deespec/internal/interface/cli/workflow_sbi.test
ld: warning: '/private/var/folders/m1/zhzcdc111bjd5y5qtrnw3yd00000gn/T/go-link-2544330739/000023.o' has malformed LC_DYSYMTAB, expected 98 undefined symbols to start at index 1626, found 95 undefined symbols starting at index 1626
=== RUN   TestParallelSBIWorkflowRunner_ConcurrencyControl
--- PASS: TestParallelSBIWorkflowRunner_ConcurrencyControl (0.07s)
=== RUN   TestParallelSBIWorkflowRunner_LockContention
--- PASS: TestParallelSBIWorkflowRunner_LockContention (0.11s)
=== RUN   TestParallelSBIWorkflowRunner_ErrorHandling
--- PASS: TestParallelSBIWorkflowRunner_ErrorHandling (0.01s)
=== RUN   TestParallelSBIWorkflowRunner_ContextCancellation
--- PASS: TestParallelSBIWorkflowRunner_ContextCancellation (0.01s)
=== RUN   TestParallelSBIWorkflowRunner_Validate
=== RUN   TestParallelSBIWorkflowRunner_Validate/Valid_configuration
=== RUN   TestParallelSBIWorkflowRunner_Validate/Invalid_maxParallel_(-1)
=== RUN   TestParallelSBIWorkflowRunner_Validate/Nil_container
=== RUN   TestParallelSBIWorkflowRunner_Validate/Nil_executeTurn_function
--- PASS: TestParallelSBIWorkflowRunner_Validate (0.01s)
    --- PASS: TestParallelSBIWorkflowRunner_Validate/Valid_configuration (0.00s)
    --- PASS: TestParallelSBIWorkflowRunner_Validate/Invalid_maxParallel_(-1) (0.00s)
    --- PASS: TestParallelSBIWorkflowRunner_Validate/Nil_container (0.00s)
    --- PASS: TestParallelSBIWorkflowRunner_Validate/Nil_executeTurn_function (0.00s)
=== RUN   TestParallelSBIWorkflowRunner_BasicMethods
--- PASS: TestParallelSBIWorkflowRunner_BasicMethods (0.01s)
=== RUN   TestParallelSBIWorkflowRunner_NoTasksAvailable
--- PASS: TestParallelSBIWorkflowRunner_NoTasksAvailable (0.01s)
=== RUN   TestParallelSBIWorkflowRunner_LoadTest
    parallel_runner_test.go:484: Load test completed: 5 SBIs in 16.365958ms (avg: 3.273191ms per SBI)
--- PASS: TestParallelSBIWorkflowRunner_LoadTest (0.03s)
=== RUN   TestParallelSBIWorkflowRunner_FileConflictDetection
    parallel_runner_test.go:588: Execution order: [SBI-004 SBI-001 SBI-002]
--- PASS: TestParallelSBIWorkflowRunner_FileConflictDetection (0.11s)
=== RUN   TestParallelSBIWorkflowRunner_AgentPoolControl
    parallel_runner_test.go:745: Executed SBIs: [SBI-001 SBI-004 SBI-002]
    parallel_runner_test.go:746: Agent counts: map[claude-code:2 gemini-cli:1]
--- PASS: TestParallelSBIWorkflowRunner_AgentPoolControl (0.07s)
=== RUN   TestSBIWorkflowRunner_NewSBIWorkflowRunner
--- PASS: TestSBIWorkflowRunner_NewSBIWorkflowRunner (0.00s)
=== RUN   TestSBIWorkflowRunner_Name
--- PASS: TestSBIWorkflowRunner_Name (0.00s)
=== RUN   TestSBIWorkflowRunner_Description
--- PASS: TestSBIWorkflowRunner_Description (0.00s)
=== RUN   TestSBIWorkflowRunner_IsEnabled
--- PASS: TestSBIWorkflowRunner_IsEnabled (0.00s)
=== RUN   TestSBIWorkflowRunner_Validate
--- PASS: TestSBIWorkflowRunner_Validate (0.00s)
=== RUN   TestSBIWorkflowRunner_Run_Context_Cancellation
--- PASS: TestSBIWorkflowRunner_Run_Context_Cancellation (0.00s)
=== RUN   TestSBIWorkflowRunner_Run_Context_Timeout
--- PASS: TestSBIWorkflowRunner_Run_Context_Timeout (0.01s)
=== RUN   TestSBIWorkflowRunner_Run_AutoFB_Config
    workflow_sbi_test.go:133: Skipping integration test that requires full app context
--- SKIP: TestSBIWorkflowRunner_Run_AutoFB_Config (0.00s)
=== RUN   TestSBIWorkflowRunner_Run_AutoFB_GlobalConfig
    workflow_sbi_test.go:157: Skipping integration test that requires full app context
--- SKIP: TestSBIWorkflowRunner_Run_AutoFB_GlobalConfig (0.00s)
=== RUN   TestSBIWorkflowRunner_Integration_WithManager
--- PASS: TestSBIWorkflowRunner_Integration_WithManager (0.05s)
PASS
coverage: 77.5% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/interface/cli/workflow_sbi	1.783s	coverage: 77.5% of statements
=== RUN   TestStreamEvent_JSON
--- PASS: TestStreamEvent_JSON (0.00s)
=== RUN   TestStreamContext_HistoryPath
--- PASS: TestStreamContext_HistoryPath (0.00s)
=== RUN   TestRunWithStream_CreatesHistoryDir
--- PASS: TestRunWithStream_CreatesHistoryDir (0.00s)
=== RUN   TestPackageLeaks
--- PASS: TestPackageLeaks (0.00s)
PASS
coverage: 0.0% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/interface/external/claudecli	1.235s	coverage: 0.0% of statements
=== RUN   TestComputeSpecPath
=== RUN   TestComputeSpecPath/basic_path_construction
=== RUN   TestComputeSpecPath/special_characters_in_title
=== RUN   TestComputeSpecPath/unicode_normalization
=== RUN   TestComputeSpecPath/consecutive_hyphens
=== RUN   TestComputeSpecPath/empty_title_becomes_untitled
=== RUN   TestComputeSpecPath/reserved_name_handling
=== RUN   TestComputeSpecPath/length_limit_applied
=== RUN   TestComputeSpecPath/custom_base_directory
=== RUN   TestComputeSpecPath/missing_ID
=== RUN   TestComputeSpecPath/missing_title
--- PASS: TestComputeSpecPath (0.00s)
    --- PASS: TestComputeSpecPath/basic_path_construction (0.00s)
    --- PASS: TestComputeSpecPath/special_characters_in_title (0.00s)
    --- PASS: TestComputeSpecPath/unicode_normalization (0.00s)
    --- PASS: TestComputeSpecPath/consecutive_hyphens (0.00s)
    --- PASS: TestComputeSpecPath/empty_title_becomes_untitled (0.00s)
    --- PASS: TestComputeSpecPath/reserved_name_handling (0.00s)
    --- PASS: TestComputeSpecPath/length_limit_applied (0.00s)
    --- PASS: TestComputeSpecPath/custom_base_directory (0.00s)
    --- PASS: TestComputeSpecPath/missing_ID (0.00s)
    --- PASS: TestComputeSpecPath/missing_title (0.00s)
=== RUN   TestSlugifyTitle
=== RUN   TestSlugifyTitle/basic_alphanumeric
=== RUN   TestSlugifyTitle/uppercase_to_lowercase
=== RUN   TestSlugifyTitle/special_characters_replaced
=== RUN   TestSlugifyTitle/leading_and_trailing_hyphens_trimmed
=== RUN   TestSlugifyTitle/unicode_normalized
=== RUN   TestSlugifyTitle/japanese_becomes_hyphens
=== RUN   TestSlugifyTitle/mixed_content
=== RUN   TestSlugifyTitle/windows_reserved_name_with_suffix
=== RUN   TestSlugifyTitle/trailing_dots_and_spaces_removed
=== RUN   TestSlugifyTitle/fallback_when_empty
=== RUN   TestSlugifyTitle/max_runes_limit
--- PASS: TestSlugifyTitle (0.00s)
    --- PASS: TestSlugifyTitle/basic_alphanumeric (0.00s)
    --- PASS: TestSlugifyTitle/uppercase_to_lowercase (0.00s)
    --- PASS: TestSlugifyTitle/special_characters_replaced (0.00s)
    --- PASS: TestSlugifyTitle/leading_and_trailing_hyphens_trimmed (0.00s)
    --- PASS: TestSlugifyTitle/unicode_normalized (0.00s)
    --- PASS: TestSlugifyTitle/japanese_becomes_hyphens (0.00s)
    --- PASS: TestSlugifyTitle/mixed_content (0.00s)
    --- PASS: TestSlugifyTitle/windows_reserved_name_with_suffix (0.00s)
    --- PASS: TestSlugifyTitle/trailing_dots_and_spaces_removed (0.00s)
    --- PASS: TestSlugifyTitle/fallback_when_empty (0.00s)
    --- PASS: TestSlugifyTitle/max_runes_limit (0.00s)
PASS
coverage: 56.1% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/pkg/specpath	1.320s	coverage: 56.1% of statements
=== RUN   TestReadPromptWithLimit
=== RUN   TestReadPromptWithLimit/file_within_limit
=== RUN   TestReadPromptWithLimit/file_at_exact_limit
=== RUN   TestReadPromptWithLimit/file_over_limit
=== RUN   TestReadPromptWithLimit/large_file_with_higher_limit
=== RUN   TestReadPromptWithLimit/small_file_with_small_limit
=== RUN   TestReadPromptWithLimit/2KB_file_with_1KB_limit
--- PASS: TestReadPromptWithLimit (0.01s)
    --- PASS: TestReadPromptWithLimit/file_within_limit (0.00s)
    --- PASS: TestReadPromptWithLimit/file_at_exact_limit (0.00s)
    --- PASS: TestReadPromptWithLimit/file_over_limit (0.00s)
    --- PASS: TestReadPromptWithLimit/large_file_with_higher_limit (0.00s)
    --- PASS: TestReadPromptWithLimit/small_file_with_small_limit (0.00s)
    --- PASS: TestReadPromptWithLimit/2KB_file_with_1KB_limit (0.00s)
=== RUN   TestReadPromptWithLimit_FileNotFound
--- PASS: TestReadPromptWithLimit_FileNotFound (0.00s)
=== RUN   TestReadPromptWithLimit_ErrorMessage
--- PASS: TestReadPromptWithLimit_ErrorMessage (0.00s)
=== RUN   TestParseDecision
=== RUN   TestParseDecision/OK_decision_at_end
=== RUN   TestParseDecision/NEEDS_CHANGES_decision_at_end
=== RUN   TestParseDecision/decision_in_middle,_last_one_wins
=== RUN   TestParseDecision/no_match_returns_pending
=== RUN   TestParseDecision/custom_regex_pattern_OK
=== RUN   TestParseDecision/custom_regex_pattern_NEEDS_CHANGES
=== RUN   TestParseDecision/whitespace_handling
=== RUN   TestParseDecision/nil_regex_returns_pending
=== RUN   TestParseDecision/empty_output
=== RUN   TestParseDecision/multiline_with_decision_at_end
--- PASS: TestParseDecision (0.00s)
    --- PASS: TestParseDecision/OK_decision_at_end (0.00s)
    --- PASS: TestParseDecision/NEEDS_CHANGES_decision_at_end (0.00s)
    --- PASS: TestParseDecision/decision_in_middle,_last_one_wins (0.00s)
    --- PASS: TestParseDecision/no_match_returns_pending (0.00s)
    --- PASS: TestParseDecision/custom_regex_pattern_OK (0.00s)
    --- PASS: TestParseDecision/custom_regex_pattern_NEEDS_CHANGES (0.00s)
    --- PASS: TestParseDecision/whitespace_handling (0.00s)
    --- PASS: TestParseDecision/nil_regex_returns_pending (0.00s)
    --- PASS: TestParseDecision/empty_output (0.00s)
    --- PASS: TestParseDecision/multiline_with_decision_at_end (0.00s)
=== RUN   TestExtractDecisionLine
=== RUN   TestExtractDecisionLine/extract_OK_line
=== RUN   TestExtractDecisionLine/extract_NEEDS_CHANGES_line
=== RUN   TestExtractDecisionLine/no_match
=== RUN   TestExtractDecisionLine/nil_regex
=== RUN   TestExtractDecisionLine/extract_last_matching_line
--- PASS: TestExtractDecisionLine (0.00s)
    --- PASS: TestExtractDecisionLine/extract_OK_line (0.00s)
    --- PASS: TestExtractDecisionLine/extract_NEEDS_CHANGES_line (0.00s)
    --- PASS: TestExtractDecisionLine/no_match (0.00s)
    --- PASS: TestExtractDecisionLine/nil_regex (0.00s)
    --- PASS: TestExtractDecisionLine/extract_last_matching_line (0.00s)
PASS
coverage: 42.4% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/runner	1.265s	coverage: 42.4% of statements
=== RUN   Test_NoAbsolutePathsInTests
--- PASS: Test_NoAbsolutePathsInTests (0.37s)
PASS
coverage: 0.0% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/testutil	1.602s	coverage: 0.0% of statements
?   	github.com/YoshitsuguKoike/deespec/internal/usecase	[no test files]
=== RUN   TestNormalizeCRLFToLF
=== RUN   TestNormalizeCRLFToLF/CRLF_to_LF
=== RUN   TestNormalizeCRLFToLF/LF_unchanged
=== RUN   TestNormalizeCRLFToLF/mixed_CRLF_and_LF
=== RUN   TestNormalizeCRLFToLF/empty
--- PASS: TestNormalizeCRLFToLF (0.00s)
    --- PASS: TestNormalizeCRLFToLF/CRLF_to_LF (0.00s)
    --- PASS: TestNormalizeCRLFToLF/LF_unchanged (0.00s)
    --- PASS: TestNormalizeCRLFToLF/mixed_CRLF_and_LF (0.00s)
    --- PASS: TestNormalizeCRLFToLF/empty (0.00s)
=== RUN   TestWriteFileAtomic
=== RUN   TestWriteFileAtomic/happy_path
=== RUN   TestWriteFileAtomic/adds_trailing_newline
=== RUN   TestWriteFileAtomic/preserves_existing_newline
=== RUN   TestWriteFileAtomic/creates_directory_if_needed
=== RUN   TestWriteFileAtomic/overwrites_existing_file
=== RUN   TestWriteFileAtomic/normalizes_CRLF_to_LF
=== RUN   TestWriteFileAtomic/cleans_up_temp_file_on_failure
--- PASS: TestWriteFileAtomic (0.01s)
    --- PASS: TestWriteFileAtomic/happy_path (0.00s)
    --- PASS: TestWriteFileAtomic/adds_trailing_newline (0.00s)
    --- PASS: TestWriteFileAtomic/preserves_existing_newline (0.00s)
    --- PASS: TestWriteFileAtomic/creates_directory_if_needed (0.00s)
    --- PASS: TestWriteFileAtomic/overwrites_existing_file (0.00s)
    --- PASS: TestWriteFileAtomic/normalizes_CRLF_to_LF (0.00s)
    --- PASS: TestWriteFileAtomic/cleans_up_temp_file_on_failure (0.00s)
PASS
coverage: 81.2% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/util	1.326s	coverage: 81.2% of statements
=== RUN   TestLoadAgents
=== RUN   TestLoadAgents/file_not_exists_-_use_builtin
=== RUN   TestLoadAgents/valid_agents.yaml
=== RUN   TestLoadAgents/empty_agents_array
=== RUN   TestLoadAgents/duplicate_agents
=== RUN   TestLoadAgents/invalid_agent_name
=== RUN   TestLoadAgents/unknown_fields
=== RUN   TestLoadAgents/invalid_YAML
=== RUN   TestLoadAgents/empty_agent_name
--- PASS: TestLoadAgents (0.01s)
    --- PASS: TestLoadAgents/file_not_exists_-_use_builtin (0.00s)
    --- PASS: TestLoadAgents/valid_agents.yaml (0.00s)
    --- PASS: TestLoadAgents/empty_agents_array (0.00s)
    --- PASS: TestLoadAgents/duplicate_agents (0.00s)
    --- PASS: TestLoadAgents/invalid_agent_name (0.00s)
    --- PASS: TestLoadAgents/unknown_fields (0.00s)
    --- PASS: TestLoadAgents/invalid_YAML (0.00s)
    --- PASS: TestLoadAgents/empty_agent_name (0.00s)
=== RUN   TestValidateAgents
=== RUN   TestValidateAgents/valid_agents
=== RUN   TestValidateAgents/empty_array
=== RUN   TestValidateAgents/duplicate_agents
=== RUN   TestValidateAgents/invalid_characters
=== RUN   TestValidateAgents/empty_string
--- PASS: TestValidateAgents (0.00s)
    --- PASS: TestValidateAgents/valid_agents (0.00s)
    --- PASS: TestValidateAgents/empty_array (0.00s)
    --- PASS: TestValidateAgents/duplicate_agents (0.00s)
    --- PASS: TestValidateAgents/invalid_characters (0.00s)
    --- PASS: TestValidateAgents/empty_string (0.00s)
=== RUN   TestToMap
--- PASS: TestToMap (0.00s)
PASS
coverage: 97.0% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/validator/agents	1.245s	coverage: 97.0% of statements
	github.com/YoshitsuguKoike/deespec/internal/validator/common		coverage: 0.0% of statements
=== RUN   TestValidateHealthFile
=== RUN   TestValidateHealthFile/valid_health.json
=== RUN   TestValidateHealthFile/missing_required_key
=== RUN   TestValidateHealthFile/invalid_timestamp_format
=== RUN   TestValidateHealthFile/negative_turn
=== RUN   TestValidateHealthFile/invalid_step
=== RUN   TestValidateHealthFile/invalid_ok_type
=== RUN   TestValidateHealthFile/invalid_error_type
=== RUN   TestValidateHealthFile/ok/error_consistency_warning_-_ok=true_with_error
=== RUN   TestValidateHealthFile/ok/error_consistency_warning_-_ok=false_without_error
=== RUN   TestValidateHealthFile/valid_ok=false_with_error
=== RUN   TestValidateHealthFile/multiple_errors
--- PASS: TestValidateHealthFile (0.02s)
    --- PASS: TestValidateHealthFile/valid_health.json (0.00s)
    --- PASS: TestValidateHealthFile/missing_required_key (0.00s)
    --- PASS: TestValidateHealthFile/invalid_timestamp_format (0.00s)
    --- PASS: TestValidateHealthFile/negative_turn (0.00s)
    --- PASS: TestValidateHealthFile/invalid_step (0.00s)
    --- PASS: TestValidateHealthFile/invalid_ok_type (0.00s)
    --- PASS: TestValidateHealthFile/invalid_error_type (0.00s)
    --- PASS: TestValidateHealthFile/ok/error_consistency_warning_-_ok=true_with_error (0.00s)
    --- PASS: TestValidateHealthFile/ok/error_consistency_warning_-_ok=false_without_error (0.00s)
    --- PASS: TestValidateHealthFile/valid_ok=false_with_error (0.00s)
    --- PASS: TestValidateHealthFile/multiple_errors (0.00s)
=== RUN   TestValidateHealthFile_NotFound
--- PASS: TestValidateHealthFile_NotFound (0.00s)
PASS
coverage: 89.6% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/validator/health	1.246s	coverage: 89.6% of statements
=== RUN   TestIntegratedValidation
--- PASS: TestIntegratedValidation (0.01s)
=== RUN   TestIntegratedValidationWithErrors
--- PASS: TestIntegratedValidationWithErrors (0.01s)
=== RUN   TestComponentStatus
--- PASS: TestComponentStatus (0.00s)
=== RUN   TestJSONMarshal
--- PASS: TestJSONMarshal (0.00s)
PASS
coverage: 73.3% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/validator/integrated	1.267s	coverage: 73.3% of statements
=== RUN   TestJournalValidation
=== RUN   TestJournalValidation/valid_journal_entry
=== RUN   TestJournalValidation/missing_required_key
=== RUN   TestJournalValidation/extra_key
=== RUN   TestJournalValidation/invalid_timestamp_(not_UTC)
=== RUN   TestJournalValidation/invalid_timestamp_format
=== RUN   TestJournalValidation/negative_turn
=== RUN   TestJournalValidation/invalid_step
=== RUN   TestJournalValidation/invalid_decision
=== RUN   TestJournalValidation/negative_elapsed_ms
=== RUN   TestJournalValidation/artifact_turn_inconsistency
=== RUN   TestJournalValidation/turn_monotonicity_warning
=== RUN   TestJournalValidation/empty_lines_ignored
=== RUN   TestJournalValidation/invalid_JSON
=== RUN   TestJournalValidation/mixed_artifact_types_(valid)
=== RUN   TestJournalValidation/artifact_with_wrong_type
--- PASS: TestJournalValidation (0.01s)
    --- PASS: TestJournalValidation/valid_journal_entry (0.00s)
    --- PASS: TestJournalValidation/missing_required_key (0.00s)
    --- PASS: TestJournalValidation/extra_key (0.00s)
    --- PASS: TestJournalValidation/invalid_timestamp_(not_UTC) (0.00s)
    --- PASS: TestJournalValidation/invalid_timestamp_format (0.00s)
    --- PASS: TestJournalValidation/negative_turn (0.00s)
    --- PASS: TestJournalValidation/invalid_step (0.00s)
    --- PASS: TestJournalValidation/invalid_decision (0.00s)
    --- PASS: TestJournalValidation/negative_elapsed_ms (0.00s)
    --- PASS: TestJournalValidation/artifact_turn_inconsistency (0.00s)
    --- PASS: TestJournalValidation/turn_monotonicity_warning (0.00s)
    --- PASS: TestJournalValidation/empty_lines_ignored (0.00s)
    --- PASS: TestJournalValidation/invalid_JSON (0.00s)
    --- PASS: TestJournalValidation/mixed_artifact_types_(valid) (0.00s)
    --- PASS: TestJournalValidation/artifact_with_wrong_type (0.00s)
=== RUN   TestValidTimestampFormats
=== RUN   TestValidTimestampFormats/valid_2025-09-26T00:12:34Z
=== RUN   TestValidTimestampFormats/valid_2025-09-26T00:12:34.1Z
=== RUN   TestValidTimestampFormats/valid_2025-09-26T00:12:34.12Z
=== RUN   TestValidTimestampFormats/valid_2025-09-26T00:12:34.123Z
=== RUN   TestValidTimestampFormats/valid_2025-09-26T00:12:34.1234Z
=== RUN   TestValidTimestampFormats/valid_2025-09-26T00:12:34.12345Z
=== RUN   TestValidTimestampFormats/valid_2025-09-26T00:12:34.123456Z
=== RUN   TestValidTimestampFormats/valid_2025-09-26T00:12:34.1234567Z
=== RUN   TestValidTimestampFormats/valid_2025-09-26T00:12:34.12345678Z
=== RUN   TestValidTimestampFormats/valid_2025-09-26T00:12:34.123456789Z
--- PASS: TestValidTimestampFormats (0.00s)
    --- PASS: TestValidTimestampFormats/valid_2025-09-26T00:12:34Z (0.00s)
    --- PASS: TestValidTimestampFormats/valid_2025-09-26T00:12:34.1Z (0.00s)
    --- PASS: TestValidTimestampFormats/valid_2025-09-26T00:12:34.12Z (0.00s)
    --- PASS: TestValidTimestampFormats/valid_2025-09-26T00:12:34.123Z (0.00s)
    --- PASS: TestValidTimestampFormats/valid_2025-09-26T00:12:34.1234Z (0.00s)
    --- PASS: TestValidTimestampFormats/valid_2025-09-26T00:12:34.12345Z (0.00s)
    --- PASS: TestValidTimestampFormats/valid_2025-09-26T00:12:34.123456Z (0.00s)
    --- PASS: TestValidTimestampFormats/valid_2025-09-26T00:12:34.1234567Z (0.00s)
    --- PASS: TestValidTimestampFormats/valid_2025-09-26T00:12:34.12345678Z (0.00s)
    --- PASS: TestValidTimestampFormats/valid_2025-09-26T00:12:34.123456789Z (0.00s)
=== RUN   TestInvalidTimestampFormats
=== RUN   TestInvalidTimestampFormats/invalid_2025-09-26T00:12:34.123456789+09:00
=== RUN   TestInvalidTimestampFormats/invalid_2025-09-26T00:12:34.123456789
=== RUN   TestInvalidTimestampFormats/invalid_2025-09-26_00:12:34Z
=== RUN   TestInvalidTimestampFormats/invalid_2025-09-26
=== RUN   TestInvalidTimestampFormats/invalid_00:12:34Z
=== RUN   TestInvalidTimestampFormats/invalid_invalid
=== RUN   TestInvalidTimestampFormats/invalid_
--- PASS: TestInvalidTimestampFormats (0.00s)
    --- PASS: TestInvalidTimestampFormats/invalid_2025-09-26T00:12:34.123456789+09:00 (0.00s)
    --- PASS: TestInvalidTimestampFormats/invalid_2025-09-26T00:12:34.123456789 (0.00s)
    --- PASS: TestInvalidTimestampFormats/invalid_2025-09-26_00:12:34Z (0.00s)
    --- PASS: TestInvalidTimestampFormats/invalid_2025-09-26 (0.00s)
    --- PASS: TestInvalidTimestampFormats/invalid_00:12:34Z (0.00s)
    --- PASS: TestInvalidTimestampFormats/invalid_invalid (0.00s)
    --- PASS: TestInvalidTimestampFormats/invalid_ (0.00s)
=== RUN   TestJournalSummaryConsistency
--- PASS: TestJournalSummaryConsistency (0.00s)
PASS
coverage: 71.3% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/validator/journal	1.403s	coverage: 71.3% of statements
=== RUN   TestValidateStateFile
=== RUN   TestValidateStateFile/valid_state.json
=== RUN   TestValidateStateFile/missing_required_key
=== RUN   TestValidateStateFile/forbidden_key_present
=== RUN   TestValidateStateFile/invalid_version
=== RUN   TestValidateStateFile/invalid_step
=== RUN   TestValidateStateFile/negative_turn
=== RUN   TestValidateStateFile/invalid_timestamp_format
=== RUN   TestValidateStateFile/invalid_JSON
=== RUN   TestValidateStateFile/type_mismatch_-_version_string
=== RUN   TestValidateStateFile/type_mismatch_-_meta.updated_at_number
--- PASS: TestValidateStateFile (0.05s)
    --- PASS: TestValidateStateFile/valid_state.json (0.00s)
    --- PASS: TestValidateStateFile/missing_required_key (0.00s)
    --- PASS: TestValidateStateFile/forbidden_key_present (0.00s)
    --- PASS: TestValidateStateFile/invalid_version (0.01s)
    --- PASS: TestValidateStateFile/invalid_step (0.01s)
    --- PASS: TestValidateStateFile/negative_turn (0.01s)
    --- PASS: TestValidateStateFile/invalid_timestamp_format (0.00s)
    --- PASS: TestValidateStateFile/invalid_JSON (0.00s)
    --- PASS: TestValidateStateFile/type_mismatch_-_version_string (0.00s)
    --- PASS: TestValidateStateFile/type_mismatch_-_meta.updated_at_number (0.00s)
=== RUN   TestValidateStateFile_NotFound
--- PASS: TestValidateStateFile_NotFound (0.00s)
PASS
coverage: 97.1% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/validator/state	1.297s	coverage: 97.1% of statements
=== RUN   TestConstraintsNormalization
=== RUN   TestConstraintsNormalization/no_constraints_uses_default
=== RUN   TestConstraintsNormalization/valid_constraint_value
=== RUN   TestConstraintsNormalization/zero_falls_back_to_default
=== RUN   TestConstraintsNormalization/negative_falls_back_to_default
=== RUN   TestConstraintsNormalization/over_limit_falls_back_to_default
=== RUN   TestConstraintsNormalization/boundary_value_1
=== RUN   TestConstraintsNormalization/boundary_value_512
=== RUN   TestConstraintsNormalization/boundary_value_513_falls_back
--- PASS: TestConstraintsNormalization (0.02s)
    --- PASS: TestConstraintsNormalization/no_constraints_uses_default (0.00s)
    --- PASS: TestConstraintsNormalization/valid_constraint_value (0.00s)
    --- PASS: TestConstraintsNormalization/zero_falls_back_to_default (0.00s)
    --- PASS: TestConstraintsNormalization/negative_falls_back_to_default (0.00s)
    --- PASS: TestConstraintsNormalization/over_limit_falls_back_to_default (0.00s)
    --- PASS: TestConstraintsNormalization/boundary_value_1 (0.00s)
    --- PASS: TestConstraintsNormalization/boundary_value_512 (0.00s)
    --- PASS: TestConstraintsNormalization/boundary_value_513_falls_back (0.00s)
=== RUN   TestLoadWorkflow
=== RUN   TestLoadWorkflow/minimal_valid_workflow
=== RUN   TestLoadWorkflow/review_step_with_decision_regex
=== RUN   TestLoadWorkflow/missing_name
=== RUN   TestLoadWorkflow/missing_steps
=== RUN   TestLoadWorkflow/empty_steps_array
=== RUN   TestLoadWorkflow/missing_step_id
=== RUN   TestLoadWorkflow/missing_agent
=== RUN   TestLoadWorkflow/missing_prompt_path
=== RUN   TestLoadWorkflow/deprecated_prompt_field
=== RUN   TestLoadWorkflow/unsupported_agent
=== RUN   TestLoadWorkflow/bash_agent_not_supported
=== RUN   TestLoadWorkflow/duplicate_step_id
=== RUN   TestLoadWorkflow/empty_name
=== RUN   TestLoadWorkflow/empty_step_id
=== RUN   TestLoadWorkflow/empty_agent
=== RUN   TestLoadWorkflow/empty_prompt_path
=== RUN   TestLoadWorkflow/multiple_steps_valid
=== RUN   TestLoadWorkflow/absolute_path_not_allowed
=== RUN   TestLoadWorkflow/parent_directory_reference_not_allowed
=== RUN   TestLoadWorkflow/parent_directory_in_middle_not_allowed
=== RUN   TestLoadWorkflow/unknown_field_in_workflow
=== RUN   TestLoadWorkflow/unknown_field_in_step
=== RUN   TestLoadWorkflow/workflow_with_vars_field_is_valid
=== RUN   TestLoadWorkflow/decision_on_review_step_with_default_regex
=== RUN   TestLoadWorkflow/decision_on_review_step_with_custom_regex
=== RUN   TestLoadWorkflow/decision_on_non-review_step_is_not_allowed
=== RUN   TestLoadWorkflow/invalid_regex_in_decision
=== RUN   TestLoadWorkflow/constraints_with_default_max_prompt_kb
=== RUN   TestLoadWorkflow/constraints_with_valid_max_prompt_kb
=== RUN   TestLoadWorkflow/constraints_with_zero_max_prompt_kb_falls_back_to_default
=== RUN   TestLoadWorkflow/constraints_with_negative_max_prompt_kb_falls_back_to_default
=== RUN   TestLoadWorkflow/constraints_with_too_large_max_prompt_kb_falls_back_to_default
--- PASS: TestLoadWorkflow (0.03s)
    --- PASS: TestLoadWorkflow/minimal_valid_workflow (0.00s)
    --- PASS: TestLoadWorkflow/review_step_with_decision_regex (0.00s)
    --- PASS: TestLoadWorkflow/missing_name (0.00s)
    --- PASS: TestLoadWorkflow/missing_steps (0.00s)
    --- PASS: TestLoadWorkflow/empty_steps_array (0.00s)
    --- PASS: TestLoadWorkflow/missing_step_id (0.00s)
    --- PASS: TestLoadWorkflow/missing_agent (0.00s)
    --- PASS: TestLoadWorkflow/missing_prompt_path (0.00s)
    --- PASS: TestLoadWorkflow/deprecated_prompt_field (0.00s)
    --- PASS: TestLoadWorkflow/unsupported_agent (0.00s)
    --- PASS: TestLoadWorkflow/bash_agent_not_supported (0.00s)
    --- PASS: TestLoadWorkflow/duplicate_step_id (0.00s)
    --- PASS: TestLoadWorkflow/empty_name (0.00s)
    --- PASS: TestLoadWorkflow/empty_step_id (0.00s)
    --- PASS: TestLoadWorkflow/empty_agent (0.00s)
    --- PASS: TestLoadWorkflow/empty_prompt_path (0.00s)
    --- PASS: TestLoadWorkflow/multiple_steps_valid (0.00s)
    --- PASS: TestLoadWorkflow/absolute_path_not_allowed (0.00s)
    --- PASS: TestLoadWorkflow/parent_directory_reference_not_allowed (0.00s)
    --- PASS: TestLoadWorkflow/parent_directory_in_middle_not_allowed (0.00s)
    --- PASS: TestLoadWorkflow/unknown_field_in_workflow (0.00s)
    --- PASS: TestLoadWorkflow/unknown_field_in_step (0.00s)
    --- PASS: TestLoadWorkflow/workflow_with_vars_field_is_valid (0.00s)
    --- PASS: TestLoadWorkflow/decision_on_review_step_with_default_regex (0.00s)
    --- PASS: TestLoadWorkflow/decision_on_review_step_with_custom_regex (0.00s)
    --- PASS: TestLoadWorkflow/decision_on_non-review_step_is_not_allowed (0.00s)
    --- PASS: TestLoadWorkflow/invalid_regex_in_decision (0.00s)
    --- PASS: TestLoadWorkflow/constraints_with_default_max_prompt_kb (0.00s)
    --- PASS: TestLoadWorkflow/constraints_with_valid_max_prompt_kb (0.00s)
    --- PASS: TestLoadWorkflow/constraints_with_zero_max_prompt_kb_falls_back_to_default (0.00s)
    --- PASS: TestLoadWorkflow/constraints_with_negative_max_prompt_kb_falls_back_to_default (0.00s)
    --- PASS: TestLoadWorkflow/constraints_with_too_large_max_prompt_kb_falls_back_to_default (0.00s)
=== RUN   TestResolvePromptPath
=== RUN   TestResolvePromptPath/simple_relative_path_resolution
=== RUN   TestResolvePromptPath/multiple_paths_resolution
--- PASS: TestResolvePromptPath (0.00s)
    --- PASS: TestResolvePromptPath/simple_relative_path_resolution (0.00s)
    --- PASS: TestResolvePromptPath/multiple_paths_resolution (0.00s)
=== RUN   TestCheckDeprecatedPromptField
=== RUN   TestCheckDeprecatedPromptField/no_prompt_field
=== RUN   TestCheckDeprecatedPromptField/has_prompt_field_in_first_step
=== RUN   TestCheckDeprecatedPromptField/has_prompt_field_in_second_step
=== RUN   TestCheckDeprecatedPromptField/empty_yaml
=== RUN   TestCheckDeprecatedPromptField/no_steps
--- PASS: TestCheckDeprecatedPromptField (0.00s)
    --- PASS: TestCheckDeprecatedPromptField/no_prompt_field (0.00s)
    --- PASS: TestCheckDeprecatedPromptField/has_prompt_field_in_first_step (0.00s)
    --- PASS: TestCheckDeprecatedPromptField/has_prompt_field_in_second_step (0.00s)
    --- PASS: TestCheckDeprecatedPromptField/empty_yaml (0.00s)
    --- PASS: TestCheckDeprecatedPromptField/no_steps (0.00s)
=== RUN   TestValidatePlaceholders
=== RUN   TestValidatePlaceholders/all_allowed_placeholders
=== RUN   TestValidatePlaceholders/unknown_placeholder
=== RUN   TestValidatePlaceholders/escaped_placeholder_ignored
=== RUN   TestValidatePlaceholders/multiple_unknown
=== RUN   TestValidatePlaceholders/duplicate_placeholders_counted_once
=== RUN   TestValidatePlaceholders/no_placeholders
=== RUN   TestValidatePlaceholders/mixed_valid_and_invalid_names
--- PASS: TestValidatePlaceholders (0.00s)
    --- PASS: TestValidatePlaceholders/all_allowed_placeholders (0.00s)
    --- PASS: TestValidatePlaceholders/unknown_placeholder (0.00s)
    --- PASS: TestValidatePlaceholders/escaped_placeholder_ignored (0.00s)
    --- PASS: TestValidatePlaceholders/multiple_unknown (0.00s)
    --- PASS: TestValidatePlaceholders/duplicate_placeholders_counted_once (0.00s)
    --- PASS: TestValidatePlaceholders/no_placeholders (0.00s)
    --- PASS: TestValidatePlaceholders/mixed_valid_and_invalid_names (0.00s)
=== RUN   TestExpandPrompt
=== RUN   TestExpandPrompt/successful_expansion
=== RUN   TestExpandPrompt/unknown_placeholder_error
=== RUN   TestExpandPrompt/escaped_braces_preserved
=== RUN   TestExpandPrompt/empty_values_allowed
=== RUN   TestExpandPrompt/multiple_same_placeholder
=== RUN   TestExpandPrompt/no_placeholders
=== RUN   TestExpandPrompt/multiline_text
--- PASS: TestExpandPrompt (0.00s)
    --- PASS: TestExpandPrompt/successful_expansion (0.00s)
    --- PASS: TestExpandPrompt/unknown_placeholder_error (0.00s)
    --- PASS: TestExpandPrompt/escaped_braces_preserved (0.00s)
    --- PASS: TestExpandPrompt/empty_values_allowed (0.00s)
    --- PASS: TestExpandPrompt/multiple_same_placeholder (0.00s)
    --- PASS: TestExpandPrompt/no_placeholders (0.00s)
    --- PASS: TestExpandPrompt/multiline_text (0.00s)
=== RUN   TestBuildVarMap
=== RUN   TestBuildVarMap/defaults_only
=== RUN   TestBuildVarMap/workflow_vars_override_defaults
=== RUN   TestBuildVarMap/nil_state_handled
--- PASS: TestBuildVarMap (0.00s)
    --- PASS: TestBuildVarMap/defaults_only (0.00s)
    --- PASS: TestBuildVarMap/workflow_vars_override_defaults (0.00s)
    --- PASS: TestBuildVarMap/nil_state_handled (0.00s)
PASS
coverage: 88.7% of statements
ok  	github.com/YoshitsuguKoike/deespec/internal/workflow	1.318s	coverage: 88.7% of statements
